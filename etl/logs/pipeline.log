2025-07-07 10:13:25,804 - INFO - root - Logging configured successfully.
2025-07-07 10:13:25,804 - INFO - root - ETL pipeline started.
2025-07-07 10:13:25,882 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 10:13:28,590 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 10:13:28,591 - INFO - etl.scripts.extract - Found 1 CSV files in etl/input_data.
2025-07-07 10:13:28,591 - INFO - root - --- Processing file: mid_001_ER4K_spg_apol_20250701.csv ---
2025-07-07 10:13:28,592 - INFO - etl.scripts.extract - Extracting data from mid_001_ER4K_spg_apol_20250701.csv...
2025-07-07 10:13:28,644 - INFO - etl.scripts.extract - Successfully extracted 4280 rows from mid_001_ER4K_spg_apol_20250701.csv.
2025-07-07 10:13:28,656 - INFO - etl.scripts.transform - Applying column standardization and mapping...
2025-07-07 10:13:28,657 - INFO - etl.scripts.transform - Applied aliases. Columns are now: ['Company Phone', 'Website', 'Industry', 'employee_count', 'Company', 'original_index', 'is_b2b', 'serves_1000', 'sales_pitch', 'matched_golden_partner', 'match_reasoning']
2025-07-07 10:13:28,658 - INFO - etl.scripts.transform - Applied main column mapping. Columns are now: ['phone_number', 'url', 'industry', 'employee_count', 'company_name', 'original_index', 'is_b2b', 'serves_1000', 'sales_pitch', 'matched_golden_partner', 'match_reasoning']
2025-07-07 10:13:28,659 - INFO - etl.scripts.transform - Consolidating columns into 'additional_info': ['employee_count', 'match_reasoning', 'matched_golden_partner', 'original_index', 'sales_pitch', 'serves_1000']
2025-07-07 10:13:28,711 - INFO - etl.scripts.transform - Column mapping complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'additional_info']
2025-07-07 10:13:28,712 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 10:13:28,717 - INFO - etl.scripts.transform - Cleaned 'phone_number' column.
2025-07-07 10:13:28,723 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 10:13:28,723 - INFO - root - Starting deduplication...
2025-07-07 10:13:28,726 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 10:13:28,918 - INFO - root - Deduplication complete. 4280 rows remaining for insertion.
2025-07-07 10:13:29,121 - INFO - etl.scripts.load - Created new profile_id: 1 for hash: 476ed6da0a539766468d18a9bf00b3b4
2025-07-07 10:13:29,182 - INFO - etl.scripts.load - Loading 4280 rows with profile_id 1 into 'contacts' table...
2025-07-07 10:13:30,378 - INFO - root - ETL pipeline finished.
2025-07-07 10:14:49,577 - INFO - root - Logging configured successfully.
2025-07-07 10:14:49,578 - INFO - root - ETL pipeline started.
2025-07-07 10:14:49,629 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 10:14:53,286 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 10:14:53,288 - INFO - etl.scripts.extract - Found 1 CSV files in etl/input_data.
2025-07-07 10:14:53,288 - INFO - root - --- Processing file: mid_001_ER4K_spg_apol_20250701.csv ---
2025-07-07 10:14:53,289 - INFO - etl.scripts.extract - Extracting data from mid_001_ER4K_spg_apol_20250701.csv...
2025-07-07 10:14:53,339 - INFO - etl.scripts.extract - Successfully extracted 4280 rows from mid_001_ER4K_spg_apol_20250701.csv.
2025-07-07 10:14:53,339 - INFO - etl.scripts.transform - Applying column standardization and mapping...
2025-07-07 10:14:53,341 - INFO - etl.scripts.transform - Applied aliases. Columns are now: ['Company Phone', 'Website', 'Industry', 'employee_count', 'Company', 'original_index', 'is_b2b', 'serves_1000', 'sales_pitch', 'matched_golden_partner', 'match_reasoning']
2025-07-07 10:14:53,342 - INFO - etl.scripts.transform - Applied main column mapping. Columns are now: ['phone_number', 'url', 'industry', 'employee_count', 'company_name', 'original_index', 'is_b2b', 'serves_1000', 'sales_pitch', 'matched_golden_partner', 'match_reasoning']
2025-07-07 10:14:53,343 - INFO - etl.scripts.transform - Consolidating columns into 'additional_info': ['employee_count', 'match_reasoning', 'matched_golden_partner', 'original_index', 'sales_pitch', 'serves_1000']
2025-07-07 10:14:53,381 - INFO - etl.scripts.transform - Column mapping complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'additional_info']
2025-07-07 10:14:53,382 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 10:14:53,387 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 10:14:53,394 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 10:14:53,395 - INFO - root - Starting deduplication...
2025-07-07 10:14:53,396 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 10:14:53,636 - INFO - root - Deduplication complete. 4280 rows remaining for insertion.
2025-07-07 10:14:53,876 - INFO - etl.scripts.load - Created new profile_id: 2 for hash: 476ed6da0a539766468d18a9bf00b3b4
2025-07-07 10:14:53,939 - INFO - etl.scripts.load - Loading 4280 rows with profile_id 2 into 'contacts' table...
2025-07-07 10:14:54,469 - ERROR - etl.scripts.load - Failed to load data into 'contacts': (psycopg2.errors.ForeignKeyViolation) insert or update on table "contacts" violates foreign key constraint "fk_profile_id"
DETAIL:  Key (profile_id)=(2) is not present in table "contact_profiles".

[SQL: INSERT INTO contacts (company_name, url, phone_number, industry, is_b2b, additional_info, profile_id) VALUES (%(company_name__0)s, %(url__0)s, %(phone_number__0)s, %(industry__0)s, %(is_b2b__0)s, %(additional_info__0)s, %(profile_id__0)s), (%(company ... 143987 characters truncated ... ne_number__999)s, %(industry__999)s, %(is_b2b__999)s, %(additional_info__999)s, %(profile_id__999)s)]
[parameters: {'additional_info__0': '{"employee_count": 27, "match_reasoning": "\\u00dcberschneidung im Bereich IT-Dienstleistungen und technische Systemrealisierung.; Spezialisierung au ... (658 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__0': 'http://www.trafobaden.ch', 'company_name__0': 'Trafo Baden │ Congress. Hotels. Catering.', 'profile_id__0': 2, 'industry__0': 'events services', 'phone_number__0': "'+41562040888", 'is_b2b__0': 'Yes', 'additional_info__1': '{"employee_count": 29, "match_reasoning": "Zielgruppe: KMUs (Kleine und Mittelst\\u00e4ndische Unternehmen); Produkte/Services: E-Signaturl\\u00f6sun ... (728 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__1': 'http://www.trmi.ch', 'company_name__1': 'treuhand marugg + imsand', 'profile_id__1': 2, 'industry__1': 'accounting', 'phone_number__1': "'+41279222949", 'is_b2b__1': 'Yes', 'additional_info__2': '{"employee_count": 23, "match_reasoning": "Direkte \\u00dcbereinstimmung im Bereich Personalvermittlung.; MEDWING konzentriert sich auf den Gesundhei ... (601 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__2': 'http://www.seelandjob.ch', 'company_name__2': 'SEELAND JOB AG', 'profile_id__2': 2, 'industry__2': 'staffing & recruiting', 'phone_number__2': "'+41323128888", 'is_b2b__2': 'Yes', 'additional_info__3': '{"employee_count": 24, "match_reasoning": "\\u00c4hnliche Dienstleistungen: Kundenspezifische Softwareentwicklung und IT-Beratung.; Gemeinsame Ausric ... (568 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__3': 'http://www.burningbox.ch', 'company_name__3': 'Burning Box SA', 'profile_id__3': 2, 'industry__3': 'information technology & services', 'phone_number__3': "'+41265520330", 'is_b2b__3': 'Yes', 'additional_info__4': '{"employee_count": 19, "match_reasoning": "Bietet Dienstleistungen im Eventbereich an, \\u00e4hnlich wie das Forum Fribourg.; Zielgruppe sind Unterne ... (758 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__4': 'http://www.forum-fribourg.ch', 'company_name__4': 'Forum Fribourg', 'profile_id__4': 2, 'industry__4': 'events services', 'phone_number__4': "'+41763293477", 'is_b2b__4': 'Yes', 'additional_info__5': '{"employee_count": 16, "match_reasoning": "Gemeinsame Zielgruppe: Arbeitgeber im Gesundheitswesen (Krankenh\\u00e4user, Kliniken, Pflegeeinrichtungen ... (570 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__5': 'http://www.fatzerimbach.ch', 'company_name__5': 'FatzerImbach AG', 'profile_id__5': 2, 'industry__5': 'marketing & advertising', 'phone_number__5': "'+41442271111", 'is_b2b__5': 'Yes', 'additional_info__6': '{"employee_count": 28, "match_reasoning": "\\u00dcberschneidung im Bereich Automatisierung und Digitalisierung von Prozessen.; Fokus auf die Optimier ... (630 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__6': 'http://www.pezag.ch', 'company_name__6': 'PEZAG AG', 'profile_id__6': 2, 'industry__6': 'electrical/electronic manufacturing', 'phone_number__6': "'+41714242490", 'is_b2b__6': 'Yes', 'additional_info__7': '{"employee_count": 22, "match_reasoning": "\\u00dcberschneidung im Bereich der Industrie: RODIAS GmbH bietet IT-L\\u00f6sungen f\\u00fcr die Instandh ... (790 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}' ... 6900 parameters truncated ... 'is_b2b__992': 'Yes', 'additional_info__993': '{"employee_count": 20, "match_reasoning": "Gemeinsame Ausrichtung auf IT-Dienstleistungen und digitale Transformation.; RODIAS bietet IT-L\\u00f6sung ... (632 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__993': 'http://www.orgamaxx.de', 'company_name__993': 'OrgaMAXX.IT GmbH', 'profile_id__993': 2, 'industry__993': 'information technology & services', 'phone_number__993': None, 'is_b2b__993': 'Yes', 'additional_info__994': '{"employee_count": 21, "match_reasoning": "Gemeinsame Zielgruppe: Unternehmen (B2B).; \\u00c4hnliche Dienstleistungen: Beide bieten Dienstleistungen  ... (556 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__994': 'http://www.soka-dach.de', 'company_name__994': 'SOKA-DACH', 'profile_id__994': 2, 'industry__994': 'financial services', 'phone_number__994': None, 'is_b2b__994': 'Yes', 'additional_info__995': '{"employee_count": 19, "match_reasoning": "Gemeinsame Branche: Digitalagentur f\\u00fcr Marketing und Werbung.; \\u00c4hnliche Dienstleistungen: Webd ... (486 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__995': 'http://www.admitad.ru', 'company_name__995': 'Адмитад Россия', 'profile_id__995': 2, 'industry__995': 'information technology & services', 'phone_number__995': None, 'is_b2b__995': 'Yes', 'additional_info__996': '{"employee_count": 15, "match_reasoning": "Gemeinsame Ausrichtung auf IT-L\\u00f6sungen f\\u00fcr Industrieunternehmen.; \\u00dcberschneidung im Bere ... (591 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__996': 'http://www.collana-it.com', 'company_name__996': 'collana IT GmbH', 'profile_id__996': 2, 'industry__996': 'information technology & services', 'phone_number__996': "'+4946143055210", 'is_b2b__996': 'Yes', 'additional_info__997': '{"employee_count": 26, "match_reasoning": "Gemeinsame Branche: Logistik und Transport.; \\u00c4hnliche Dienstleistungen: Digitale L\\u00f6sungen f\\u ... (504 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__997': 'http://www.alpy.eu', 'company_name__997': 'ALPY', 'profile_id__997': 2, 'industry__997': 'leisure, travel & tourism', 'phone_number__997': None, 'is_b2b__997': 'Yes', 'additional_info__998': '{"employee_count": 17, "match_reasoning": "Direkte \\u00dcberschneidung im Bereich Personaldienstleistungen/Recruiting.; Fokus auf B2B-Kunden.; Anbie ... (440 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__998': 'http://www.drfconsulting.ch', 'company_name__998': 'drf consulting AG', 'profile_id__998': 2, 'industry__998': 'management consulting', 'phone_number__998': "'+41447400030", 'is_b2b__998': 'Yes', 'additional_info__999': '{"employee_count": 21, "match_reasoning": "Gemeinsame Zielgruppe: Steuerberater und deren Mandanten.; \\u00c4hnliche Dienstleistungen: Fokus auf Digi ... (592 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__999': 'http://www.spk-gruppe.de', 'company_name__999': 'SPK-Gruppe', 'profile_id__999': 2, 'industry__999': 'financial services', 'phone_number__999': "'+4975156800", 'is_b2b__999': 'Yes'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-07 10:14:54,471 - ERROR - root - Failed to load data for mid_001_ER4K_spg_apol_20250701.csv. Halting processing for this file. Error: (psycopg2.errors.ForeignKeyViolation) insert or update on table "contacts" violates foreign key constraint "fk_profile_id"
DETAIL:  Key (profile_id)=(2) is not present in table "contact_profiles".

[SQL: INSERT INTO contacts (company_name, url, phone_number, industry, is_b2b, additional_info, profile_id) VALUES (%(company_name__0)s, %(url__0)s, %(phone_number__0)s, %(industry__0)s, %(is_b2b__0)s, %(additional_info__0)s, %(profile_id__0)s), (%(company ... 143987 characters truncated ... ne_number__999)s, %(industry__999)s, %(is_b2b__999)s, %(additional_info__999)s, %(profile_id__999)s)]
[parameters: {'additional_info__0': '{"employee_count": 27, "match_reasoning": "\\u00dcberschneidung im Bereich IT-Dienstleistungen und technische Systemrealisierung.; Spezialisierung au ... (658 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__0': 'http://www.trafobaden.ch', 'company_name__0': 'Trafo Baden │ Congress. Hotels. Catering.', 'profile_id__0': 2, 'industry__0': 'events services', 'phone_number__0': "'+41562040888", 'is_b2b__0': 'Yes', 'additional_info__1': '{"employee_count": 29, "match_reasoning": "Zielgruppe: KMUs (Kleine und Mittelst\\u00e4ndische Unternehmen); Produkte/Services: E-Signaturl\\u00f6sun ... (728 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__1': 'http://www.trmi.ch', 'company_name__1': 'treuhand marugg + imsand', 'profile_id__1': 2, 'industry__1': 'accounting', 'phone_number__1': "'+41279222949", 'is_b2b__1': 'Yes', 'additional_info__2': '{"employee_count": 23, "match_reasoning": "Direkte \\u00dcbereinstimmung im Bereich Personalvermittlung.; MEDWING konzentriert sich auf den Gesundhei ... (601 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__2': 'http://www.seelandjob.ch', 'company_name__2': 'SEELAND JOB AG', 'profile_id__2': 2, 'industry__2': 'staffing & recruiting', 'phone_number__2': "'+41323128888", 'is_b2b__2': 'Yes', 'additional_info__3': '{"employee_count": 24, "match_reasoning": "\\u00c4hnliche Dienstleistungen: Kundenspezifische Softwareentwicklung und IT-Beratung.; Gemeinsame Ausric ... (568 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__3': 'http://www.burningbox.ch', 'company_name__3': 'Burning Box SA', 'profile_id__3': 2, 'industry__3': 'information technology & services', 'phone_number__3': "'+41265520330", 'is_b2b__3': 'Yes', 'additional_info__4': '{"employee_count": 19, "match_reasoning": "Bietet Dienstleistungen im Eventbereich an, \\u00e4hnlich wie das Forum Fribourg.; Zielgruppe sind Unterne ... (758 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__4': 'http://www.forum-fribourg.ch', 'company_name__4': 'Forum Fribourg', 'profile_id__4': 2, 'industry__4': 'events services', 'phone_number__4': "'+41763293477", 'is_b2b__4': 'Yes', 'additional_info__5': '{"employee_count": 16, "match_reasoning": "Gemeinsame Zielgruppe: Arbeitgeber im Gesundheitswesen (Krankenh\\u00e4user, Kliniken, Pflegeeinrichtungen ... (570 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__5': 'http://www.fatzerimbach.ch', 'company_name__5': 'FatzerImbach AG', 'profile_id__5': 2, 'industry__5': 'marketing & advertising', 'phone_number__5': "'+41442271111", 'is_b2b__5': 'Yes', 'additional_info__6': '{"employee_count": 28, "match_reasoning": "\\u00dcberschneidung im Bereich Automatisierung und Digitalisierung von Prozessen.; Fokus auf die Optimier ... (630 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__6': 'http://www.pezag.ch', 'company_name__6': 'PEZAG AG', 'profile_id__6': 2, 'industry__6': 'electrical/electronic manufacturing', 'phone_number__6': "'+41714242490", 'is_b2b__6': 'Yes', 'additional_info__7': '{"employee_count": 22, "match_reasoning": "\\u00dcberschneidung im Bereich der Industrie: RODIAS GmbH bietet IT-L\\u00f6sungen f\\u00fcr die Instandh ... (790 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}' ... 6900 parameters truncated ... 'is_b2b__992': 'Yes', 'additional_info__993': '{"employee_count": 20, "match_reasoning": "Gemeinsame Ausrichtung auf IT-Dienstleistungen und digitale Transformation.; RODIAS bietet IT-L\\u00f6sung ... (632 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__993': 'http://www.orgamaxx.de', 'company_name__993': 'OrgaMAXX.IT GmbH', 'profile_id__993': 2, 'industry__993': 'information technology & services', 'phone_number__993': None, 'is_b2b__993': 'Yes', 'additional_info__994': '{"employee_count": 21, "match_reasoning": "Gemeinsame Zielgruppe: Unternehmen (B2B).; \\u00c4hnliche Dienstleistungen: Beide bieten Dienstleistungen  ... (556 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__994': 'http://www.soka-dach.de', 'company_name__994': 'SOKA-DACH', 'profile_id__994': 2, 'industry__994': 'financial services', 'phone_number__994': None, 'is_b2b__994': 'Yes', 'additional_info__995': '{"employee_count": 19, "match_reasoning": "Gemeinsame Branche: Digitalagentur f\\u00fcr Marketing und Werbung.; \\u00c4hnliche Dienstleistungen: Webd ... (486 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__995': 'http://www.admitad.ru', 'company_name__995': 'Адмитад Россия', 'profile_id__995': 2, 'industry__995': 'information technology & services', 'phone_number__995': None, 'is_b2b__995': 'Yes', 'additional_info__996': '{"employee_count": 15, "match_reasoning": "Gemeinsame Ausrichtung auf IT-L\\u00f6sungen f\\u00fcr Industrieunternehmen.; \\u00dcberschneidung im Bere ... (591 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__996': 'http://www.collana-it.com', 'company_name__996': 'collana IT GmbH', 'profile_id__996': 2, 'industry__996': 'information technology & services', 'phone_number__996': "'+4946143055210", 'is_b2b__996': 'Yes', 'additional_info__997': '{"employee_count": 26, "match_reasoning": "Gemeinsame Branche: Logistik und Transport.; \\u00c4hnliche Dienstleistungen: Digitale L\\u00f6sungen f\\u ... (504 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__997': 'http://www.alpy.eu', 'company_name__997': 'ALPY', 'profile_id__997': 2, 'industry__997': 'leisure, travel & tourism', 'phone_number__997': None, 'is_b2b__997': 'Yes', 'additional_info__998': '{"employee_count": 17, "match_reasoning": "Direkte \\u00dcberschneidung im Bereich Personaldienstleistungen/Recruiting.; Fokus auf B2B-Kunden.; Anbie ... (440 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__998': 'http://www.drfconsulting.ch', 'company_name__998': 'drf consulting AG', 'profile_id__998': 2, 'industry__998': 'management consulting', 'phone_number__998': "'+41447400030", 'is_b2b__998': 'Yes', 'additional_info__999': '{"employee_count": 21, "match_reasoning": "Gemeinsame Zielgruppe: Steuerberater und deren Mandanten.; \\u00c4hnliche Dienstleistungen: Fokus auf Digi ... (592 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'url__999': 'http://www.spk-gruppe.de', 'company_name__999': 'SPK-Gruppe', 'profile_id__999': 2, 'industry__999': 'financial services', 'phone_number__999': "'+4975156800", 'is_b2b__999': 'Yes'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-07 10:14:54,472 - INFO - root - ETL pipeline finished.
2025-07-07 10:15:38,713 - INFO - root - Logging configured successfully.
2025-07-07 10:15:38,714 - INFO - root - ETL pipeline started.
2025-07-07 10:15:38,839 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 10:15:40,723 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 10:15:40,724 - INFO - etl.scripts.extract - Found 1 CSV files in etl/input_data.
2025-07-07 10:15:40,724 - INFO - root - --- Processing file: mid_001_ER4K_spg_apol_20250701.csv ---
2025-07-07 10:15:40,724 - INFO - etl.scripts.extract - Extracting data from mid_001_ER4K_spg_apol_20250701.csv...
2025-07-07 10:15:40,777 - INFO - etl.scripts.extract - Successfully extracted 4280 rows from mid_001_ER4K_spg_apol_20250701.csv.
2025-07-07 10:15:40,778 - INFO - etl.scripts.transform - Applying column standardization and mapping...
2025-07-07 10:15:40,779 - INFO - etl.scripts.transform - Applied aliases. Columns are now: ['Company Phone', 'Website', 'Industry', 'employee_count', 'Company', 'original_index', 'is_b2b', 'serves_1000', 'sales_pitch', 'matched_golden_partner', 'match_reasoning']
2025-07-07 10:15:40,780 - INFO - etl.scripts.transform - Applied main column mapping. Columns are now: ['phone_number', 'url', 'industry', 'employee_count', 'company_name', 'original_index', 'is_b2b', 'serves_1000', 'sales_pitch', 'matched_golden_partner', 'match_reasoning']
2025-07-07 10:15:40,780 - INFO - etl.scripts.transform - Consolidating columns into 'additional_info': ['employee_count', 'match_reasoning', 'matched_golden_partner', 'original_index', 'sales_pitch', 'serves_1000']
2025-07-07 10:15:40,834 - INFO - etl.scripts.transform - Column mapping complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'additional_info']
2025-07-07 10:15:40,834 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 10:15:40,840 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 10:15:40,847 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 10:15:40,847 - INFO - root - Starting deduplication...
2025-07-07 10:15:40,849 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 10:15:41,032 - INFO - root - Deduplication complete. 4280 rows remaining for insertion.
2025-07-07 10:15:41,339 - INFO - etl.scripts.load - Created new profile_id: 3 for hash: 476ed6da0a539766468d18a9bf00b3b4
2025-07-07 10:15:41,341 - INFO - etl.scripts.load - Loading 4280 rows with profile_id 3 into 'contacts' table...
2025-07-07 10:15:42,055 - ERROR - etl.scripts.load - Failed to load data into 'contacts': (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type json
LINE 1: ...s.de', '''+49895155556', 'legal services', 'Yes', '{"employe...
                                                             ^
DETAIL:  Token "NaN" is invalid.
CONTEXT:  JSON data, line 1: {"employee_count": 25, "match_reasoning": NaN...

[SQL: INSERT INTO contacts (company_name, url, phone_number, industry, is_b2b, additional_info, profile_id) VALUES (%(company_name__0)s, %(url__0)s, %(phone_number__0)s, %(industry__0)s, %(is_b2b__0)s, %(additional_info__0)s, %(profile_id__0)s), (%(company ... 143987 characters truncated ... ne_number__999)s, %(industry__999)s, %(is_b2b__999)s, %(additional_info__999)s, %(profile_id__999)s)]
[parameters: {'additional_info__0': '{"employee_count": 27, "match_reasoning": "Gemeinsame Zielgruppe: Industrieunternehmen mit komplexen technischen Anlagen.; \\u00c4hnliche technologis ... (580 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__0': 'MWTEST GmbH', 'profile_id__0': 3, 'phone_number__0': None, 'industry__0': 'information technology & services', 'url__0': 'http://www.mwtest.de', 'is_b2b__0': 'Yes', 'additional_info__1': '{"employee_count": 24, "match_reasoning": "Gemeinsame Branche: Medien (Verlagswesen und digitale Marketingdienste); Schl\\u00fctersche bietet Online- ... (705 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__1': 'Radio Essen', 'profile_id__1': 3, 'phone_number__1': "'+4915231049301", 'industry__1': 'information technology & services', 'url__1': 'http://www.radioessen.de', 'is_b2b__1': 'Yes', 'additional_info__2': '{"employee_count": 19, "match_reasoning": "Gemeinsame Zielgruppe: Gesundheitswesen (\\u00c4rzte, Pflegepersonal) und soziale Einrichtungen.; \\u00c4h ... (600 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__2': 'Argomed Ärzte AG', 'profile_id__2': 3, 'phone_number__2': "'+41564830333", 'industry__2': 'hospital & health care', 'url__2': 'http://www.argomed.ch', 'is_b2b__2': 'Yes', 'additional_info__3': '{"employee_count": 15, "match_reasoning": "Gemeinsame Branche: Medien (Verlagswesen und digitale Marketingdienstleistungen); \\u00c4hnliche Dienstlei ... (570 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__3': 'Innovando.News', 'profile_id__3': 3, 'phone_number__3': "'+41717941500", 'industry__3': 'publishing', 'url__3': 'http://www.innovando.news', 'is_b2b__3': 'Yes', 'additional_info__4': '{"employee_count": 20, "match_reasoning": "Beide Unternehmen sind im Bereich Marketing t\\u00e4tig.; PNP Media bietet Webdesign und Online-Marketing- ... (519 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__4': 'Lauris Agency', 'profile_id__4': 3, 'phone_number__4': "'+41218697390", 'industry__4': 'marketing & advertising', 'url__4': 'http://www.lauris.ch', 'is_b2b__4': 'Yes', 'additional_info__5': '{"employee_count": 25, "match_reasoning": "\\u00dcberschneidung im Bereich IT-Dienstleistungen und Systemintegration.; Gemeinsame Ausrichtung auf tec ... (633 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__5': 'imavox', 'profile_id__5': 3, 'phone_number__5': "'+41213201290", 'industry__5': 'information technology & services', 'url__5': 'http://www.imavox.global', 'is_b2b__5': 'Yes', 'additional_info__6': '{"employee_count": 18, "match_reasoning": "Gemeinsame Zielgruppe: Mittelst\\u00e4ndische Unternehmen (KMU); \\u00c4hnliche Produkte/Services: Cloud-b ... (563 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__6': 'Cloudfreunde GmbH', 'profile_id__6': 3, 'phone_number__6': "'+4935189670660", 'industry__6': 'information technology & services', 'url__6': 'http://www.cloudfreunde.com', 'is_b2b__6': 'Yes', 'additional_info__7': '{"employee_count": 25, "match_reasoning": "Gemeinsame Zielgruppe: Kleine und mittelst\\u00e4ndische Unternehmen (KMU); Schl\\u00fctersche bietet Onli ... (684 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}' ... 6900 parameters truncated ... 'is_b2b__992': 'Yes', 'additional_info__993': '{"employee_count": 20, "match_reasoning": "Gemeinsame Ausrichtung auf IT-Dienstleistungen und -Beratung.; \\u00c4hnliche Schwerpunkte: Digitale Trans ... (535 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__993': 'PiraCon GmbH', 'profile_id__993': 3, 'phone_number__993': "'+497144501300", 'industry__993': 'information technology & services', 'url__993': 'http://www.piracon.de', 'is_b2b__993': 'Yes', 'additional_info__994': '{"employee_count": 31, "match_reasoning": "Gemeinsame Zielgruppe: Betreuungseinrichtungen f\\u00fcr Senioren und Menschen mit kognitiven Beeintr\\u00 ... (762 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__994': 'Marli GmbH', 'profile_id__994': 3, 'phone_number__994': "'+4945162030", 'industry__994': 'individual & family services', 'url__994': 'http://www.marli.de', 'is_b2b__994': 'Yes', 'additional_info__995': '{"employee_count": 24, "match_reasoning": "Beratung im Bereich der digitalen Transformation.; Fokus auf die Optimierung von Prozessen.; Analyse von P ... (448 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__995': 'KlimAktiv gGmbH', 'profile_id__995': 3, 'phone_number__995': "'+4970715393633", 'industry__995': 'think tanks', 'url__995': 'http://www.klimaktiv.de', 'is_b2b__995': 'Yes', 'additional_info__996': '{"employee_count": 25, "match_reasoning": "Fokus auf Industrie und technische Anlagen.; Bietet L\\u00f6sungen f\\u00fcr die Wartung und das Asset Man ... (561 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__996': 'Elevion GmbH', 'profile_id__996': 3, 'phone_number__996': "'+4936412934100", 'industry__996': 'construction', 'url__996': 'http://www.elevion.de', 'is_b2b__996': 'Yes', 'additional_info__997': '{"employee_count": 23, "match_reasoning": "Fokus auf Industrieunternehmen mit komplexen technischen Anlagen.; Bietet L\\u00f6sungen f\\u00fcr die War ... (588 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__997': 'SAX Power GmbH', 'profile_id__997': 3, 'phone_number__997': "'+497305958911", 'industry__997': 'semiconductors', 'url__997': 'http://www.sax-power.net', 'is_b2b__997': 'Yes', 'additional_info__998': '{"employee_count": 19, "match_reasoning": "Gemeinsame Branche: EdTech und E-Learning f\\u00fcr den Gesundheits- und Sozialbereich.; \\u00c4hnliche Pr ... (667 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__998': 'Fuxam', 'profile_id__998': 3, 'phone_number__998': None, 'industry__998': 'information technology & services', 'url__998': 'http://www.fuxam.com', 'is_b2b__998': 'Yes', 'additional_info__999': '{"employee_count": 28, "match_reasoning": "Fokus auf Industrieunternehmen mit komplexen technischen Anlagen.; Beratung und Entwicklung kundenspezifis ... (554 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__999': 'CaderaDesign', 'profile_id__999': 3, 'phone_number__999': "'+49931460660", 'industry__999': 'information technology & services', 'url__999': 'http://www.caderadesign.de', 'is_b2b__999': 'Yes'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-07-07 10:15:42,058 - ERROR - root - Failed to load data for mid_001_ER4K_spg_apol_20250701.csv. Halting processing for this file. Error: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type json
LINE 1: ...s.de', '''+49895155556', 'legal services', 'Yes', '{"employe...
                                                             ^
DETAIL:  Token "NaN" is invalid.
CONTEXT:  JSON data, line 1: {"employee_count": 25, "match_reasoning": NaN...

[SQL: INSERT INTO contacts (company_name, url, phone_number, industry, is_b2b, additional_info, profile_id) VALUES (%(company_name__0)s, %(url__0)s, %(phone_number__0)s, %(industry__0)s, %(is_b2b__0)s, %(additional_info__0)s, %(profile_id__0)s), (%(company ... 143987 characters truncated ... ne_number__999)s, %(industry__999)s, %(is_b2b__999)s, %(additional_info__999)s, %(profile_id__999)s)]
[parameters: {'additional_info__0': '{"employee_count": 27, "match_reasoning": "Gemeinsame Zielgruppe: Industrieunternehmen mit komplexen technischen Anlagen.; \\u00c4hnliche technologis ... (580 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__0': 'MWTEST GmbH', 'profile_id__0': 3, 'phone_number__0': None, 'industry__0': 'information technology & services', 'url__0': 'http://www.mwtest.de', 'is_b2b__0': 'Yes', 'additional_info__1': '{"employee_count": 24, "match_reasoning": "Gemeinsame Branche: Medien (Verlagswesen und digitale Marketingdienste); Schl\\u00fctersche bietet Online- ... (705 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__1': 'Radio Essen', 'profile_id__1': 3, 'phone_number__1': "'+4915231049301", 'industry__1': 'information technology & services', 'url__1': 'http://www.radioessen.de', 'is_b2b__1': 'Yes', 'additional_info__2': '{"employee_count": 19, "match_reasoning": "Gemeinsame Zielgruppe: Gesundheitswesen (\\u00c4rzte, Pflegepersonal) und soziale Einrichtungen.; \\u00c4h ... (600 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__2': 'Argomed Ärzte AG', 'profile_id__2': 3, 'phone_number__2': "'+41564830333", 'industry__2': 'hospital & health care', 'url__2': 'http://www.argomed.ch', 'is_b2b__2': 'Yes', 'additional_info__3': '{"employee_count": 15, "match_reasoning": "Gemeinsame Branche: Medien (Verlagswesen und digitale Marketingdienstleistungen); \\u00c4hnliche Dienstlei ... (570 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__3': 'Innovando.News', 'profile_id__3': 3, 'phone_number__3': "'+41717941500", 'industry__3': 'publishing', 'url__3': 'http://www.innovando.news', 'is_b2b__3': 'Yes', 'additional_info__4': '{"employee_count": 20, "match_reasoning": "Beide Unternehmen sind im Bereich Marketing t\\u00e4tig.; PNP Media bietet Webdesign und Online-Marketing- ... (519 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__4': 'Lauris Agency', 'profile_id__4': 3, 'phone_number__4': "'+41218697390", 'industry__4': 'marketing & advertising', 'url__4': 'http://www.lauris.ch', 'is_b2b__4': 'Yes', 'additional_info__5': '{"employee_count": 25, "match_reasoning": "\\u00dcberschneidung im Bereich IT-Dienstleistungen und Systemintegration.; Gemeinsame Ausrichtung auf tec ... (633 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__5': 'imavox', 'profile_id__5': 3, 'phone_number__5': "'+41213201290", 'industry__5': 'information technology & services', 'url__5': 'http://www.imavox.global', 'is_b2b__5': 'Yes', 'additional_info__6': '{"employee_count": 18, "match_reasoning": "Gemeinsame Zielgruppe: Mittelst\\u00e4ndische Unternehmen (KMU); \\u00c4hnliche Produkte/Services: Cloud-b ... (563 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__6': 'Cloudfreunde GmbH', 'profile_id__6': 3, 'phone_number__6': "'+4935189670660", 'industry__6': 'information technology & services', 'url__6': 'http://www.cloudfreunde.com', 'is_b2b__6': 'Yes', 'additional_info__7': '{"employee_count": 25, "match_reasoning": "Gemeinsame Zielgruppe: Kleine und mittelst\\u00e4ndische Unternehmen (KMU); Schl\\u00fctersche bietet Onli ... (684 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}' ... 6900 parameters truncated ... 'is_b2b__992': 'Yes', 'additional_info__993': '{"employee_count": 20, "match_reasoning": "Gemeinsame Ausrichtung auf IT-Dienstleistungen und -Beratung.; \\u00c4hnliche Schwerpunkte: Digitale Trans ... (535 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__993': 'PiraCon GmbH', 'profile_id__993': 3, 'phone_number__993': "'+497144501300", 'industry__993': 'information technology & services', 'url__993': 'http://www.piracon.de', 'is_b2b__993': 'Yes', 'additional_info__994': '{"employee_count": 31, "match_reasoning": "Gemeinsame Zielgruppe: Betreuungseinrichtungen f\\u00fcr Senioren und Menschen mit kognitiven Beeintr\\u00 ... (762 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__994': 'Marli GmbH', 'profile_id__994': 3, 'phone_number__994': "'+4945162030", 'industry__994': 'individual & family services', 'url__994': 'http://www.marli.de', 'is_b2b__994': 'Yes', 'additional_info__995': '{"employee_count": 24, "match_reasoning": "Beratung im Bereich der digitalen Transformation.; Fokus auf die Optimierung von Prozessen.; Analyse von P ... (448 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__995': 'KlimAktiv gGmbH', 'profile_id__995': 3, 'phone_number__995': "'+4970715393633", 'industry__995': 'think tanks', 'url__995': 'http://www.klimaktiv.de', 'is_b2b__995': 'Yes', 'additional_info__996': '{"employee_count": 25, "match_reasoning": "Fokus auf Industrie und technische Anlagen.; Bietet L\\u00f6sungen f\\u00fcr die Wartung und das Asset Man ... (561 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__996': 'Elevion GmbH', 'profile_id__996': 3, 'phone_number__996': "'+4936412934100", 'industry__996': 'construction', 'url__996': 'http://www.elevion.de', 'is_b2b__996': 'Yes', 'additional_info__997': '{"employee_count": 23, "match_reasoning": "Fokus auf Industrieunternehmen mit komplexen technischen Anlagen.; Bietet L\\u00f6sungen f\\u00fcr die War ... (588 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__997': 'SAX Power GmbH', 'profile_id__997': 3, 'phone_number__997': "'+497305958911", 'industry__997': 'semiconductors', 'url__997': 'http://www.sax-power.net', 'is_b2b__997': 'Yes', 'additional_info__998': '{"employee_count": 19, "match_reasoning": "Gemeinsame Branche: EdTech und E-Learning f\\u00fcr den Gesundheits- und Sozialbereich.; \\u00c4hnliche Pr ... (667 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__998': 'Fuxam', 'profile_id__998': 3, 'phone_number__998': None, 'industry__998': 'information technology & services', 'url__998': 'http://www.fuxam.com', 'is_b2b__998': 'Yes', 'additional_info__999': '{"employee_count": 28, "match_reasoning": "Fokus auf Industrieunternehmen mit komplexen technischen Anlagen.; Beratung und Entwicklung kundenspezifis ... (554 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'company_name__999': 'CaderaDesign', 'profile_id__999': 3, 'phone_number__999': "'+49931460660", 'industry__999': 'information technology & services', 'url__999': 'http://www.caderadesign.de', 'is_b2b__999': 'Yes'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-07-07 10:15:42,059 - INFO - root - ETL pipeline finished.
2025-07-07 10:16:14,584 - INFO - root - Logging configured successfully.
2025-07-07 10:16:14,585 - INFO - root - ETL pipeline started.
2025-07-07 10:16:14,641 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 10:16:16,309 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 10:16:16,311 - INFO - etl.scripts.extract - Found 1 CSV files in etl/input_data.
2025-07-07 10:16:16,311 - INFO - root - --- Processing file: mid_001_ER4K_spg_apol_20250701.csv ---
2025-07-07 10:16:16,312 - INFO - etl.scripts.extract - Extracting data from mid_001_ER4K_spg_apol_20250701.csv...
2025-07-07 10:16:16,366 - INFO - etl.scripts.extract - Successfully extracted 4280 rows from mid_001_ER4K_spg_apol_20250701.csv.
2025-07-07 10:16:16,366 - INFO - etl.scripts.transform - Applying column standardization and mapping...
2025-07-07 10:16:16,367 - INFO - etl.scripts.transform - Applied aliases. Columns are now: ['Company Phone', 'Website', 'Industry', 'employee_count', 'Company', 'original_index', 'is_b2b', 'serves_1000', 'sales_pitch', 'matched_golden_partner', 'match_reasoning']
2025-07-07 10:16:16,368 - INFO - etl.scripts.transform - Applied main column mapping. Columns are now: ['phone_number', 'url', 'industry', 'employee_count', 'company_name', 'original_index', 'is_b2b', 'serves_1000', 'sales_pitch', 'matched_golden_partner', 'match_reasoning']
2025-07-07 10:16:16,368 - INFO - etl.scripts.transform - Consolidating columns into 'additional_info': ['employee_count', 'match_reasoning', 'matched_golden_partner', 'original_index', 'sales_pitch', 'serves_1000']
2025-07-07 10:16:16,413 - INFO - etl.scripts.transform - Column mapping complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'additional_info']
2025-07-07 10:16:16,414 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 10:16:16,420 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 10:16:16,427 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 10:16:16,427 - INFO - root - Starting deduplication...
2025-07-07 10:16:16,429 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 10:16:16,604 - INFO - root - Deduplication complete. 4280 rows remaining for insertion.
2025-07-07 10:16:16,970 - INFO - etl.scripts.load - Found existing profile_id: 3 for hash: 476ed6da0a539766468d18a9bf00b3b4
2025-07-07 10:16:16,971 - INFO - etl.scripts.load - Loading 4280 rows with profile_id 3 into 'contacts' table...
2025-07-07 10:16:17,702 - ERROR - etl.scripts.load - Failed to load data into 'contacts': (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "unique_phone_number"
DETAIL:  Key (phone_number)=('+49234567890) already exists.

[SQL: INSERT INTO contacts (company_name, url, phone_number, industry, is_b2b, additional_info, profile_id) VALUES (%(company_name__0)s, %(url__0)s, %(phone_number__0)s, %(industry__0)s, %(is_b2b__0)s, %(additional_info__0)s, %(profile_id__0)s), (%(company ... 143987 characters truncated ... ne_number__999)s, %(industry__999)s, %(is_b2b__999)s, %(additional_info__999)s, %(profile_id__999)s)]
[parameters: {'additional_info__0': '{"employee_count": 27, "match_reasoning": "Gemeinsame Zielgruppe: Industrieunternehmen mit komplexen technischen Anlagen.; \\u00c4hnliche technologis ... (580 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__0': None, 'industry__0': 'information technology & services', 'is_b2b__0': 'Yes', 'profile_id__0': 3, 'company_name__0': 'MWTEST GmbH', 'url__0': 'http://www.mwtest.de', 'additional_info__1': '{"employee_count": 24, "match_reasoning": "Gemeinsame Branche: Medien (Verlagswesen und digitale Marketingdienste); Schl\\u00fctersche bietet Online- ... (705 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__1': "'+4915231049301", 'industry__1': 'information technology & services', 'is_b2b__1': 'Yes', 'profile_id__1': 3, 'company_name__1': 'Radio Essen', 'url__1': 'http://www.radioessen.de', 'additional_info__2': '{"employee_count": 19, "match_reasoning": "Gemeinsame Zielgruppe: Gesundheitswesen (\\u00c4rzte, Pflegepersonal) und soziale Einrichtungen.; \\u00c4h ... (600 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__2': "'+41564830333", 'industry__2': 'hospital & health care', 'is_b2b__2': 'Yes', 'profile_id__2': 3, 'company_name__2': 'Argomed Ärzte AG', 'url__2': 'http://www.argomed.ch', 'additional_info__3': '{"employee_count": 15, "match_reasoning": "Gemeinsame Branche: Medien (Verlagswesen und digitale Marketingdienstleistungen); \\u00c4hnliche Dienstlei ... (570 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__3': "'+41717941500", 'industry__3': 'publishing', 'is_b2b__3': 'Yes', 'profile_id__3': 3, 'company_name__3': 'Innovando.News', 'url__3': 'http://www.innovando.news', 'additional_info__4': '{"employee_count": 20, "match_reasoning": "Beide Unternehmen sind im Bereich Marketing t\\u00e4tig.; PNP Media bietet Webdesign und Online-Marketing- ... (519 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__4': "'+41218697390", 'industry__4': 'marketing & advertising', 'is_b2b__4': 'Yes', 'profile_id__4': 3, 'company_name__4': 'Lauris Agency', 'url__4': 'http://www.lauris.ch', 'additional_info__5': '{"employee_count": 25, "match_reasoning": "\\u00dcberschneidung im Bereich IT-Dienstleistungen und Systemintegration.; Gemeinsame Ausrichtung auf tec ... (633 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__5': "'+41213201290", 'industry__5': 'information technology & services', 'is_b2b__5': 'Yes', 'profile_id__5': 3, 'company_name__5': 'imavox', 'url__5': 'http://www.imavox.global', 'additional_info__6': '{"employee_count": 18, "match_reasoning": "Gemeinsame Zielgruppe: Mittelst\\u00e4ndische Unternehmen (KMU); \\u00c4hnliche Produkte/Services: Cloud-b ... (563 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__6': "'+4935189670660", 'industry__6': 'information technology & services', 'is_b2b__6': 'Yes', 'profile_id__6': 3, 'company_name__6': 'Cloudfreunde GmbH', 'url__6': 'http://www.cloudfreunde.com', 'additional_info__7': '{"employee_count": 25, "match_reasoning": "Gemeinsame Zielgruppe: Kleine und mittelst\\u00e4ndische Unternehmen (KMU); Schl\\u00fctersche bietet Onli ... (684 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}' ... 6900 parameters truncated ... 'url__992': 'http://www.hawo.com', 'additional_info__993': '{"employee_count": 20, "match_reasoning": "Gemeinsame Ausrichtung auf IT-Dienstleistungen und -Beratung.; \\u00c4hnliche Schwerpunkte: Digitale Trans ... (535 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__993': "'+497144501300", 'industry__993': 'information technology & services', 'is_b2b__993': 'Yes', 'profile_id__993': 3, 'company_name__993': 'PiraCon GmbH', 'url__993': 'http://www.piracon.de', 'additional_info__994': '{"employee_count": 31, "match_reasoning": "Gemeinsame Zielgruppe: Betreuungseinrichtungen f\\u00fcr Senioren und Menschen mit kognitiven Beeintr\\u00 ... (762 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__994': "'+4945162030", 'industry__994': 'individual & family services', 'is_b2b__994': 'Yes', 'profile_id__994': 3, 'company_name__994': 'Marli GmbH', 'url__994': 'http://www.marli.de', 'additional_info__995': '{"employee_count": 24, "match_reasoning": "Beratung im Bereich der digitalen Transformation.; Fokus auf die Optimierung von Prozessen.; Analyse von P ... (448 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__995': "'+4970715393633", 'industry__995': 'think tanks', 'is_b2b__995': 'Yes', 'profile_id__995': 3, 'company_name__995': 'KlimAktiv gGmbH', 'url__995': 'http://www.klimaktiv.de', 'additional_info__996': '{"employee_count": 25, "match_reasoning": "Fokus auf Industrie und technische Anlagen.; Bietet L\\u00f6sungen f\\u00fcr die Wartung und das Asset Man ... (561 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__996': "'+4936412934100", 'industry__996': 'construction', 'is_b2b__996': 'Yes', 'profile_id__996': 3, 'company_name__996': 'Elevion GmbH', 'url__996': 'http://www.elevion.de', 'additional_info__997': '{"employee_count": 23, "match_reasoning": "Fokus auf Industrieunternehmen mit komplexen technischen Anlagen.; Bietet L\\u00f6sungen f\\u00fcr die War ... (588 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__997': "'+497305958911", 'industry__997': 'semiconductors', 'is_b2b__997': 'Yes', 'profile_id__997': 3, 'company_name__997': 'SAX Power GmbH', 'url__997': 'http://www.sax-power.net', 'additional_info__998': '{"employee_count": 19, "match_reasoning": "Gemeinsame Branche: EdTech und E-Learning f\\u00fcr den Gesundheits- und Sozialbereich.; \\u00c4hnliche Pr ... (667 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__998': None, 'industry__998': 'information technology & services', 'is_b2b__998': 'Yes', 'profile_id__998': 3, 'company_name__998': 'Fuxam', 'url__998': 'http://www.fuxam.com', 'additional_info__999': '{"employee_count": 28, "match_reasoning": "Fokus auf Industrieunternehmen mit komplexen technischen Anlagen.; Beratung und Entwicklung kundenspezifis ... (554 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__999': "'+49931460660", 'industry__999': 'information technology & services', 'is_b2b__999': 'Yes', 'profile_id__999': 3, 'company_name__999': 'CaderaDesign', 'url__999': 'http://www.caderadesign.de'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-07 10:16:17,705 - ERROR - root - Failed to load data for mid_001_ER4K_spg_apol_20250701.csv. Halting processing for this file. Error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "unique_phone_number"
DETAIL:  Key (phone_number)=('+49234567890) already exists.

[SQL: INSERT INTO contacts (company_name, url, phone_number, industry, is_b2b, additional_info, profile_id) VALUES (%(company_name__0)s, %(url__0)s, %(phone_number__0)s, %(industry__0)s, %(is_b2b__0)s, %(additional_info__0)s, %(profile_id__0)s), (%(company ... 143987 characters truncated ... ne_number__999)s, %(industry__999)s, %(is_b2b__999)s, %(additional_info__999)s, %(profile_id__999)s)]
[parameters: {'additional_info__0': '{"employee_count": 27, "match_reasoning": "Gemeinsame Zielgruppe: Industrieunternehmen mit komplexen technischen Anlagen.; \\u00c4hnliche technologis ... (580 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__0': None, 'industry__0': 'information technology & services', 'is_b2b__0': 'Yes', 'profile_id__0': 3, 'company_name__0': 'MWTEST GmbH', 'url__0': 'http://www.mwtest.de', 'additional_info__1': '{"employee_count": 24, "match_reasoning": "Gemeinsame Branche: Medien (Verlagswesen und digitale Marketingdienste); Schl\\u00fctersche bietet Online- ... (705 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__1': "'+4915231049301", 'industry__1': 'information technology & services', 'is_b2b__1': 'Yes', 'profile_id__1': 3, 'company_name__1': 'Radio Essen', 'url__1': 'http://www.radioessen.de', 'additional_info__2': '{"employee_count": 19, "match_reasoning": "Gemeinsame Zielgruppe: Gesundheitswesen (\\u00c4rzte, Pflegepersonal) und soziale Einrichtungen.; \\u00c4h ... (600 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__2': "'+41564830333", 'industry__2': 'hospital & health care', 'is_b2b__2': 'Yes', 'profile_id__2': 3, 'company_name__2': 'Argomed Ärzte AG', 'url__2': 'http://www.argomed.ch', 'additional_info__3': '{"employee_count": 15, "match_reasoning": "Gemeinsame Branche: Medien (Verlagswesen und digitale Marketingdienstleistungen); \\u00c4hnliche Dienstlei ... (570 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__3': "'+41717941500", 'industry__3': 'publishing', 'is_b2b__3': 'Yes', 'profile_id__3': 3, 'company_name__3': 'Innovando.News', 'url__3': 'http://www.innovando.news', 'additional_info__4': '{"employee_count": 20, "match_reasoning": "Beide Unternehmen sind im Bereich Marketing t\\u00e4tig.; PNP Media bietet Webdesign und Online-Marketing- ... (519 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__4': "'+41218697390", 'industry__4': 'marketing & advertising', 'is_b2b__4': 'Yes', 'profile_id__4': 3, 'company_name__4': 'Lauris Agency', 'url__4': 'http://www.lauris.ch', 'additional_info__5': '{"employee_count": 25, "match_reasoning": "\\u00dcberschneidung im Bereich IT-Dienstleistungen und Systemintegration.; Gemeinsame Ausrichtung auf tec ... (633 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__5': "'+41213201290", 'industry__5': 'information technology & services', 'is_b2b__5': 'Yes', 'profile_id__5': 3, 'company_name__5': 'imavox', 'url__5': 'http://www.imavox.global', 'additional_info__6': '{"employee_count": 18, "match_reasoning": "Gemeinsame Zielgruppe: Mittelst\\u00e4ndische Unternehmen (KMU); \\u00c4hnliche Produkte/Services: Cloud-b ... (563 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__6': "'+4935189670660", 'industry__6': 'information technology & services', 'is_b2b__6': 'Yes', 'profile_id__6': 3, 'company_name__6': 'Cloudfreunde GmbH', 'url__6': 'http://www.cloudfreunde.com', 'additional_info__7': '{"employee_count": 25, "match_reasoning": "Gemeinsame Zielgruppe: Kleine und mittelst\\u00e4ndische Unternehmen (KMU); Schl\\u00fctersche bietet Onli ... (684 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}' ... 6900 parameters truncated ... 'url__992': 'http://www.hawo.com', 'additional_info__993': '{"employee_count": 20, "match_reasoning": "Gemeinsame Ausrichtung auf IT-Dienstleistungen und -Beratung.; \\u00c4hnliche Schwerpunkte: Digitale Trans ... (535 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__993': "'+497144501300", 'industry__993': 'information technology & services', 'is_b2b__993': 'Yes', 'profile_id__993': 3, 'company_name__993': 'PiraCon GmbH', 'url__993': 'http://www.piracon.de', 'additional_info__994': '{"employee_count": 31, "match_reasoning": "Gemeinsame Zielgruppe: Betreuungseinrichtungen f\\u00fcr Senioren und Menschen mit kognitiven Beeintr\\u00 ... (762 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__994': "'+4945162030", 'industry__994': 'individual & family services', 'is_b2b__994': 'Yes', 'profile_id__994': 3, 'company_name__994': 'Marli GmbH', 'url__994': 'http://www.marli.de', 'additional_info__995': '{"employee_count": 24, "match_reasoning": "Beratung im Bereich der digitalen Transformation.; Fokus auf die Optimierung von Prozessen.; Analyse von P ... (448 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__995': "'+4970715393633", 'industry__995': 'think tanks', 'is_b2b__995': 'Yes', 'profile_id__995': 3, 'company_name__995': 'KlimAktiv gGmbH', 'url__995': 'http://www.klimaktiv.de', 'additional_info__996': '{"employee_count": 25, "match_reasoning": "Fokus auf Industrie und technische Anlagen.; Bietet L\\u00f6sungen f\\u00fcr die Wartung und das Asset Man ... (561 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__996': "'+4936412934100", 'industry__996': 'construction', 'is_b2b__996': 'Yes', 'profile_id__996': 3, 'company_name__996': 'Elevion GmbH', 'url__996': 'http://www.elevion.de', 'additional_info__997': '{"employee_count": 23, "match_reasoning": "Fokus auf Industrieunternehmen mit komplexen technischen Anlagen.; Bietet L\\u00f6sungen f\\u00fcr die War ... (588 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__997': "'+497305958911", 'industry__997': 'semiconductors', 'is_b2b__997': 'Yes', 'profile_id__997': 3, 'company_name__997': 'SAX Power GmbH', 'url__997': 'http://www.sax-power.net', 'additional_info__998': '{"employee_count": 19, "match_reasoning": "Gemeinsame Branche: EdTech und E-Learning f\\u00fcr den Gesundheits- und Sozialbereich.; \\u00c4hnliche Pr ... (667 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__998': None, 'industry__998': 'information technology & services', 'is_b2b__998': 'Yes', 'profile_id__998': 3, 'company_name__998': 'Fuxam', 'url__998': 'http://www.fuxam.com', 'additional_info__999': '{"employee_count": 28, "match_reasoning": "Fokus auf Industrieunternehmen mit komplexen technischen Anlagen.; Beratung und Entwicklung kundenspezifis ... (554 characters truncated) ... h {programmatic placeholder} Leads und m\\u00f6chten gerne besprechen, wie wir das auch f\\u00fcr Sie erreichen k\\u00f6nnen.", "serves_1000": "Yes"}', 'phone_number__999': "'+49931460660", 'industry__999': 'information technology & services', 'is_b2b__999': 'Yes', 'profile_id__999': 3, 'company_name__999': 'CaderaDesign', 'url__999': 'http://www.caderadesign.de'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-07 10:16:17,708 - INFO - root - ETL pipeline finished.
2025-07-07 10:16:41,389 - INFO - root - Logging configured successfully.
2025-07-07 10:16:41,389 - INFO - root - ETL pipeline started.
2025-07-07 10:16:41,446 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 10:16:43,885 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 10:16:43,886 - INFO - etl.scripts.extract - Found 1 CSV files in etl/input_data.
2025-07-07 10:16:43,886 - INFO - root - --- Processing file: mid_001_ER4K_spg_apol_20250701.csv ---
2025-07-07 10:16:43,887 - INFO - etl.scripts.extract - Extracting data from mid_001_ER4K_spg_apol_20250701.csv...
2025-07-07 10:16:43,948 - INFO - etl.scripts.extract - Successfully extracted 4280 rows from mid_001_ER4K_spg_apol_20250701.csv.
2025-07-07 10:16:43,948 - INFO - etl.scripts.transform - Applying column standardization and mapping...
2025-07-07 10:16:43,949 - INFO - etl.scripts.transform - Applied aliases. Columns are now: ['Company Phone', 'Website', 'Industry', 'employee_count', 'Company', 'original_index', 'is_b2b', 'serves_1000', 'sales_pitch', 'matched_golden_partner', 'match_reasoning']
2025-07-07 10:16:43,950 - INFO - etl.scripts.transform - Applied main column mapping. Columns are now: ['phone_number', 'url', 'industry', 'employee_count', 'company_name', 'original_index', 'is_b2b', 'serves_1000', 'sales_pitch', 'matched_golden_partner', 'match_reasoning']
2025-07-07 10:16:43,950 - INFO - etl.scripts.transform - Consolidating columns into 'additional_info': ['employee_count', 'match_reasoning', 'matched_golden_partner', 'original_index', 'sales_pitch', 'serves_1000']
2025-07-07 10:16:44,001 - INFO - etl.scripts.transform - Column mapping complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'additional_info']
2025-07-07 10:16:44,002 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 10:16:44,008 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 10:16:44,015 - INFO - etl.scripts.transform - Removed 912 duplicate phone numbers from the source file.
2025-07-07 10:16:44,015 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 10:16:44,015 - INFO - root - Starting deduplication...
2025-07-07 10:16:44,016 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 10:16:44,147 - INFO - root - Deduplication complete. 3368 rows remaining for insertion.
2025-07-07 10:16:44,539 - INFO - etl.scripts.load - Found existing profile_id: 3 for hash: 476ed6da0a539766468d18a9bf00b3b4
2025-07-07 10:16:44,559 - INFO - etl.scripts.load - Loading 3368 rows with profile_id 3 into 'contacts' table...
2025-07-07 10:16:45,791 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 10:16:45,793 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\mid_001_ER4K_spg_apol_20250701.csv
2025-07-07 10:16:45,793 - INFO - root - ETL pipeline finished.
2025-07-07 10:51:35,088 - INFO - root - Logging configured successfully.
2025-07-07 10:51:53,656 - INFO - root - Logging configured successfully.
2025-07-07 10:51:53,657 - INFO - root - Fetching contact profiles...
2025-07-07 10:51:53,937 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 11:47:20,030 - INFO - root - Logging configured successfully.
2025-07-07 11:47:20,031 - INFO - root - ETL pipeline started.
2025-07-07 11:47:20,143 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 11:47:22,389 - INFO - root - Loaded 3368 existing contacts for deduplication.
2025-07-07 11:47:22,390 - INFO - etl.scripts.extract - Found 1 CSV files in etl/input_data.
2025-07-07 11:47:22,391 - INFO - root - --- Processing file: mid_001_ER4K_spg_apol_20250701.csv ---
2025-07-07 11:47:22,391 - INFO - etl.scripts.extract - Extracting data from mid_001_ER4K_spg_apol_20250701.csv...
2025-07-07 11:47:22,445 - INFO - etl.scripts.extract - Successfully extracted 4280 rows from mid_001_ER4K_spg_apol_20250701.csv.
2025-07-07 11:47:22,445 - INFO - etl.scripts.transform - Applying column standardization and mapping...
2025-07-07 11:47:22,448 - INFO - etl.scripts.transform - Applied aliases. Columns are now: ['Company Phone', 'Website', 'Industry', 'employee_count', 'Company', 'original_index', 'is_b2b', 'serves_1000', 'sales_pitch', 'matched_golden_partner', 'match_reasoning']
2025-07-07 11:47:22,449 - INFO - etl.scripts.transform - Applied main column mapping. Columns are now: ['phone_number', 'url', 'industry', 'employee_count', 'company_name', 'original_index', 'is_b2b', 'serves_1000', 'sales_pitch', 'matched_golden_partner', 'match_reasoning']
2025-07-07 11:47:22,449 - INFO - etl.scripts.transform - Consolidating columns into 'additional_info': ['employee_count', 'match_reasoning', 'matched_golden_partner', 'original_index', 'sales_pitch', 'serves_1000']
2025-07-07 11:47:22,494 - INFO - etl.scripts.transform - Column mapping complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'additional_info']
2025-07-07 11:47:22,495 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 11:47:22,501 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 11:47:22,535 - INFO - etl.scripts.transform - Saved 912 duplicate rows to etl/dropped_duplicates\duplicates_20250707_114722.csv
2025-07-07 11:47:22,536 - INFO - etl.scripts.transform - Removed 912 duplicate phone numbers from the source file.
2025-07-07 11:47:22,537 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 11:47:22,537 - INFO - root - Starting deduplication...
2025-07-07 11:47:22,541 - INFO - root - Removed 3367 rows with existing phone numbers.
2025-07-07 11:47:22,542 - WARNING - root - Potential duplicate found for 'Personal Search AG'. Similarity: 100.0%. Matched with: 'personal search ag'. Skipping row and adding to review file.
2025-07-07 11:48:27,061 - INFO - root - Logging configured successfully.
2025-07-07 11:48:27,062 - INFO - root - ETL pipeline started.
2025-07-07 11:48:27,132 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 11:48:29,571 - INFO - root - Loaded 3368 existing contacts for deduplication.
2025-07-07 11:48:29,572 - INFO - etl.scripts.extract - Found 1 CSV files in etl/input_data.
2025-07-07 11:48:29,572 - INFO - root - --- Processing file: mid_001_ER4K_spg_apol_20250701.csv ---
2025-07-07 11:48:29,572 - INFO - etl.scripts.extract - Extracting data from mid_001_ER4K_spg_apol_20250701.csv...
2025-07-07 11:48:29,629 - INFO - etl.scripts.extract - Successfully extracted 4280 rows from mid_001_ER4K_spg_apol_20250701.csv.
2025-07-07 11:48:29,635 - INFO - etl.scripts.transform - Applying column standardization and mapping...
2025-07-07 11:48:29,637 - INFO - etl.scripts.transform - Applied aliases. Columns are now: ['Company Phone', 'Website', 'Industry', 'employee_count', 'Company', 'original_index', 'is_b2b', 'serves_1000', 'sales_pitch', 'matched_golden_partner', 'match_reasoning']
2025-07-07 11:48:29,638 - INFO - etl.scripts.transform - Applied main column mapping. Columns are now: ['phone_number', 'url', 'industry', 'employee_count', 'company_name', 'original_index', 'is_b2b', 'serves_1000', 'sales_pitch', 'matched_golden_partner', 'match_reasoning']
2025-07-07 11:48:29,641 - INFO - etl.scripts.transform - Consolidating columns into 'additional_info': ['employee_count', 'match_reasoning', 'matched_golden_partner', 'original_index', 'sales_pitch', 'serves_1000']
2025-07-07 11:48:29,707 - INFO - etl.scripts.transform - Column mapping complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'additional_info']
2025-07-07 11:48:29,708 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 11:48:29,713 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 11:48:29,741 - INFO - etl.scripts.transform - Saved 912 duplicate rows to etl/dropped_duplicates\duplicates_20250707_114829.csv
2025-07-07 11:48:29,743 - INFO - etl.scripts.transform - Removed 912 duplicate phone numbers from the source file.
2025-07-07 11:48:29,743 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 11:48:29,744 - INFO - root - Starting deduplication...
2025-07-07 11:48:29,746 - INFO - root - Removed 3367 rows with existing phone numbers.
2025-07-07 11:48:29,747 - WARNING - root - Potential duplicate found for 'Personal Search AG'. Similarity: 100.0%. Matched with: 'personal search ag'. Skipping row and adding to review file.
2025-07-07 11:48:29,751 - INFO - root - Saved 1 potential duplicates to etl/review\review_mid_001_ER4K_spg_apol_20250701.csv
2025-07-07 11:48:29,751 - INFO - root - Deduplication complete. 0 rows remaining for insertion.
2025-07-07 11:48:29,751 - INFO - etl.scripts.load - DataFrame is empty. Nothing to load to the database.
2025-07-07 11:48:29,753 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\mid_001_ER4K_spg_apol_20250701.csv
2025-07-07 11:48:29,753 - INFO - root - ETL pipeline finished.
2025-07-07 11:48:46,484 - INFO - root - Logging configured successfully.
2025-07-07 11:48:46,485 - INFO - root - Checking for files in etl\review...
2025-07-07 11:51:20,201 - INFO - root - Logging configured successfully.
2025-07-07 11:51:20,202 - INFO - root - Checking for files in etl\dropped_duplicates...
2025-07-07 13:32:33,425 - INFO - root - Logging configured successfully.
2025-07-07 13:32:41,454 - WARNING - root - --- Starting Database Reset ---
2025-07-07 13:32:41,761 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:32:43,007 - INFO - root - Deleting all records from 'contacts' table...
2025-07-07 13:32:43,205 - INFO - root - ...done.
2025-07-07 13:32:43,205 - INFO - root - Deleting all records from 'contact_profiles' table...
2025-07-07 13:32:43,315 - INFO - root - ...done.
2025-07-07 13:32:43,396 - INFO - root - --- Database Reset Successfully ---
2025-07-07 13:36:39,512 - INFO - root - Logging configured successfully.
2025-07-07 13:36:39,512 - INFO - root - ETL pipeline started.
2025-07-07 13:36:39,569 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:36:41,232 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 13:36:41,233 - INFO - etl.scripts.extract - Found 1 CSV files in etl/input_data.
2025-07-07 13:36:41,234 - INFO - root - --- Processing file: SOR_7K_20250627_163929_regenerated_final.csv ---
2025-07-07 13:36:41,234 - INFO - etl.scripts.extract - Extracting data from SOR_7K_20250627_163929_regenerated_final.csv...
2025-07-07 13:36:41,636 - INFO - etl.scripts.extract - Successfully extracted 7383 rows from SOR_7K_20250627_163929_regenerated_final.csv.
2025-07-07 13:36:41,637 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 13:36:41,637 - INFO - etl.scripts.transform - Consolidating all source columns into 'additional_info'.
2025-07-07 13:36:41,851 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'Apollo'
2025-07-07 13:36:41,869 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 13:36:41,871 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 13:36:41,883 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 13:36:41,945 - INFO - etl.scripts.transform - Saved 1574 duplicate rows to etl/dropped_duplicates\duplicates_20250707_133641.csv
2025-07-07 13:36:41,947 - INFO - etl.scripts.transform - Removed 1574 duplicate phone numbers from the source file.
2025-07-07 13:36:41,947 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 13:36:41,947 - INFO - root - Starting deduplication...
2025-07-07 13:36:41,950 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 13:36:42,285 - INFO - root - Deduplication complete. 5809 rows remaining for insertion.
2025-07-07 13:36:42,565 - INFO - etl.scripts.load - Created new profile_id: 4 for hash: 245f0b44d662f87f8977f9dca02818c1
2025-07-07 13:36:42,566 - INFO - etl.scripts.load - Loading 5809 rows with profile_id 4 into 'contacts' table...
2025-07-07 13:36:43,529 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 13:36:43,541 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SOR_7K_20250627_163929_regenerated_final.csv
2025-07-07 13:36:43,541 - INFO - root - ETL pipeline finished.
2025-07-07 13:36:58,942 - INFO - root - Logging configured successfully.
2025-07-07 13:36:58,943 - INFO - root - Generating audit report for contact ID: 1
2025-07-07 13:36:58,999 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:37:13,327 - INFO - root - Logging configured successfully.
2025-07-07 13:37:13,328 - INFO - root - Fetching the last 1 contacts...
2025-07-07 13:37:13,379 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:37:23,228 - INFO - root - Logging configured successfully.
2025-07-07 13:37:23,229 - INFO - root - Generating audit report for contact ID: 6635
2025-07-07 13:37:23,285 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:38:36,232 - INFO - root - Logging configured successfully.
2025-07-07 13:38:36,234 - INFO - root - Generating audit report for contact ID: 6635
2025-07-07 13:38:36,297 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:39:46,645 - INFO - root - Logging configured successfully.
2025-07-07 13:39:49,802 - WARNING - root - --- Starting Database Reset ---
2025-07-07 13:39:49,871 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:39:51,071 - INFO - root - Deleting all records from 'contacts' table...
2025-07-07 13:39:51,271 - INFO - root - ...done.
2025-07-07 13:39:51,271 - INFO - root - Deleting all records from 'contact_profiles' table...
2025-07-07 13:39:51,347 - INFO - root - ...done.
2025-07-07 13:39:51,460 - INFO - root - --- Database Reset Successfully ---
2025-07-07 13:40:11,844 - INFO - root - Logging configured successfully.
2025-07-07 13:40:11,845 - INFO - root - ETL pipeline started.
2025-07-07 13:40:11,911 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:40:13,638 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 13:40:13,640 - INFO - etl.scripts.extract - Found 1 CSV files in etl/input_data.
2025-07-07 13:40:13,641 - INFO - root - --- Processing file: SOR_7K_20250627_163929_regenerated_final.csv ---
2025-07-07 13:40:13,641 - INFO - etl.scripts.extract - Extracting data from SOR_7K_20250627_163929_regenerated_final.csv...
2025-07-07 13:40:14,309 - INFO - etl.scripts.extract - Successfully extracted 7383 rows from SOR_7K_20250627_163929_regenerated_final.csv.
2025-07-07 13:40:14,309 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 13:40:14,309 - INFO - etl.scripts.transform - Consolidating all source columns into 'additional_info'.
2025-07-07 13:40:14,698 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'Apollo'
2025-07-07 13:40:15,045 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 13:40:15,048 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 13:40:15,063 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 13:40:15,429 - INFO - etl.scripts.transform - Saved 1574 duplicate rows to etl/dropped_duplicates\duplicates_20250707_134015.csv
2025-07-07 13:40:15,434 - INFO - etl.scripts.transform - Removed 1574 duplicate phone numbers from the source file.
2025-07-07 13:40:15,434 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 13:40:15,435 - INFO - root - Starting deduplication...
2025-07-07 13:40:15,438 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 13:40:16,240 - INFO - root - Deduplication complete. 5809 rows remaining for insertion.
2025-07-07 13:40:16,538 - INFO - etl.scripts.load - Created new profile_id: 5 for hash: 245f0b44d662f87f8977f9dca02818c1
2025-07-07 13:40:16,539 - INFO - etl.scripts.load - Loading 5809 rows with profile_id 5 into 'contacts' table...
2025-07-07 13:40:24,302 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 13:40:24,303 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SOR_7K_20250627_163929_regenerated_final.csv
2025-07-07 13:40:24,303 - INFO - root - ETL pipeline finished.
2025-07-07 13:40:36,162 - INFO - root - Logging configured successfully.
2025-07-07 13:40:36,164 - INFO - root - Fetching the last 1 contacts...
2025-07-07 13:40:36,238 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:40:47,874 - INFO - root - Logging configured successfully.
2025-07-07 13:40:47,876 - INFO - root - Generating audit report for contact ID: 12444
2025-07-07 13:40:47,937 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:41:13,404 - INFO - root - Logging configured successfully.
2025-07-07 13:41:16,387 - WARNING - root - --- Starting Database Reset ---
2025-07-07 13:41:16,451 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:41:17,805 - INFO - root - Deleting all records from 'contacts' table...
2025-07-07 13:41:18,017 - INFO - root - ...done.
2025-07-07 13:41:18,017 - INFO - root - Deleting all records from 'contact_profiles' table...
2025-07-07 13:41:18,117 - INFO - root - ...done.
2025-07-07 13:41:18,257 - INFO - root - --- Database Reset Successfully ---
2025-07-07 13:41:34,164 - INFO - root - Logging configured successfully.
2025-07-07 13:41:34,165 - INFO - root - ETL pipeline started.
2025-07-07 13:41:34,233 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:41:36,012 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 13:41:36,014 - INFO - etl.scripts.extract - Found 1 CSV files in etl/input_data.
2025-07-07 13:41:36,015 - INFO - root - --- Processing file: SOR_7K_20250627_163929_regenerated_final.csv ---
2025-07-07 13:41:36,015 - INFO - etl.scripts.extract - Extracting data from SOR_7K_20250627_163929_regenerated_final.csv...
2025-07-07 13:41:36,812 - INFO - etl.scripts.extract - Successfully extracted 7383 rows from SOR_7K_20250627_163929_regenerated_final.csv.
2025-07-07 13:41:36,813 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 13:41:36,813 - INFO - etl.scripts.transform - Consolidating all source columns into 'additional_info'.
2025-07-07 13:41:37,266 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'Apollo'
2025-07-07 13:41:37,709 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 13:41:37,718 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 13:41:37,749 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 13:41:38,138 - INFO - etl.scripts.transform - Saved 1574 duplicate rows to etl/dropped_duplicates\duplicates_20250707_134137.csv
2025-07-07 13:41:38,152 - INFO - etl.scripts.transform - Removed 1574 duplicate phone numbers from the source file.
2025-07-07 13:41:38,155 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 13:41:38,159 - INFO - root - Starting deduplication...
2025-07-07 13:41:38,166 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 13:41:38,743 - INFO - root - Deduplication complete. 5809 rows remaining for insertion.
2025-07-07 13:41:39,031 - INFO - etl.scripts.load - Created new profile_id: 6 for hash: 245f0b44d662f87f8977f9dca02818c1
2025-07-07 13:41:39,032 - INFO - etl.scripts.load - Loading 5809 rows with profile_id 6 into 'contacts' table...
2025-07-07 13:41:45,387 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 13:41:45,388 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SOR_7K_20250627_163929_regenerated_final.csv
2025-07-07 13:41:45,388 - INFO - root - ETL pipeline finished.
2025-07-07 13:43:25,977 - INFO - root - Logging configured successfully.
2025-07-07 13:43:25,978 - INFO - root - Fetching the last 1 contacts...
2025-07-07 13:43:26,032 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:43:35,877 - INFO - root - Logging configured successfully.
2025-07-07 13:43:35,879 - INFO - root - Generating audit report for contact ID: 18253
2025-07-07 13:43:35,951 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:44:48,155 - INFO - root - Logging configured successfully.
2025-07-07 13:44:50,301 - WARNING - root - --- Starting Database Reset ---
2025-07-07 13:44:50,371 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:44:51,933 - INFO - root - Deleting all records from 'contacts' table...
2025-07-07 13:44:52,291 - INFO - root - ...done.
2025-07-07 13:44:52,291 - INFO - root - Deleting all records from 'contact_profiles' table...
2025-07-07 13:44:52,430 - INFO - root - ...done.
2025-07-07 13:44:52,624 - INFO - root - --- Database Reset Successfully ---
2025-07-07 13:45:08,651 - INFO - root - Logging configured successfully.
2025-07-07 13:45:08,651 - INFO - root - ETL pipeline started.
2025-07-07 13:45:08,708 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:45:10,253 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 13:45:10,254 - INFO - etl.scripts.extract - Found 1 CSV files in etl/input_data.
2025-07-07 13:45:10,254 - INFO - root - --- Processing file: SOR_7K_20250627_163929_regenerated_final.csv ---
2025-07-07 13:45:10,254 - INFO - etl.scripts.extract - Extracting data from SOR_7K_20250627_163929_regenerated_final.csv...
2025-07-07 13:45:10,780 - INFO - etl.scripts.extract - Successfully extracted 7383 rows from SOR_7K_20250627_163929_regenerated_final.csv.
2025-07-07 13:45:10,781 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 13:45:10,802 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'Apollo'
2025-07-07 13:45:11,175 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 13:45:11,177 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 13:45:11,187 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 13:45:11,461 - INFO - etl.scripts.transform - Saved 1574 duplicate rows to etl/dropped_duplicates\duplicates_20250707_134511.csv
2025-07-07 13:45:11,463 - INFO - etl.scripts.transform - Removed 1574 duplicate phone numbers from the source file.
2025-07-07 13:45:11,464 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 13:45:11,464 - INFO - root - Starting deduplication...
2025-07-07 13:45:11,466 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 13:45:12,046 - INFO - root - Deduplication complete. 5809 rows remaining for insertion.
2025-07-07 13:45:12,483 - INFO - etl.scripts.load - Created new profile_id: 7 for hash: ebb2ce72311169a7ea0a409c9c2c5a21
2025-07-07 13:45:12,484 - INFO - etl.scripts.load - Loading 5809 rows with profile_id 7 into 'contacts' table...
2025-07-07 13:45:19,265 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 13:45:19,266 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SOR_7K_20250627_163929_regenerated_final.csv
2025-07-07 13:45:19,266 - INFO - root - ETL pipeline finished.
2025-07-07 13:45:58,822 - INFO - root - Logging configured successfully.
2025-07-07 13:45:58,823 - INFO - root - Fetching the last 1 contacts...
2025-07-07 13:45:58,913 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:46:23,539 - INFO - root - Logging configured successfully.
2025-07-07 13:46:23,541 - INFO - root - Generating audit report for contact ID: 24062
2025-07-07 13:46:23,627 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:49:31,728 - INFO - root - Logging configured successfully.
2025-07-07 13:51:39,841 - WARNING - root - --- Starting Database Reset ---
2025-07-07 13:51:39,904 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:51:41,274 - INFO - root - Deleting all records from 'contacts' table...
2025-07-07 13:51:41,515 - INFO - root - ...done.
2025-07-07 13:51:41,515 - INFO - root - Deleting all records from 'contact_profiles' table...
2025-07-07 13:51:41,622 - INFO - root - ...done.
2025-07-07 13:51:41,723 - INFO - root - --- Database Reset Successfully ---
2025-07-07 13:53:20,113 - INFO - root - Logging configured successfully.
2025-07-07 13:53:20,115 - INFO - root - ETL pipeline started.
2025-07-07 13:53:20,184 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:53:22,556 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 13:53:22,557 - INFO - etl.scripts.extract - Found 1 CSV files in etl/input_data.
2025-07-07 13:53:22,557 - INFO - root - --- Processing file: SOR_7K_20250627_163929_regenerated_final.csv ---
2025-07-07 13:53:22,558 - INFO - etl.scripts.extract - Extracting data from SOR_7K_20250627_163929_regenerated_final.csv...
2025-07-07 13:53:23,615 - INFO - etl.scripts.extract - Successfully extracted 7383 rows from SOR_7K_20250627_163929_regenerated_final.csv.
2025-07-07 13:53:23,616 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 13:53:23,678 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'Apollo'
2025-07-07 13:53:23,701 - DEBUG - etl.scripts.transform - Before assembly, df columns are: ['Company', '# Employees', 'Industry', 'Website', 'Company Linkedin Url', 'Facebook Url', 'Twitter Url', 'Company Street', 'Company City', 'Company State', 'Company Country', 'Company Postal Code', 'Company Address', 'Keywords', 'Company Phone', 'SEO Description', 'Technologies', 'Total Funding', 'Latest Funding', 'Latest Funding Amount', 'Last Raised At', 'Annual Revenue', 'SIC Codes', 'Short Description', 'Founded Year', 'employees_numeric', 'Company_Size_Category', 'revenue_numeric', 'Industry_Category_Standardized', 'Country_Standardized', 'Geographic_Reach_Category_Standardized', 'Combined_Description', 'description_language_sample', 'Company Name', 'URL', 'original_index', 'is_b2b', 'serves_1000', 'sales_pitch', 'matched_golden_partner', 'match_reasoning', 'Matched Partner Description', 'company_name', 'url', 'phone_number', 'industry', 'customer_target_segments']
2025-07-07 13:53:23,704 - DEBUG - etl.scripts.transform - Creating 'additional_info' from raw_json_df...
2025-07-07 13:53:24,266 - DEBUG - etl.scripts.transform - Type of 'additional_info' column after to_dict: <class 'dict'>
2025-07-07 13:53:24,613 - DEBUG - etl.scripts.transform - Type of 'additional_info' column after json.dumps: <class 'str'>
2025-07-07 13:53:24,614 - DEBUG - etl.scripts.transform - Sample additional_info value: {"Company": "Trafo Baden \u2502 Congress. Hotels. Catering.", "# Employees": 27.0, "Industry": "events services", "Website": "http://www.trafobaden.ch", "Company Linkedin Url": "http://www.linkedin.com/company/trafo-baden---hallen-&-hotel", "Facebook Url": "https://www.facebook.com/trafobaden", "Twitter Url": null, "Company Street": "1 Brown Boveri Platz", "Company City": "Baden", "Company State": "Aargau", "Company Country": "Switzerland", "Company Postal Code": 5400.0, "Company Address": "1 Brown Boveri Platz, Baden, Aargau, Switzerland, 5400", "Keywords": "veranstaltungen, kongresse bis 1500 personen, bankette seminare, events", "Company Phone": "'+41 56 204 08 88", "SEO Description": null, "Technologies": "Salesforce, Outlook, Hubspot, YouTube, Typekit, Nginx, reCAPTCHA, Ubuntu, Mobile Friendly, Google Tag Manager, Google Analytics, Facebook Custom Audiences, Apache", "Total Funding": null, "Latest Funding": null, "Latest Funding Amount": null, "Last Raised At": null, "Annual Revenue": null, "SIC Codes": null, "Short Description": "Vorhang auf f\u00fcr Ihren Event. Laden Sie ein, schaffen Sie Welten, verbl\u00fcffen Sie Besucher, bringen Sie Ihr Publikum zum Staunen. Sch\u00f6pfen Sie aus dem Vollen, inszenieren Sie Ihre Shows, Konzerte, Messen und Ausstellungen in den grossz\u00fcgigen Eventr\u00e4umen des TRAFO.\n\nZ\u00e4hlen Sie f\u00fcr Ihren Event auf die weitreichende Erfahrung und das vertiefte Fachwissen unserer Veranstaltungstechniker und Eventplaner. Bespielen Sie Eventr\u00e4ume unterschiedlicher Gr\u00f6sse wie die TRAFOHALLE oder den Glassaal. Verw\u00f6hnen Sie Ihr Publikum mit den K\u00f6stlichkeiten unserer Eventkulinarik.\n\nNennen Sie die Ziele Ihres Events und nutzen Sie die Beratung unserer Spezialisten aus unz\u00e4hligen Veranstaltungen. TRAFO Baden - f\u00fcr jeden Event stimmen Raum, Technik, Mobiliar und Dekoration.", "Founded Year": 2003.0, "employees_numeric": 27.0, "Company_Size_Category": "11-50", "revenue_numeric": null, "Industry_Category_Standardized": "Business Consulting / Management Consulting", "Country_Standardized": "Switzerland", "Geographic_Reach_Category_Standardized": "National (Switzerland)", "Combined_Description": "Vorhang auf f\u00fcr Ihren Event. Laden Sie ein, schaffen Sie Welten, verbl\u00fcffen Sie Besucher, bringen Sie Ihr Publikum zum Staunen. Sch\u00f6pfen Sie aus dem Vollen, inszenieren Sie Ihre Shows, Konzerte, Messen und Ausstellungen in den grossz\u00fcgigen Eventr\u00e4umen des TRAFO.\n\nZ\u00e4hlen Sie f\u00fcr Ihren Event auf die weitreichende Erfahrung und das vertiefte Fachwissen unserer Veranstaltungstechniker und Eventplaner. Bespielen Sie Eventr\u00e4ume unterschiedlicher Gr\u00f6sse wie die TRAFOHALLE oder den Glassaal. Verw\u00f6hnen Sie Ihr Publikum mit den K\u00f6stlichkeiten unserer Eventkulinarik.\n\nNennen Sie die Ziele Ihres Events und nutzen Sie die Beratung unserer Spezialisten aus unz\u00e4hligen Veranstaltungen. TRAFO Baden - f\u00fcr jeden Event stimmen Raum, Technik, Mobiliar und Dekoration.", "description_language_sample": null, "Company Name": null, "URL": null, "original_index": 0, "is_b2b": "Yes", "serves_1000": "Yes", "sales_pitch": "Ich rufe Sie an, weil wir bereits sehr erfolgreich ein \u00e4hnliches Projekt umgesetzt haben \u2013 f\u00fcr ein Unternehmen aus dem Bereich IT-Dienstleistungen, das sich auf die technische Systemrealisierung von Smarthome-Technologien und Datennetzwerken spezialisiert hat, was insbesondere f\u00fcr Eventlocations relevant ist. F\u00fcr dieses Unternehmen generieren wir t\u00e4glich {programmatic placeholder} Leads und m\u00f6chten gerne besprechen, wie wir das auch f\u00fcr Sie erreichen k\u00f6nnen.", "matched_golden_partner": "visitronic GmbH", "match_reasoning": "\u00dcberschneidung im Bereich IT-Dienstleistungen und technische Systemrealisierung.; Spezialisierung auf Smarthome-Technologie, die f\u00fcr Eventlocations relevant sein kann.; Angebote f\u00fcr Datennetzwerke und Telekommunikation, die f\u00fcr moderne Eventlocations wichtig sind.", "Matched Partner Description": null}
2025-07-07 13:53:24,617 - DEBUG - etl.scripts.transform - Final DataFrame columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 13:53:24,618 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 13:53:24,622 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 13:53:24,655 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 13:53:25,027 - INFO - etl.scripts.transform - Saved 1574 duplicate rows to etl/dropped_duplicates\duplicates_20250707_135324.csv
2025-07-07 13:53:25,030 - INFO - etl.scripts.transform - Removed 1574 duplicate phone numbers from the source file.
2025-07-07 13:53:25,031 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 13:53:25,031 - INFO - root - Starting deduplication...
2025-07-07 13:53:25,037 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 13:53:25,648 - INFO - root - Deduplication complete. 5809 rows remaining for insertion.
2025-07-07 13:53:25,929 - INFO - etl.scripts.load - Created new profile_id: 8 for hash: ebb2ce72311169a7ea0a409c9c2c5a21
2025-07-07 13:53:25,929 - INFO - etl.scripts.load - Loading 5809 rows with profile_id 8 into 'contacts' table...
2025-07-07 13:53:33,452 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 13:53:33,454 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SOR_7K_20250627_163929_regenerated_final.csv
2025-07-07 13:53:33,456 - INFO - root - ETL pipeline finished.
2025-07-07 13:54:13,237 - INFO - root - Logging configured successfully.
2025-07-07 13:54:18,698 - WARNING - root - --- Starting Database Reset ---
2025-07-07 13:54:18,760 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:54:20,007 - INFO - root - Deleting all records from 'contacts' table...
2025-07-07 13:54:20,237 - INFO - root - ...done.
2025-07-07 13:54:20,238 - INFO - root - Deleting all records from 'contact_profiles' table...
2025-07-07 13:54:20,322 - INFO - root - ...done.
2025-07-07 13:54:20,412 - INFO - root - --- Database Reset Successfully ---
2025-07-07 13:54:38,264 - INFO - root - Logging configured successfully.
2025-07-07 13:54:38,265 - INFO - root - ETL pipeline started.
2025-07-07 13:54:38,330 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:54:40,715 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 13:54:40,716 - INFO - etl.scripts.extract - Found 1 CSV files in etl/input_data.
2025-07-07 13:54:40,716 - INFO - root - --- Processing file: SOR_7K_20250627_163929_regenerated_final.csv ---
2025-07-07 13:54:40,717 - INFO - etl.scripts.extract - Extracting data from SOR_7K_20250627_163929_regenerated_final.csv...
2025-07-07 13:54:41,148 - INFO - etl.scripts.extract - Successfully extracted 7383 rows from SOR_7K_20250627_163929_regenerated_final.csv.
2025-07-07 13:54:41,149 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 13:54:41,173 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'Apollo'
2025-07-07 13:54:41,602 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 13:54:41,604 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 13:54:41,617 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 13:54:41,871 - INFO - etl.scripts.transform - Saved 1574 duplicate rows to etl/dropped_duplicates\duplicates_20250707_135441.csv
2025-07-07 13:54:41,874 - INFO - etl.scripts.transform - Removed 1574 duplicate phone numbers from the source file.
2025-07-07 13:54:41,875 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 13:54:41,876 - INFO - root - Starting deduplication...
2025-07-07 13:54:41,879 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 13:54:42,346 - INFO - root - Deduplication complete. 5809 rows remaining for insertion.
2025-07-07 13:54:42,654 - INFO - etl.scripts.load - Created new profile_id: 9 for hash: ebb2ce72311169a7ea0a409c9c2c5a21
2025-07-07 13:54:42,655 - INFO - etl.scripts.load - Loading 5809 rows with profile_id 9 into 'contacts' table...
2025-07-07 13:54:51,055 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 13:54:51,056 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SOR_7K_20250627_163929_regenerated_final.csv
2025-07-07 13:54:51,057 - INFO - root - ETL pipeline finished.
2025-07-07 13:55:00,895 - INFO - root - Logging configured successfully.
2025-07-07 13:55:00,897 - INFO - root - Fetching the last 1 contacts...
2025-07-07 13:55:01,005 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:55:14,653 - INFO - root - Logging configured successfully.
2025-07-07 13:55:14,655 - INFO - root - Generating audit report for contact ID: 35680
2025-07-07 13:55:14,738 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:55:55,997 - INFO - root - Logging configured successfully.
2025-07-07 13:56:49,165 - WARNING - root - --- Starting Database Reset ---
2025-07-07 13:56:49,227 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:56:50,745 - INFO - root - Deleting all records from 'contacts' table...
2025-07-07 13:56:51,399 - INFO - root - ...done.
2025-07-07 13:56:51,399 - INFO - root - Deleting all records from 'contact_profiles' table...
2025-07-07 13:56:51,553 - INFO - root - ...done.
2025-07-07 13:56:51,723 - INFO - root - --- Database Reset Successfully ---
2025-07-07 13:57:16,586 - INFO - root - Logging configured successfully.
2025-07-07 13:57:16,587 - INFO - root - ETL pipeline started.
2025-07-07 13:57:16,649 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:57:19,665 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 13:57:19,666 - INFO - etl.scripts.extract - Found 1 CSV files in etl/input_data.
2025-07-07 13:57:19,666 - INFO - root - --- Processing file: SOR_7K_20250627_163929_regenerated_final.csv ---
2025-07-07 13:57:19,666 - INFO - etl.scripts.extract - Extracting data from SOR_7K_20250627_163929_regenerated_final.csv...
2025-07-07 13:57:20,075 - INFO - etl.scripts.extract - Successfully extracted 7383 rows from SOR_7K_20250627_163929_regenerated_final.csv.
2025-07-07 13:57:20,075 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 13:57:20,097 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'Apollo'
2025-07-07 13:57:20,480 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 13:57:20,482 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 13:57:20,494 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 13:57:20,636 - INFO - etl.scripts.transform - Saved 1574 duplicate rows to etl/dropped_duplicates\duplicates_20250707_135720.csv
2025-07-07 13:57:20,638 - INFO - etl.scripts.transform - Removed 1574 duplicate phone numbers from the source file.
2025-07-07 13:57:20,639 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 13:57:20,639 - INFO - root - Starting deduplication...
2025-07-07 13:57:20,642 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 13:57:21,112 - INFO - root - Deduplication complete. 5809 rows remaining for insertion.
2025-07-07 13:57:21,397 - INFO - etl.scripts.load - Created new profile_id: 10 for hash: ebb2ce72311169a7ea0a409c9c2c5a21
2025-07-07 13:57:21,399 - INFO - etl.scripts.load - Loading 5809 rows with profile_id 10 into 'contacts' table...
2025-07-07 13:57:40,280 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 13:57:40,282 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SOR_7K_20250627_163929_regenerated_final.csv
2025-07-07 13:57:40,282 - INFO - root - ETL pipeline finished.
2025-07-07 13:58:02,941 - INFO - root - Logging configured successfully.
2025-07-07 13:58:02,943 - INFO - root - Fetching the last 1 contacts...
2025-07-07 13:58:03,001 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 13:59:01,780 - INFO - root - Logging configured successfully.
2025-07-07 13:59:01,783 - INFO - root - Generating audit report for contact ID: 42082
2025-07-07 13:59:01,917 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:03:27,327 - INFO - root - Logging configured successfully.
2025-07-07 14:03:27,328 - INFO - root - ETL pipeline started.
2025-07-07 14:03:27,396 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:03:35,054 - INFO - root - Loaded 5809 existing contacts for deduplication.
2025-07-07 14:03:35,056 - INFO - etl.scripts.extract - Found 0 CSV files in etl/input_data.
2025-07-07 14:03:35,056 - INFO - root - ETL pipeline finished.
2025-07-07 14:06:17,063 - INFO - root - Logging configured successfully.
2025-07-07 14:06:17,066 - INFO - root - ETL pipeline started.
2025-07-07 14:06:17,494 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:06:20,200 - INFO - root - Loaded 5809 existing contacts for deduplication.
2025-07-07 14:06:20,201 - INFO - etl.scripts.extract - Found 0 CSV files in etl/input_data.
2025-07-07 14:06:20,201 - INFO - root - ETL pipeline finished.
2025-07-07 14:06:57,518 - INFO - root - Logging configured successfully.
2025-07-07 14:06:57,519 - INFO - root - ETL pipeline started.
2025-07-07 14:06:57,582 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:07:01,429 - INFO - root - Loaded 5809 existing contacts for deduplication.
2025-07-07 14:07:01,430 - INFO - etl.scripts.extract - Found 1 CSV files in etl/input_data.
2025-07-07 14:07:01,430 - INFO - root - --- Processing file: SOR_7K_20250627_163929_regenerated_final.csv ---
2025-07-07 14:07:01,431 - INFO - etl.scripts.extract - Extracting data from SOR_7K_20250627_163929_regenerated_final.csv...
2025-07-07 14:07:01,920 - INFO - etl.scripts.extract - Successfully extracted 7383 rows from SOR_7K_20250627_163929_regenerated_final.csv.
2025-07-07 14:07:01,920 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 14:07:01,943 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'Apollo'
2025-07-07 14:07:02,323 - INFO - etl.scripts.transform - --- Detailed 'additional_info' Diagnosis ---
2025-07-07 14:07:02,323 - INFO - etl.scripts.transform - Type of a single 'additional_info' value: <class 'str'>
2025-07-07 14:07:02,324 - INFO - etl.scripts.transform - Content of a single 'additional_info' value (first 500 chars): {"Company": "Trafo Baden \u2502 Congress. Hotels. Catering.", "# Employees": 27.0, "Industry": "events services", "Website": "http://www.trafobaden.ch", "Company Linkedin Url": "http://www.linkedin.com/company/trafo-baden---hallen-&-hotel", "Facebook Url": "https://www.facebook.com/trafobaden", "Twitter Url": null, "Company Street": "1 Brown Boveri Platz", "Company City": "Baden", "Company State": "Aargau", "Company Country": "Switzerland", "Company Postal Code": 5400.0, "Company Address": "1 Br
2025-07-07 14:07:02,324 - INFO - etl.scripts.transform - --- End Diagnosis ---
2025-07-07 14:07:02,326 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 14:07:02,328 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 14:07:02,338 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 14:07:02,477 - INFO - etl.scripts.transform - Saved 1574 duplicate rows to etl/dropped_duplicates\duplicates_20250707_140702.csv
2025-07-07 14:07:02,480 - INFO - etl.scripts.transform - Removed 1574 duplicate phone numbers from the source file.
2025-07-07 14:07:02,481 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 14:07:02,483 - INFO - root - Starting deduplication...
2025-07-07 14:07:02,488 - INFO - root - Removed 5808 rows with existing phone numbers.
2025-07-07 14:07:02,493 - WARNING - root - Potential duplicate found for 'Personal Search AG'. Similarity: 100.0%. Matched with: 'personal search ag'. Skipping row and adding to review file.
2025-07-07 14:07:02,501 - INFO - root - Saved 1 potential duplicates to etl/review\review_SOR_7K_20250627_163929_regenerated_final.csv
2025-07-07 14:07:02,501 - INFO - root - Deduplication complete. 0 rows remaining for insertion.
2025-07-07 14:07:02,501 - INFO - etl.scripts.load - DataFrame is empty. Nothing to load to the database.
2025-07-07 14:07:02,502 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SOR_7K_20250627_163929_regenerated_final.csv
2025-07-07 14:07:02,503 - INFO - root - ETL pipeline finished.
2025-07-07 14:11:40,858 - INFO - root - Logging configured successfully.
2025-07-07 14:11:40,858 - INFO - root - ETL pipeline started.
2025-07-07 14:11:40,929 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:11:44,132 - INFO - root - Loaded 5809 existing contacts for deduplication.
2025-07-07 14:11:44,133 - INFO - etl.scripts.extract - Found 0 CSV files in etl/input_data.
2025-07-07 14:11:44,134 - INFO - root - ETL pipeline finished.
2025-07-07 14:12:19,793 - INFO - root - Logging configured successfully.
2025-07-07 14:12:19,794 - INFO - root - ETL pipeline started.
2025-07-07 14:12:19,868 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:12:24,426 - INFO - root - Loaded 5809 existing contacts for deduplication.
2025-07-07 14:12:24,427 - INFO - etl.scripts.extract - Found 1 CSV files in etl/input_data.
2025-07-07 14:12:24,427 - INFO - root - --- Processing file: SOR_7K_20250627_163929_regenerated_final.csv ---
2025-07-07 14:12:24,427 - INFO - etl.scripts.extract - Extracting data from SOR_7K_20250627_163929_regenerated_final.csv...
2025-07-07 14:12:24,826 - INFO - etl.scripts.extract - Successfully extracted 7383 rows from SOR_7K_20250627_163929_regenerated_final.csv.
2025-07-07 14:12:24,827 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 14:12:24,846 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'Apollo'
2025-07-07 14:12:25,322 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 14:12:25,324 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 14:12:25,335 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 14:12:25,456 - INFO - etl.scripts.transform - Saved 1574 duplicate rows to etl/dropped_duplicates\duplicates_20250707_141225.csv
2025-07-07 14:12:25,457 - INFO - etl.scripts.transform - Removed 1574 duplicate phone numbers from the source file.
2025-07-07 14:12:25,458 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 14:12:25,458 - WARNING - root - Deduplication is temporarily disabled for debugging.
2025-07-07 14:12:25,459 - INFO - root - Deduplication complete. 5809 rows remaining for insertion.
2025-07-07 14:12:25,809 - INFO - etl.scripts.load - Found existing profile_id: 10 for hash: ebb2ce72311169a7ea0a409c9c2c5a21
2025-07-07 14:12:25,810 - INFO - etl.scripts.load - Loading 5809 rows with profile_id 10 into 'contacts' table...
2025-07-07 14:12:29,045 - ERROR - etl.scripts.load - Failed to load data into 'contacts': (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "unique_phone_number"
DETAIL:  Key (phone_number)=('+41562040888) already exists.

[SQL: INSERT INTO contacts (company_name, url, phone_number, industry, is_b2b, customer_target_segments, additional_info, profile_id) VALUES (%(company_name__0)s, %(url__0)s, %(phone_number__0)s, %(industry__0)s, %(is_b2b__0)s, %(customer_target_segments__ ... 178903 characters truncated ... , %(is_b2b__999)s, %(customer_target_segments__999)s, %(additional_info__999)s, %(profile_id__999)s)]
[parameters: {'customer_target_segments__0': None, 'additional_info__0': '{"Company": "Trafo Baden \\u2502 Congress. Hotels. Catering.", "# Employees": 27.0, "Industry": "events services", "Website": "http://www.trafobaden. ... (3828 characters truncated) ... .; Angebote f\\u00fcr Datennetzwerke und Telekommunikation, die f\\u00fcr moderne Eventlocations wichtig sind.", "Matched Partner Description": null}', 'url__0': 'http://www.trafobaden.ch', 'phone_number__0': "'+41562040888", 'profile_id__0': 10, 'industry__0': 'events services', 'company_name__0': 'Trafo Baden │ Congress. Hotels. Catering.', 'is_b2b__0': None, 'customer_target_segments__1': None, 'additional_info__1': '{"Company": "treuhand marugg + imsand", "# Employees": 29.0, "Industry": "accounting", "Website": "http://www.trmi.ch", "Company Linkedin Url": "http ... (2985 characters truncated) ... rberater, Wirtschaftspr\\u00fcfer), was eine potenzielle Synergie mit den Dienstleistungen von TRMI darstellt.", "Matched Partner Description": null}', 'url__1': 'http://www.trmi.ch', 'phone_number__1': "'+41279222949", 'profile_id__1': 10, 'industry__1': 'accounting', 'company_name__1': 'treuhand marugg + imsand', 'is_b2b__1': None, 'customer_target_segments__2': None, 'additional_info__2': '{"Company": "SEELAND JOB AG", "# Employees": 23.0, "Industry": "staffing & recruiting", "Website": "http://www.seelandjob.ch", "Company Linkedin Url" ... (3040 characters truncated) ... nd Seelandjob.ch branchen\\u00fcbergreifend agiert.; Beide bieten Dienstleistungen zur Personalbeschaffung an.", "Matched Partner Description": null}', 'url__2': 'http://www.seelandjob.ch', 'phone_number__2': "'+41323128888", 'profile_id__2': 10, 'industry__2': 'staffing & recruiting', 'company_name__2': 'SEELAND JOB AG', 'is_b2b__2': None, 'customer_target_segments__3': None, 'additional_info__3': '{"Company": "Burning Box SA", "# Employees": 24.0, "Industry": "information technology & services", "Website": "http://www.burningbox.ch", "Company L ... (2573 characters truncated) ... formation und Prozessoptimierung.; Fokus auf die Entwicklung von Softwarel\\u00f6sungen f\\u00fcr Unternehmen.", "Matched Partner Description": null}', 'url__3': 'http://www.burningbox.ch', 'phone_number__3': "'+41265520330", 'profile_id__3': 10, 'industry__3': 'information technology & services', 'company_name__3': 'Burning Box SA', 'is_b2b__3': None, 'customer_target_segments__4': None, 'additional_info__4': '{"Company": "Forum Fribourg", "# Employees": 19.0, "Industry": "events services", "Website": "http://www.forum-fribourg.ch", "Company Linkedin Url":  ... (3617 characters truncated) ... king-Veranstaltungen an, was eine potenzielle Synergie mit den Dienstleistungen des Forums Fribourg darstellt.", "Matched Partner Description": null}', 'url__4': 'http://www.forum-fribourg.ch', 'phone_number__4': "'+41763293477", 'profile_id__4': 10, 'industry__4': 'events services', 'company_name__4': 'Forum Fribourg', 'is_b2b__4': None, 'customer_target_segments__5': None, 'additional_info__5': '{"Company": "FatzerImbach AG", "# Employees": 16.0, "Industry": "marketing & advertising", "Website": "http://www.fatzerimbach.ch", "Company Linkedin ... (2949 characters truncated) ... h Personalvermittlung im Gesundheitssektor; Fokus auf digitale L\\u00f6sungen f\\u00fcr den Healthcare-Bereich", "Matched Partner Description": null}', 'url__5': 'http://www.fatzerimbach.ch', 'phone_number__5': "'+41442271111", 'profile_id__5': 10, 'industry__5': 'marketing & advertising', 'company_name__5': 'FatzerImbach AG', 'is_b2b__5': None, 'customer_target_segments__6': None, 'additional_info__6': '{"Company": "PEZAG AG", "# Employees": 28.0, "Industry": "electrical/electronic manufacturing", "Website": "http://www.pezag.ch", "Company Linkedin U ... (4497 characters truncated) ... industriellen Installationen in Verbindung steht.; Bietet IT-L\\u00f6sungen f\\u00fcr Industrieunternehmen an.", "Matched Partner Description": null}' ... 7900 parameters truncated ... 'company_name__993': 'GK Consulting GmbH', 'is_b2b__993': None, 'customer_target_segments__994': None, 'additional_info__994': '{"Company": "WARDA Network", "# Employees": 21.0, "Industry": "marketing & advertising", "Website": "http://www.wardanetwork.at", "Company Linkedin U ... (2494 characters truncated) ... igitale L\\u00f6sungen und Automatisierung.; Zielgruppe: Unternehmen, die digitale Marketingstrategien suchen.", "Matched Partner Description": null}', 'url__994': 'http://www.wardanetwork.at', 'phone_number__994': "'+43193466240", 'profile_id__994': 10, 'industry__994': 'marketing & advertising', 'company_name__994': 'WARDA Network', 'is_b2b__994': None, 'customer_target_segments__995': None, 'additional_info__995': '{"Company": "equalizent Schulungs- und Beratungs GmbH", "# Employees": 27.0, "Industry": "professional training & coaching", "Website": "http://www.e ... (5139 characters truncated) ... titutionen, die Bildungsangebote nutzen.; Angebot von digitalen Lernplattformen und E-Learning-L\\u00f6sungen.", "Matched Partner Description": null}', 'url__995': 'http://www.equalizent.wien', 'phone_number__995': "'+4314098318", 'profile_id__995': 10, 'industry__995': 'professional training & coaching', 'company_name__995': 'equalizent Schulungs- und Beratungs GmbH', 'is_b2b__995': None, 'customer_target_segments__996': None, 'additional_info__996': '{"Company": "Pitkowitz & Partners", "# Employees": 18.0, "Industry": "law practice", "Website": "http://www.pitkowitz.com", "Company Linkedin Url": " ... (2994 characters truncated) ... erung f\\u00fcr Anwaltskanzleien durch digitale Workflows.; Automatisierung und Digitalisierung von Prozessen.", "Matched Partner Description": null}', 'url__996': 'http://www.pitkowitz.com', 'phone_number__996': "'+4314130136", 'profile_id__996': 10, 'industry__996': 'law practice', 'company_name__996': 'Pitkowitz & Partners', 'is_b2b__996': None, 'customer_target_segments__997': None, 'additional_info__997': '{"Company": "Stark Spannsysteme GmbH", "# Employees": 22.0, "Industry": "mining & metals", "Website": "http://www.stark-roemheld.com", "Company Linke ... (3211 characters truncated) ... s zu den Dienstleistungen von Stark-R\\u00f6mheld passt.; Fokus auf digitale Transformation und Industrie 4.0.", "Matched Partner Description": null}', 'url__997': 'http://www.stark-roemheld.com', 'phone_number__997': "'+435522374000", 'profile_id__997': 10, 'industry__997': 'mining & metals', 'company_name__997': 'Stark Spannsysteme GmbH', 'is_b2b__997': None, 'customer_target_segments__998': None, 'additional_info__998': '{"Company": "Ingenieurb\\u00fcro ste.p", "# Employees": 15.0, "Industry": "construction", "Website": "http://www.step-zt.at", "Company Linkedin Url": ... (2632 characters truncated) ... essung und Navigation im Bauingenieurwesen.; Zielgruppe: Bauunternehmen, insbesondere im Tiefbau/Untertagebau.", "Matched Partner Description": null}', 'url__998': 'http://www.step-zt.at', 'phone_number__998': "'+4315055687", 'profile_id__998': 10, 'industry__998': 'construction', 'company_name__998': 'Ingenieurbüro ste.p', 'is_b2b__998': None, 'customer_target_segments__999': None, 'additional_info__999': '{"Company": "Recognosco", "# Employees": 18.0, "Industry": "information technology & services", "Website": "http://www.recognosco.com", "Company Link ... (4427 characters truncated) ... es: KI-basierte Sprachdokumentation und Module.; Gemeinsame Zielgruppe: Pflegebereich und Pflegeeinrichtungen.", "Matched Partner Description": null}', 'url__999': 'http://www.recognosco.com', 'phone_number__999': "'+43120501550", 'profile_id__999': 10, 'industry__999': 'information technology & services', 'company_name__999': 'Recognosco', 'is_b2b__999': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-07 14:12:29,054 - ERROR - root - Failed to load data for SOR_7K_20250627_163929_regenerated_final.csv. Halting processing for this file. Error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "unique_phone_number"
DETAIL:  Key (phone_number)=('+41562040888) already exists.

[SQL: INSERT INTO contacts (company_name, url, phone_number, industry, is_b2b, customer_target_segments, additional_info, profile_id) VALUES (%(company_name__0)s, %(url__0)s, %(phone_number__0)s, %(industry__0)s, %(is_b2b__0)s, %(customer_target_segments__ ... 178903 characters truncated ... , %(is_b2b__999)s, %(customer_target_segments__999)s, %(additional_info__999)s, %(profile_id__999)s)]
[parameters: {'customer_target_segments__0': None, 'additional_info__0': '{"Company": "Trafo Baden \\u2502 Congress. Hotels. Catering.", "# Employees": 27.0, "Industry": "events services", "Website": "http://www.trafobaden. ... (3828 characters truncated) ... .; Angebote f\\u00fcr Datennetzwerke und Telekommunikation, die f\\u00fcr moderne Eventlocations wichtig sind.", "Matched Partner Description": null}', 'url__0': 'http://www.trafobaden.ch', 'phone_number__0': "'+41562040888", 'profile_id__0': 10, 'industry__0': 'events services', 'company_name__0': 'Trafo Baden │ Congress. Hotels. Catering.', 'is_b2b__0': None, 'customer_target_segments__1': None, 'additional_info__1': '{"Company": "treuhand marugg + imsand", "# Employees": 29.0, "Industry": "accounting", "Website": "http://www.trmi.ch", "Company Linkedin Url": "http ... (2985 characters truncated) ... rberater, Wirtschaftspr\\u00fcfer), was eine potenzielle Synergie mit den Dienstleistungen von TRMI darstellt.", "Matched Partner Description": null}', 'url__1': 'http://www.trmi.ch', 'phone_number__1': "'+41279222949", 'profile_id__1': 10, 'industry__1': 'accounting', 'company_name__1': 'treuhand marugg + imsand', 'is_b2b__1': None, 'customer_target_segments__2': None, 'additional_info__2': '{"Company": "SEELAND JOB AG", "# Employees": 23.0, "Industry": "staffing & recruiting", "Website": "http://www.seelandjob.ch", "Company Linkedin Url" ... (3040 characters truncated) ... nd Seelandjob.ch branchen\\u00fcbergreifend agiert.; Beide bieten Dienstleistungen zur Personalbeschaffung an.", "Matched Partner Description": null}', 'url__2': 'http://www.seelandjob.ch', 'phone_number__2': "'+41323128888", 'profile_id__2': 10, 'industry__2': 'staffing & recruiting', 'company_name__2': 'SEELAND JOB AG', 'is_b2b__2': None, 'customer_target_segments__3': None, 'additional_info__3': '{"Company": "Burning Box SA", "# Employees": 24.0, "Industry": "information technology & services", "Website": "http://www.burningbox.ch", "Company L ... (2573 characters truncated) ... formation und Prozessoptimierung.; Fokus auf die Entwicklung von Softwarel\\u00f6sungen f\\u00fcr Unternehmen.", "Matched Partner Description": null}', 'url__3': 'http://www.burningbox.ch', 'phone_number__3': "'+41265520330", 'profile_id__3': 10, 'industry__3': 'information technology & services', 'company_name__3': 'Burning Box SA', 'is_b2b__3': None, 'customer_target_segments__4': None, 'additional_info__4': '{"Company": "Forum Fribourg", "# Employees": 19.0, "Industry": "events services", "Website": "http://www.forum-fribourg.ch", "Company Linkedin Url":  ... (3617 characters truncated) ... king-Veranstaltungen an, was eine potenzielle Synergie mit den Dienstleistungen des Forums Fribourg darstellt.", "Matched Partner Description": null}', 'url__4': 'http://www.forum-fribourg.ch', 'phone_number__4': "'+41763293477", 'profile_id__4': 10, 'industry__4': 'events services', 'company_name__4': 'Forum Fribourg', 'is_b2b__4': None, 'customer_target_segments__5': None, 'additional_info__5': '{"Company": "FatzerImbach AG", "# Employees": 16.0, "Industry": "marketing & advertising", "Website": "http://www.fatzerimbach.ch", "Company Linkedin ... (2949 characters truncated) ... h Personalvermittlung im Gesundheitssektor; Fokus auf digitale L\\u00f6sungen f\\u00fcr den Healthcare-Bereich", "Matched Partner Description": null}', 'url__5': 'http://www.fatzerimbach.ch', 'phone_number__5': "'+41442271111", 'profile_id__5': 10, 'industry__5': 'marketing & advertising', 'company_name__5': 'FatzerImbach AG', 'is_b2b__5': None, 'customer_target_segments__6': None, 'additional_info__6': '{"Company": "PEZAG AG", "# Employees": 28.0, "Industry": "electrical/electronic manufacturing", "Website": "http://www.pezag.ch", "Company Linkedin U ... (4497 characters truncated) ... industriellen Installationen in Verbindung steht.; Bietet IT-L\\u00f6sungen f\\u00fcr Industrieunternehmen an.", "Matched Partner Description": null}' ... 7900 parameters truncated ... 'company_name__993': 'GK Consulting GmbH', 'is_b2b__993': None, 'customer_target_segments__994': None, 'additional_info__994': '{"Company": "WARDA Network", "# Employees": 21.0, "Industry": "marketing & advertising", "Website": "http://www.wardanetwork.at", "Company Linkedin U ... (2494 characters truncated) ... igitale L\\u00f6sungen und Automatisierung.; Zielgruppe: Unternehmen, die digitale Marketingstrategien suchen.", "Matched Partner Description": null}', 'url__994': 'http://www.wardanetwork.at', 'phone_number__994': "'+43193466240", 'profile_id__994': 10, 'industry__994': 'marketing & advertising', 'company_name__994': 'WARDA Network', 'is_b2b__994': None, 'customer_target_segments__995': None, 'additional_info__995': '{"Company": "equalizent Schulungs- und Beratungs GmbH", "# Employees": 27.0, "Industry": "professional training & coaching", "Website": "http://www.e ... (5139 characters truncated) ... titutionen, die Bildungsangebote nutzen.; Angebot von digitalen Lernplattformen und E-Learning-L\\u00f6sungen.", "Matched Partner Description": null}', 'url__995': 'http://www.equalizent.wien', 'phone_number__995': "'+4314098318", 'profile_id__995': 10, 'industry__995': 'professional training & coaching', 'company_name__995': 'equalizent Schulungs- und Beratungs GmbH', 'is_b2b__995': None, 'customer_target_segments__996': None, 'additional_info__996': '{"Company": "Pitkowitz & Partners", "# Employees": 18.0, "Industry": "law practice", "Website": "http://www.pitkowitz.com", "Company Linkedin Url": " ... (2994 characters truncated) ... erung f\\u00fcr Anwaltskanzleien durch digitale Workflows.; Automatisierung und Digitalisierung von Prozessen.", "Matched Partner Description": null}', 'url__996': 'http://www.pitkowitz.com', 'phone_number__996': "'+4314130136", 'profile_id__996': 10, 'industry__996': 'law practice', 'company_name__996': 'Pitkowitz & Partners', 'is_b2b__996': None, 'customer_target_segments__997': None, 'additional_info__997': '{"Company": "Stark Spannsysteme GmbH", "# Employees": 22.0, "Industry": "mining & metals", "Website": "http://www.stark-roemheld.com", "Company Linke ... (3211 characters truncated) ... s zu den Dienstleistungen von Stark-R\\u00f6mheld passt.; Fokus auf digitale Transformation und Industrie 4.0.", "Matched Partner Description": null}', 'url__997': 'http://www.stark-roemheld.com', 'phone_number__997': "'+435522374000", 'profile_id__997': 10, 'industry__997': 'mining & metals', 'company_name__997': 'Stark Spannsysteme GmbH', 'is_b2b__997': None, 'customer_target_segments__998': None, 'additional_info__998': '{"Company": "Ingenieurb\\u00fcro ste.p", "# Employees": 15.0, "Industry": "construction", "Website": "http://www.step-zt.at", "Company Linkedin Url": ... (2632 characters truncated) ... essung und Navigation im Bauingenieurwesen.; Zielgruppe: Bauunternehmen, insbesondere im Tiefbau/Untertagebau.", "Matched Partner Description": null}', 'url__998': 'http://www.step-zt.at', 'phone_number__998': "'+4315055687", 'profile_id__998': 10, 'industry__998': 'construction', 'company_name__998': 'Ingenieurbüro ste.p', 'is_b2b__998': None, 'customer_target_segments__999': None, 'additional_info__999': '{"Company": "Recognosco", "# Employees": 18.0, "Industry": "information technology & services", "Website": "http://www.recognosco.com", "Company Link ... (4427 characters truncated) ... es: KI-basierte Sprachdokumentation und Module.; Gemeinsame Zielgruppe: Pflegebereich und Pflegeeinrichtungen.", "Matched Partner Description": null}', 'url__999': 'http://www.recognosco.com', 'phone_number__999': "'+43120501550", 'profile_id__999': 10, 'industry__999': 'information technology & services', 'company_name__999': 'Recognosco', 'is_b2b__999': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-07 14:12:29,056 - INFO - root - ETL pipeline finished.
2025-07-07 14:13:50,202 - INFO - root - Logging configured successfully.
2025-07-07 14:13:50,203 - INFO - root - Fetching the last 1 contacts...
2025-07-07 14:13:50,286 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:14:13,609 - INFO - root - Logging configured successfully.
2025-07-07 14:14:13,610 - INFO - root - Generating audit report for contact ID: 42082
2025-07-07 14:14:13,665 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:15:27,010 - INFO - root - Logging configured successfully.
2025-07-07 14:15:27,011 - INFO - root - ETL pipeline started.
2025-07-07 14:15:27,028 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:15:30,295 - INFO - root - Loaded 5809 existing contacts for deduplication.
2025-07-07 14:15:30,296 - INFO - etl.scripts.extract - Found 1 CSV files in etl/input_data.
2025-07-07 14:15:30,296 - INFO - root - --- Processing file: SOR_7K_20250627_163929_regenerated_final.csv ---
2025-07-07 14:15:30,297 - INFO - etl.scripts.extract - Extracting data from SOR_7K_20250627_163929_regenerated_final.csv...
2025-07-07 14:15:30,703 - INFO - etl.scripts.extract - Successfully extracted 7383 rows from SOR_7K_20250627_163929_regenerated_final.csv.
2025-07-07 14:15:30,704 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 14:15:30,725 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'Apollo'
2025-07-07 14:15:31,281 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 14:15:31,283 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 14:15:31,295 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 14:15:31,477 - INFO - etl.scripts.transform - Saved 1574 duplicate rows to etl/dropped_duplicates\duplicates_20250707_141531.csv
2025-07-07 14:15:31,479 - INFO - etl.scripts.transform - Removed 1574 duplicate phone numbers from the source file.
2025-07-07 14:15:31,479 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 14:15:31,480 - INFO - root - Starting deduplication...
2025-07-07 14:15:31,483 - INFO - root - Removed 5808 rows with existing phone numbers.
2025-07-07 14:15:31,484 - WARNING - root - Potential duplicate found for 'Personal Search AG'. Similarity: 100.0%. Matched with: 'personal search ag'. Skipping row and adding to review file.
2025-07-07 14:15:31,487 - INFO - root - Saved 1 potential duplicates to etl/review\review_SOR_7K_20250627_163929_regenerated_final.csv
2025-07-07 14:15:31,487 - INFO - root - Deduplication complete. 0 rows remaining for insertion.
2025-07-07 14:15:31,487 - INFO - etl.scripts.load - DataFrame is empty. Nothing to load to the database.
2025-07-07 14:15:31,488 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SOR_7K_20250627_163929_regenerated_final.csv
2025-07-07 14:15:31,488 - INFO - root - ETL pipeline finished.
2025-07-07 14:15:57,361 - INFO - root - Logging configured successfully.
2025-07-07 14:16:25,849 - INFO - root - Logging configured successfully.
2025-07-07 14:16:25,851 - WARNING - root - --- Starting Database Reset ---
2025-07-07 14:16:25,869 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:16:27,194 - INFO - root - Deleting all records from 'contacts' table...
2025-07-07 14:16:27,457 - INFO - root - ...done.
2025-07-07 14:16:27,457 - INFO - root - Deleting all records from 'contact_profiles' table...
2025-07-07 14:16:27,562 - INFO - root - ...done.
2025-07-07 14:16:27,650 - INFO - root - --- Database Reset Successfully ---
2025-07-07 14:16:36,822 - INFO - root - Logging configured successfully.
2025-07-07 14:16:36,823 - INFO - root - ETL pipeline started.
2025-07-07 14:16:36,841 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:16:40,149 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 14:16:40,151 - INFO - etl.scripts.extract - Found 0 CSV files in etl/input_data.
2025-07-07 14:16:40,151 - INFO - root - ETL pipeline finished.
2025-07-07 14:17:03,417 - INFO - root - Logging configured successfully.
2025-07-07 14:17:03,417 - INFO - root - ETL pipeline started.
2025-07-07 14:17:03,445 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:17:05,330 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 14:17:05,332 - INFO - etl.scripts.extract - Found 1 CSV files in etl/input_data.
2025-07-07 14:17:05,332 - INFO - root - --- Processing file: SOR_7K_20250627_163929_regenerated_final.csv ---
2025-07-07 14:17:05,333 - INFO - etl.scripts.extract - Extracting data from SOR_7K_20250627_163929_regenerated_final.csv...
2025-07-07 14:17:05,735 - INFO - etl.scripts.extract - Successfully extracted 7383 rows from SOR_7K_20250627_163929_regenerated_final.csv.
2025-07-07 14:17:05,736 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 14:17:05,759 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'Apollo'
2025-07-07 14:17:06,397 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 14:17:06,399 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 14:17:06,421 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 14:17:06,680 - INFO - etl.scripts.transform - Saved 1574 duplicate rows to etl/dropped_duplicates\duplicates_20250707_141706.csv
2025-07-07 14:17:06,683 - INFO - etl.scripts.transform - Removed 1574 duplicate phone numbers from the source file.
2025-07-07 14:17:06,683 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 14:17:06,684 - INFO - root - Starting deduplication...
2025-07-07 14:17:06,686 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 14:17:07,065 - INFO - root - Deduplication complete. 5809 rows remaining for insertion.
2025-07-07 14:17:07,371 - INFO - etl.scripts.load - Created new profile_id: 11 for hash: ebb2ce72311169a7ea0a409c9c2c5a21
2025-07-07 14:17:07,373 - INFO - etl.scripts.load - Loading 5809 rows with profile_id 11 into 'contacts' table...
2025-07-07 14:17:15,043 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 14:17:15,044 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SOR_7K_20250627_163929_regenerated_final.csv
2025-07-07 14:17:15,044 - INFO - root - ETL pipeline finished.
2025-07-07 14:17:36,922 - INFO - root - Logging configured successfully.
2025-07-07 14:17:36,923 - INFO - root - Generating audit report for contact ID: 1
2025-07-07 14:17:36,939 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:17:47,211 - INFO - root - Logging configured successfully.
2025-07-07 14:17:47,212 - INFO - root - Fetching the last 1 contacts...
2025-07-07 14:17:47,228 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:17:57,091 - INFO - root - Logging configured successfully.
2025-07-07 14:17:57,093 - INFO - root - Generating audit report for contact ID: 47299
2025-07-07 14:17:57,112 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:20:12,448 - INFO - root - Logging configured successfully.
2025-07-07 14:20:14,818 - WARNING - root - --- Starting Database Reset ---
2025-07-07 14:20:14,838 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:20:16,103 - INFO - root - Deleting all records from 'contacts' table...
2025-07-07 14:20:16,306 - INFO - root - ...done.
2025-07-07 14:20:16,307 - INFO - root - Deleting all records from 'contact_profiles' table...
2025-07-07 14:20:16,397 - INFO - root - ...done.
2025-07-07 14:20:16,572 - INFO - root - --- Database Reset Successfully ---
2025-07-07 14:20:45,573 - INFO - root - Logging configured successfully.
2025-07-07 14:20:45,573 - INFO - root - ETL pipeline started.
2025-07-07 14:20:45,595 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:20:47,171 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 14:20:47,173 - INFO - etl.scripts.extract - Found 1 CSV files in etl/input_data.
2025-07-07 14:20:47,176 - INFO - root - --- Processing file: SOR_7K_20250627_163929_regenerated_final.csv ---
2025-07-07 14:20:47,177 - INFO - etl.scripts.extract - Extracting data from SOR_7K_20250627_163929_regenerated_final.csv...
2025-07-07 14:20:47,755 - INFO - etl.scripts.extract - Successfully extracted 7383 rows from SOR_7K_20250627_163929_regenerated_final.csv.
2025-07-07 14:20:47,756 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 14:20:47,794 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'Apollo'
2025-07-07 14:20:48,423 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 14:20:48,427 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 14:20:48,444 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 14:20:48,598 - INFO - etl.scripts.transform - Saved 1574 duplicate rows to etl/dropped_duplicates\duplicates_20250707_142048.csv
2025-07-07 14:20:48,601 - INFO - etl.scripts.transform - Removed 1574 duplicate phone numbers from the source file.
2025-07-07 14:20:48,601 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 14:20:48,601 - INFO - root - Starting deduplication...
2025-07-07 14:20:48,604 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 14:20:48,963 - INFO - root - Deduplication complete. 5809 rows remaining for insertion.
2025-07-07 14:20:49,395 - INFO - etl.scripts.load - Created new profile_id: 12 for hash: ebb2ce72311169a7ea0a409c9c2c5a21
2025-07-07 14:20:49,396 - INFO - etl.scripts.load - Loading 5809 rows with profile_id 12 into 'contacts' table...
2025-07-07 14:20:56,835 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 14:20:56,837 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SOR_7K_20250627_163929_regenerated_final.csv
2025-07-07 14:20:56,838 - INFO - root - ETL pipeline finished.
2025-07-07 14:21:06,106 - INFO - root - Logging configured successfully.
2025-07-07 14:21:06,108 - INFO - root - Fetching the last 1 contacts...
2025-07-07 14:21:06,127 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:21:26,425 - INFO - root - Logging configured successfully.
2025-07-07 14:21:26,427 - INFO - root - Generating audit report for contact ID: 53108
2025-07-07 14:21:26,445 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:29:38,175 - INFO - root - Logging configured successfully.
2025-07-07 14:29:53,456 - WARNING - root - --- Starting Database Reset ---
2025-07-07 14:29:53,486 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:29:54,771 - INFO - root - Deleting all records from 'contacts' table...
2025-07-07 14:29:55,002 - INFO - root - ...done.
2025-07-07 14:29:55,002 - INFO - root - Deleting all records from 'contact_profiles' table...
2025-07-07 14:29:55,114 - INFO - root - ...done.
2025-07-07 14:29:55,279 - INFO - root - --- Database Reset Successfully ---
2025-07-07 14:30:28,173 - INFO - root - Logging configured successfully.
2025-07-07 14:30:28,173 - INFO - root - ETL pipeline started.
2025-07-07 14:30:28,191 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:30:30,034 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 14:30:30,035 - INFO - etl.scripts.extract - Found 1 CSV files in etl/input_data.
2025-07-07 14:30:30,035 - INFO - root - --- Processing file: SOR_7K_20250627_163929_regenerated_final.csv ---
2025-07-07 14:30:30,035 - INFO - etl.scripts.extract - Extracting data from SOR_7K_20250627_163929_regenerated_final.csv...
2025-07-07 14:30:30,487 - INFO - etl.scripts.extract - Successfully extracted 7383 rows from SOR_7K_20250627_163929_regenerated_final.csv.
2025-07-07 14:30:30,487 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 14:30:30,510 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'Apollo'
2025-07-07 14:30:31,053 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 14:30:31,056 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 14:30:31,072 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 14:30:31,394 - INFO - etl.scripts.transform - Saved 1574 duplicate rows to etl/dropped_duplicates\duplicates_20250707_143031.csv
2025-07-07 14:30:31,397 - INFO - etl.scripts.transform - Removed 1574 duplicate phone numbers from the source file.
2025-07-07 14:30:31,398 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 14:30:31,398 - INFO - root - Starting deduplication...
2025-07-07 14:30:31,404 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 14:30:31,975 - INFO - root - Deduplication complete. 5809 rows remaining for insertion.
2025-07-07 14:30:32,308 - INFO - etl.scripts.load - Created new profile_id: 13 for hash: ebb2ce72311169a7ea0a409c9c2c5a21
2025-07-07 14:30:32,311 - INFO - etl.scripts.load - Loading 5809 rows with profile_id 13 into 'contacts' table...
2025-07-07 14:30:40,550 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 14:30:40,551 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SOR_7K_20250627_163929_regenerated_final.csv
2025-07-07 14:30:40,551 - INFO - root - ETL pipeline finished.
2025-07-07 14:31:22,196 - INFO - root - Logging configured successfully.
2025-07-07 14:31:22,198 - INFO - root - Fetching the last 1 contacts...
2025-07-07 14:31:22,217 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:31:56,981 - INFO - root - Logging configured successfully.
2025-07-07 14:31:56,982 - INFO - root - Generating audit report for contact ID: 58917
2025-07-07 14:31:56,999 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:35:20,111 - INFO - root - Logging configured successfully.
2025-07-07 14:35:23,779 - WARNING - root - --- Starting Database Reset ---
2025-07-07 14:35:23,797 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:35:25,028 - INFO - root - Deleting all records from 'contacts' table...
2025-07-07 14:35:25,234 - INFO - root - ...done.
2025-07-07 14:35:25,234 - INFO - root - Deleting all records from 'contact_profiles' table...
2025-07-07 14:35:25,334 - INFO - root - ...done.
2025-07-07 14:35:25,431 - INFO - root - --- Database Reset Successfully ---
2025-07-07 14:35:46,694 - INFO - root - Logging configured successfully.
2025-07-07 14:35:46,694 - INFO - root - ETL pipeline started.
2025-07-07 14:35:46,710 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:35:48,524 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 14:35:48,526 - INFO - etl.scripts.extract - Found 1 CSV files in etl/input_data.
2025-07-07 14:35:48,526 - INFO - root - --- Processing file: SOR_7K_20250627_163929_regenerated_final.csv ---
2025-07-07 14:35:48,527 - INFO - etl.scripts.extract - Extracting data from SOR_7K_20250627_163929_regenerated_final.csv...
2025-07-07 14:35:48,921 - INFO - etl.scripts.extract - Successfully extracted 7383 rows from SOR_7K_20250627_163929_regenerated_final.csv.
2025-07-07 14:35:48,922 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 14:35:48,950 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'Apollo'
2025-07-07 14:35:49,388 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 14:35:49,391 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 14:35:49,405 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 14:35:49,523 - INFO - etl.scripts.transform - Saved 1574 duplicate rows to etl/dropped_duplicates\duplicates_20250707_143549.csv
2025-07-07 14:35:49,525 - INFO - etl.scripts.transform - Removed 1574 duplicate phone numbers from the source file.
2025-07-07 14:35:49,526 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 14:35:49,526 - INFO - root - Starting deduplication...
2025-07-07 14:35:49,528 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 14:35:49,857 - INFO - root - Deduplication complete. 5809 rows remaining for insertion.
2025-07-07 14:35:50,156 - INFO - etl.scripts.load - Created new profile_id: 14 for hash: ebb2ce72311169a7ea0a409c9c2c5a21
2025-07-07 14:35:50,157 - INFO - etl.scripts.load - Loading 5809 rows with profile_id 14 into 'contacts' table...
2025-07-07 14:36:03,211 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 14:36:03,212 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SOR_7K_20250627_163929_regenerated_final.csv
2025-07-07 14:36:03,213 - INFO - root - ETL pipeline finished.
2025-07-07 14:36:33,351 - INFO - root - Logging configured successfully.
2025-07-07 14:36:33,353 - INFO - root - Fetching the last 1 contacts...
2025-07-07 14:36:33,367 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:37:14,211 - INFO - root - Logging configured successfully.
2025-07-07 14:37:14,212 - INFO - root - Generating audit report for contact ID: 64726
2025-07-07 14:37:14,236 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:45:18,149 - INFO - root - Logging configured successfully.
2025-07-07 14:45:18,149 - INFO - root - ETL pipeline started.
2025-07-07 14:45:18,171 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:45:20,574 - INFO - root - Loaded 5809 existing contacts for deduplication.
2025-07-07 14:45:20,575 - INFO - etl.scripts.extract - Found 7 CSV files in etl/input_data.
2025-07-07 14:45:20,576 - INFO - root - --- Processing file: SalesOutreachReport_20250705_080954_4000-8000.csv ---
2025-07-07 14:45:20,576 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_080954_4000-8000.csv...
2025-07-07 14:45:20,783 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_080954_4000-8000.csv.
2025-07-07 14:45:20,784 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 14:45:20,796 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 14:45:21,087 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 14:45:21,090 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 14:45:21,097 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 14:45:21,173 - INFO - etl.scripts.transform - Saved 1077 duplicate rows to etl/dropped_duplicates\duplicates_20250707_144521.csv
2025-07-07 14:45:21,175 - INFO - etl.scripts.transform - Removed 1077 duplicate phone numbers from the source file.
2025-07-07 14:45:21,176 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 14:45:21,176 - INFO - root - Starting deduplication...
2025-07-07 14:45:21,180 - INFO - root - Removed 1686 rows with existing phone numbers.
2025-07-07 14:45:28,392 - WARNING - root - Potential duplicate found for 'ITM gruppe'. Similarity: 90.0%. Matched with: 'ims gruppe'. Skipping row and adding to review file.
2025-07-07 14:45:28,993 - WARNING - root - Potential duplicate found for 'Agrosolution GmbH'. Similarity: 90.32258064516128%. Matched with: 'agolution gmbh'. Skipping row and adding to review file.
2025-07-07 14:45:39,541 - WARNING - root - Potential duplicate found for 'AYVERDIS AG'. Similarity: 90.0%. Matched with: 'averdi ag'. Skipping row and adding to review file.
2025-07-07 14:46:15,401 - WARNING - root - Potential duplicate found for 'HANGCHA EUROPE GMBH'. Similarity: 91.89189189189189%. Matched with: 'hanwha europe gmbh'. Skipping row and adding to review file.
2025-07-07 14:46:15,810 - WARNING - root - Potential duplicate found for 'LacTec GmbH'. Similarity: 90.9090909090909%. Matched with: 'lctech gmbh'. Skipping row and adding to review file.
2025-07-07 14:46:24,656 - WARNING - root - Potential duplicate found for 'aiti GmbH'. Similarity: 90.0%. Matched with: 'aitiva gmbh'. Skipping row and adding to review file.
2025-07-07 14:46:37,765 - WARNING - root - Potential duplicate found for 'SITEMA GmbH & Co. KG'. Similarity: 92.3076923076923%. Matched with: 'steda gmbh & co. kg'. Skipping row and adding to review file.
2025-07-07 14:47:10,847 - INFO - root - Saved 7 potential duplicates to etl/review\review_SalesOutreachReport_20250705_080954_4000-8000.csv
2025-07-07 14:47:10,847 - INFO - root - Deduplication complete. 1231 rows remaining for insertion.
2025-07-07 14:47:11,133 - INFO - etl.scripts.load - Created new profile_id: 15 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 14:47:11,134 - INFO - etl.scripts.load - Loading 1231 rows with profile_id 15 into 'contacts' table...
2025-07-07 14:47:12,086 - ERROR - etl.scripts.load - Failed to load data into 'contacts': (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type boolean: "Unknown"
LINE 1: ...ycles.eu', '''+494912345', 'Retail Sector (B2B)', 'Unknown',...
                                                             ^

[SQL: INSERT INTO contacts (company_name, url, phone_number, industry, is_b2b, customer_target_segments, additional_info, profile_id) VALUES (%(company_name__0)s, %(url__0)s, %(phone_number__0)s, %(industry__0)s, %(is_b2b__0)s, %(customer_target_segments__ ... 185903 characters truncated ... b2b__999)s, %(customer_target_segments__999)s, %(additional_info__999)s::JSONB, %(profile_id__999)s)]
[parameters: {'profile_id__0': 15, 'phone_number__0': "'+498912414710", 'customer_target_segments__0': 'Municipalities in Bavaria', 'company_name__0': 'BayernGrund', 'industry__0': 'Urban Planning and Land Development', 'url__0': 'http://www.bayerngrund.de', 'additional_info__0': '"{\\"Company Name\\": \\"BayernGrund\\", \\"Original_Number\\": \\"\'+49 89 12414710\\", \\"URL\\": \\"http://www.bayerngrund.de\\", \\"is_b2b\\": \\ ... (1574 characters truncated) ... he business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 2.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__0': 'Yes', 'profile_id__1': 15, 'phone_number__1': "'+4988217530", 'customer_target_segments__1': 'Local community of Garmisch-Partenkirchen', 'company_name__1': 'Gemeindewerke Garmisch-Partenkirchen', 'industry__1': 'Municipal Utility', 'url__1': 'http://www.gw-gap.de', 'additional_info__1': '"{\\"Company Name\\": \\"Gemeindewerke Garmisch-Partenkirchen\\", \\"Original_Number\\": \\"\'+49 882 17530\\", \\"URL\\": \\"http://www.gw-gap.de\\" ... (1875 characters truncated) ... "The business model and target group are clearly communicated in the summary.\\", \\"Original Row Number\\": 3.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__1': 'Yes', 'profile_id__2': 15, 'phone_number__2': None, 'customer_target_segments__2': 'Members; Residents in Berlin', 'company_name__2': 'Bbg BERLINER BAUGENOSSENSCHAFT EG', 'industry__2': 'Housing Cooperative', 'url__2': 'http://www.bbg-eg.de', 'additional_info__2': '"{\\"Company Name\\": \\"Bbg BERLINER BAUGENOSSENSCHAFT EG\\", \\"Original_Number\\": null, \\"URL\\": \\"http://www.bbg-eg.de\\", \\"is_b2b\\": \\"Y ... (1836 characters truncated) ... he business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 4.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__2': 'Yes', 'profile_id__3': 15, 'phone_number__3': "'+4933120169258", 'customer_target_segments__3': 'IT Professionals; Network Administrators; IT Operations Leaders; Individuals seeking to improve skills in the technology sector', 'company_name__3': 'Negotiation Academy Potsdam', 'industry__3': 'IT Services', 'url__3': 'http://www.negotiation-academy-potsdam.de', 'additional_info__3': '"{\\"Company Name\\": \\"Negotiation Academy Potsdam\\", \\"Original_Number\\": \\"\'+49 33 120169258\\", \\"URL\\": \\"http://www.negotiation-academ ... (4783 characters truncated) ... he business model and target audience are reasonably clear from the summary.\\", \\"Original Row Number\\": 12.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__3': 'Yes', 'profile_id__4': 15, 'phone_number__4': "'+4939179298663", 'customer_target_segments__4': 'Handball fans; Sports enthusiasts', 'company_name__4': 'SC Magdeburg - Handball Magdeburg GmbH', 'industry__4': 'Sports (Handball)', 'url__4': 'http://www.scm-handball.de', 'additional_info__4': '"{\\"Company Name\\": \\"SC Magdeburg - Handball Magdeburg GmbH\\", \\"Original_Number\\": \\"\'+49 391 79298663\\", \\"URL\\": \\"http://www.scm-han ... (1622 characters truncated) ... otes\\": \\"The business model and target audience are clearly communicated.\\", \\"Original Row Number\\": 16.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__4': 'Yes', 'profile_id__5': 15, 'phone_number__5': '494518899700.0', 'customer_target_segments__5': 'Visitors; Tourists', 'company_name__5': 'Lübeck und Travemünde Marketing GmbH', 'industry__5': 'Tourism', 'url__5': 'http://www.visit-luebeck.com', 'additional_info__5': '"{\\"Company Name\\": \\"L\\\\u00fcbeck und Travem\\\\u00fcnde Marketing GmbH\\", \\"Original_Number\\": null, \\"URL\\": \\"http://www.visit-luebeck ... (1514 characters truncated) ...  business model and target audience are clearly communicated in the summary.\\", \\"Original Row Number\\": 19.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__5': 'Yes', 'profile_id__6': 15, 'phone_number__6': "'+4993130930" ... 7900 parameters truncated ... 'additional_info__993': '"{\\"Company Name\\": \\"Ben Fleet Services\\", \\"Original_Number\\": \\"\'+49 30 20003585\\", \\"URL\\": \\"http://www.benfleetservices.com\\", \\" ... (1344 characters truncated) ... business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 3278.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__993': 'Yes', 'profile_id__994': 15, 'phone_number__994': "'+496704962490", 'customer_target_segments__994': None, 'company_name__994': 'Embeka Technologies GmbH', 'industry__994': 'Metalworking', 'url__994': 'http://www.embeka.de', 'additional_info__994': '"{\\"Company Name\\": \\"Embeka Technologies GmbH\\", \\"Original_Number\\": \\"\'+49 6704 962490\\", \\"URL\\": \\"http://www.embeka.de\\", \\"is_b2 ... (1871 characters truncated) ... licitly stated but implied to be businesses needing metalworking services.\\", \\"Original Row Number\\": 3282.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__994': 'Yes', 'profile_id__995': 15, 'phone_number__995': "'+49224112000", 'customer_target_segments__995': 'Private customers; Commercial customers; Fleet customers', 'company_name__995': 'Autohaus HOFF', 'industry__995': 'Car Dealership', 'url__995': 'http://www.autohaus-hoff.de', 'additional_info__995': '"{\\"Company Name\\": \\"Autohaus HOFF\\", \\"Original_Number\\": \\"\'+49 224 112000\\", \\"URL\\": \\"http://www.autohaus-hoff.de\\", \\"is_b2b\\": ... (1909 characters truncated) ... ly articulated. The target audience is broad (private, commercial, fleet).\\", \\"Original Row Number\\": 3285.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__995': 'Yes', 'profile_id__996': 15, 'phone_number__996': "'+4936165790", 'customer_target_segments__996': 'Private clients; Corporate clients', 'company_name__996': 'Volksbank Thüringen Mitte eG', 'industry__996': 'Banking', 'url__996': 'http://www.volksbank-thueringen-mitte.de', 'additional_info__996': '"{\\"Company Name\\": \\"Volksbank Th\\\\u00fcringen Mitte eG\\", \\"Original_Number\\": \\"\'+49 361 65790\\", \\"URL\\": \\"http://www.volksbank-th ... (4647 characters truncated) ... business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 3290.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__996': 'Yes', 'profile_id__997': 15, 'phone_number__997': '496921243400.0', 'customer_target_segments__997': None, 'company_name__997': 'In-der-City-Bus GmbH', 'industry__997': 'Public Transportation', 'url__997': 'http://www.icb-ffm.de', 'additional_info__997': '"{\\"Company Name\\": \\"In-der-City-Bus GmbH\\", \\"Original_Number\\": null, \\"URL\\": \\"http://www.icb-ffm.de\\", \\"is_b2b\\": \\"Yes\\", \\"is ... (1508 characters truncated) ... business model is clear, but the target audience is not explicitly stated.\\", \\"Original Row Number\\": 3293.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__997': 'Yes', 'profile_id__998': 15, 'phone_number__998': "'+49971785703103", 'customer_target_segments__998': None, 'company_name__998': 'Bäckerei Peter Schmitt GmbH', 'industry__998': 'Bakery', 'url__998': 'http://www.baecker-schmitt.de', 'additional_info__998': '"{\\"Company Name\\": \\"B\\\\u00e4ckerei Peter Schmitt GmbH\\", \\"Original_Number\\": \\"\'+49 971 785703103\\", \\"URL\\": \\"http://www.baecker-s ... (1410 characters truncated) ... \"The business model is clear. The target group is broad, local customers.\\", \\"Original Row Number\\": 3296.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__998': 'Yes', 'profile_id__999': 15, 'phone_number__999': '4921325102170.0', 'customer_target_segments__999': 'Mid-sized businesses; Industries', 'company_name__999': 'SCHLAGHECK + RADTKE executive consultants', 'industry__999': 'Executive Search and Consulting', 'url__999': 'http://www.schlagheck-radtke.de', 'additional_info__999': '"{\\"Company Name\\": \\"SCHLAGHECK + RADTKE executive consultants\\", \\"Original_Number\\": null, \\"URL\\": \\"http://www.schlagheck-radtke.de\\", ... (4362 characters truncated) ... The business model and target group are reasonably clear from the summary.\\", \\"Original Row Number\\": 3297.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__999': 'Yes'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-07-07 14:47:12,089 - ERROR - root - Failed to load data for SalesOutreachReport_20250705_080954_4000-8000.csv. Halting processing for this file. Error: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type boolean: "Unknown"
LINE 1: ...ycles.eu', '''+494912345', 'Retail Sector (B2B)', 'Unknown',...
                                                             ^

[SQL: INSERT INTO contacts (company_name, url, phone_number, industry, is_b2b, customer_target_segments, additional_info, profile_id) VALUES (%(company_name__0)s, %(url__0)s, %(phone_number__0)s, %(industry__0)s, %(is_b2b__0)s, %(customer_target_segments__ ... 185903 characters truncated ... b2b__999)s, %(customer_target_segments__999)s, %(additional_info__999)s::JSONB, %(profile_id__999)s)]
[parameters: {'profile_id__0': 15, 'phone_number__0': "'+498912414710", 'customer_target_segments__0': 'Municipalities in Bavaria', 'company_name__0': 'BayernGrund', 'industry__0': 'Urban Planning and Land Development', 'url__0': 'http://www.bayerngrund.de', 'additional_info__0': '"{\\"Company Name\\": \\"BayernGrund\\", \\"Original_Number\\": \\"\'+49 89 12414710\\", \\"URL\\": \\"http://www.bayerngrund.de\\", \\"is_b2b\\": \\ ... (1574 characters truncated) ... he business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 2.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__0': 'Yes', 'profile_id__1': 15, 'phone_number__1': "'+4988217530", 'customer_target_segments__1': 'Local community of Garmisch-Partenkirchen', 'company_name__1': 'Gemeindewerke Garmisch-Partenkirchen', 'industry__1': 'Municipal Utility', 'url__1': 'http://www.gw-gap.de', 'additional_info__1': '"{\\"Company Name\\": \\"Gemeindewerke Garmisch-Partenkirchen\\", \\"Original_Number\\": \\"\'+49 882 17530\\", \\"URL\\": \\"http://www.gw-gap.de\\" ... (1875 characters truncated) ... "The business model and target group are clearly communicated in the summary.\\", \\"Original Row Number\\": 3.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__1': 'Yes', 'profile_id__2': 15, 'phone_number__2': None, 'customer_target_segments__2': 'Members; Residents in Berlin', 'company_name__2': 'Bbg BERLINER BAUGENOSSENSCHAFT EG', 'industry__2': 'Housing Cooperative', 'url__2': 'http://www.bbg-eg.de', 'additional_info__2': '"{\\"Company Name\\": \\"Bbg BERLINER BAUGENOSSENSCHAFT EG\\", \\"Original_Number\\": null, \\"URL\\": \\"http://www.bbg-eg.de\\", \\"is_b2b\\": \\"Y ... (1836 characters truncated) ... he business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 4.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__2': 'Yes', 'profile_id__3': 15, 'phone_number__3': "'+4933120169258", 'customer_target_segments__3': 'IT Professionals; Network Administrators; IT Operations Leaders; Individuals seeking to improve skills in the technology sector', 'company_name__3': 'Negotiation Academy Potsdam', 'industry__3': 'IT Services', 'url__3': 'http://www.negotiation-academy-potsdam.de', 'additional_info__3': '"{\\"Company Name\\": \\"Negotiation Academy Potsdam\\", \\"Original_Number\\": \\"\'+49 33 120169258\\", \\"URL\\": \\"http://www.negotiation-academ ... (4783 characters truncated) ... he business model and target audience are reasonably clear from the summary.\\", \\"Original Row Number\\": 12.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__3': 'Yes', 'profile_id__4': 15, 'phone_number__4': "'+4939179298663", 'customer_target_segments__4': 'Handball fans; Sports enthusiasts', 'company_name__4': 'SC Magdeburg - Handball Magdeburg GmbH', 'industry__4': 'Sports (Handball)', 'url__4': 'http://www.scm-handball.de', 'additional_info__4': '"{\\"Company Name\\": \\"SC Magdeburg - Handball Magdeburg GmbH\\", \\"Original_Number\\": \\"\'+49 391 79298663\\", \\"URL\\": \\"http://www.scm-han ... (1622 characters truncated) ... otes\\": \\"The business model and target audience are clearly communicated.\\", \\"Original Row Number\\": 16.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__4': 'Yes', 'profile_id__5': 15, 'phone_number__5': '494518899700.0', 'customer_target_segments__5': 'Visitors; Tourists', 'company_name__5': 'Lübeck und Travemünde Marketing GmbH', 'industry__5': 'Tourism', 'url__5': 'http://www.visit-luebeck.com', 'additional_info__5': '"{\\"Company Name\\": \\"L\\\\u00fcbeck und Travem\\\\u00fcnde Marketing GmbH\\", \\"Original_Number\\": null, \\"URL\\": \\"http://www.visit-luebeck ... (1514 characters truncated) ...  business model and target audience are clearly communicated in the summary.\\", \\"Original Row Number\\": 19.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__5': 'Yes', 'profile_id__6': 15, 'phone_number__6': "'+4993130930" ... 7900 parameters truncated ... 'additional_info__993': '"{\\"Company Name\\": \\"Ben Fleet Services\\", \\"Original_Number\\": \\"\'+49 30 20003585\\", \\"URL\\": \\"http://www.benfleetservices.com\\", \\" ... (1344 characters truncated) ... business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 3278.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__993': 'Yes', 'profile_id__994': 15, 'phone_number__994': "'+496704962490", 'customer_target_segments__994': None, 'company_name__994': 'Embeka Technologies GmbH', 'industry__994': 'Metalworking', 'url__994': 'http://www.embeka.de', 'additional_info__994': '"{\\"Company Name\\": \\"Embeka Technologies GmbH\\", \\"Original_Number\\": \\"\'+49 6704 962490\\", \\"URL\\": \\"http://www.embeka.de\\", \\"is_b2 ... (1871 characters truncated) ... licitly stated but implied to be businesses needing metalworking services.\\", \\"Original Row Number\\": 3282.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__994': 'Yes', 'profile_id__995': 15, 'phone_number__995': "'+49224112000", 'customer_target_segments__995': 'Private customers; Commercial customers; Fleet customers', 'company_name__995': 'Autohaus HOFF', 'industry__995': 'Car Dealership', 'url__995': 'http://www.autohaus-hoff.de', 'additional_info__995': '"{\\"Company Name\\": \\"Autohaus HOFF\\", \\"Original_Number\\": \\"\'+49 224 112000\\", \\"URL\\": \\"http://www.autohaus-hoff.de\\", \\"is_b2b\\": ... (1909 characters truncated) ... ly articulated. The target audience is broad (private, commercial, fleet).\\", \\"Original Row Number\\": 3285.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__995': 'Yes', 'profile_id__996': 15, 'phone_number__996': "'+4936165790", 'customer_target_segments__996': 'Private clients; Corporate clients', 'company_name__996': 'Volksbank Thüringen Mitte eG', 'industry__996': 'Banking', 'url__996': 'http://www.volksbank-thueringen-mitte.de', 'additional_info__996': '"{\\"Company Name\\": \\"Volksbank Th\\\\u00fcringen Mitte eG\\", \\"Original_Number\\": \\"\'+49 361 65790\\", \\"URL\\": \\"http://www.volksbank-th ... (4647 characters truncated) ... business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 3290.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__996': 'Yes', 'profile_id__997': 15, 'phone_number__997': '496921243400.0', 'customer_target_segments__997': None, 'company_name__997': 'In-der-City-Bus GmbH', 'industry__997': 'Public Transportation', 'url__997': 'http://www.icb-ffm.de', 'additional_info__997': '"{\\"Company Name\\": \\"In-der-City-Bus GmbH\\", \\"Original_Number\\": null, \\"URL\\": \\"http://www.icb-ffm.de\\", \\"is_b2b\\": \\"Yes\\", \\"is ... (1508 characters truncated) ... business model is clear, but the target audience is not explicitly stated.\\", \\"Original Row Number\\": 3293.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__997': 'Yes', 'profile_id__998': 15, 'phone_number__998': "'+49971785703103", 'customer_target_segments__998': None, 'company_name__998': 'Bäckerei Peter Schmitt GmbH', 'industry__998': 'Bakery', 'url__998': 'http://www.baecker-schmitt.de', 'additional_info__998': '"{\\"Company Name\\": \\"B\\\\u00e4ckerei Peter Schmitt GmbH\\", \\"Original_Number\\": \\"\'+49 971 785703103\\", \\"URL\\": \\"http://www.baecker-s ... (1410 characters truncated) ... \"The business model is clear. The target group is broad, local customers.\\", \\"Original Row Number\\": 3296.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__998': 'Yes', 'profile_id__999': 15, 'phone_number__999': '4921325102170.0', 'customer_target_segments__999': 'Mid-sized businesses; Industries', 'company_name__999': 'SCHLAGHECK + RADTKE executive consultants', 'industry__999': 'Executive Search and Consulting', 'url__999': 'http://www.schlagheck-radtke.de', 'additional_info__999': '"{\\"Company Name\\": \\"SCHLAGHECK + RADTKE executive consultants\\", \\"Original_Number\\": null, \\"URL\\": \\"http://www.schlagheck-radtke.de\\", ... (4362 characters truncated) ... The business model and target group are reasonably clear from the summary.\\", \\"Original Row Number\\": 3297.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__999': 'Yes'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-07-07 14:47:12,090 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081012_8000-12000.csv ---
2025-07-07 14:47:12,090 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081012_8000-12000.csv...
2025-07-07 14:47:12,177 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_081012_8000-12000.csv.
2025-07-07 14:47:12,181 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 14:47:12,189 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 14:47:12,322 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 14:47:12,326 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 14:47:12,332 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 14:47:12,397 - INFO - etl.scripts.transform - Saved 2135 duplicate rows to etl/dropped_duplicates\duplicates_20250707_144712.csv
2025-07-07 14:47:12,399 - INFO - etl.scripts.transform - Removed 2135 duplicate phone numbers from the source file.
2025-07-07 14:47:12,399 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 14:47:12,399 - INFO - root - Starting deduplication...
2025-07-07 14:47:12,402 - INFO - root - Removed 643 rows with existing phone numbers.
2025-07-07 14:47:18,178 - WARNING - root - Potential duplicate found for 'Solutic'. Similarity: 92.3076923076923%. Matched with: 'soltic'. Skipping row and adding to review file.
2025-07-07 14:47:35,359 - WARNING - root - Potential duplicate found for 'Spaett GmbH & Co. KG'. Similarity: 92.3076923076923%. Matched with: 'spaes gmbh & co. kg'. Skipping row and adding to review file.
2025-07-07 14:47:36,705 - WARNING - root - Potential duplicate found for 'Gemeinde Saarwellingen'. Similarity: 90.0%. Matched with: 'gemeinde rellingen'. Skipping row and adding to review file.
2025-07-07 14:47:40,281 - WARNING - root - Potential duplicate found for 'move technology GmbH'. Similarity: 90.0%. Matched with: 'joke technology gmbh'. Skipping row and adding to review file.
2025-07-07 14:47:56,256 - WARNING - root - Potential duplicate found for 'Seven Group'. Similarity: 91.66666666666666%. Matched with: 'inseven group'. Skipping row and adding to review file.
2025-07-07 14:48:06,512 - WARNING - root - Potential duplicate found for 'EMO Systems GmbH'. Similarity: 90.32258064516128%. Matched with: 'ao systems gmbh'. Skipping row and adding to review file.
2025-07-07 14:48:23,447 - WARNING - root - Potential duplicate found for 'reer GmbH'. Similarity: 90.0%. Matched with: 'renner gmbh'. Skipping row and adding to review file.
2025-07-07 14:48:42,872 - WARNING - root - Potential duplicate found for 'HEROL Consulting GmbH'. Similarity: 90.0%. Matched with: 'hrm consulting gmbh'. Skipping row and adding to review file.
2025-07-07 14:48:50,567 - WARNING - root - Potential duplicate found for 'BASYS GmbH'. Similarity: 90.0%. Matched with: 'abass gmbh'. Skipping row and adding to review file.
2025-07-07 14:48:51,846 - WARNING - root - Potential duplicate found for 'kpp consultING gmbh'. Similarity: 91.89189189189189%. Matched with: 'p1 consulting gmbh'. Skipping row and adding to review file.
2025-07-07 14:48:53,944 - INFO - root - Saved 10 potential duplicates to etl/review\review_SalesOutreachReport_20250705_081012_8000-12000.csv
2025-07-07 14:48:53,944 - INFO - root - Deduplication complete. 1213 rows remaining for insertion.
2025-07-07 14:48:54,384 - INFO - etl.scripts.load - Found existing profile_id: 15 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 14:48:54,385 - INFO - etl.scripts.load - Loading 1213 rows with profile_id 15 into 'contacts' table...
2025-07-07 14:48:55,248 - ERROR - etl.scripts.load - Failed to load data into 'contacts': (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type boolean: "Unknown"
LINE 1: ...''+49303152484', 'Digital Media / Creative Tech', 'Unknown',...
                                                             ^

[SQL: INSERT INTO contacts (company_name, url, phone_number, industry, is_b2b, customer_target_segments, additional_info, profile_id) VALUES (%(company_name__0)s, %(url__0)s, %(phone_number__0)s, %(industry__0)s, %(is_b2b__0)s, %(customer_target_segments__ ... 185903 characters truncated ... b2b__999)s, %(customer_target_segments__999)s, %(additional_info__999)s::JSONB, %(profile_id__999)s)]
[parameters: {'profile_id__0': 15, 'phone_number__0': None, 'customer_target_segments__0': 'Residents; Visitors', 'company_name__0': 'Alte Hansestadt Lemgo', 'industry__0': 'Government/Municipal Services', 'url__0': 'http://www.lemgo.de', 'additional_info__0': '"{\\"Company Name\\": \\"Alte Hansestadt Lemgo\\", \\"Original_Number\\": null, \\"URL\\": \\"http://www.lemgo.de\\", \\"is_b2b\\": \\"Yes\\", \\"is_ ... (4965 characters truncated) ...  summary clearly communicates the services offered to residents and visitors.\\", \\"Original Row Number\\": 2.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__0': 'Yes', 'profile_id__1': 15, 'phone_number__1': "'+4930221841180", 'customer_target_segments__1': None, 'company_name__1': 'Via Physio', 'industry__1': 'Healthcare Services', 'url__1': 'http://www.viaphysio.de', 'additional_info__1': '"{\\"Company Name\\": \\"Via Physio\\", \\"Original_Number\\": \\"\'+49 30 221841180\\", \\"URL\\": \\"http://www.viaphysio.de\\", \\"is_b2b\\": \\"N ... (962 characters truncated) ... ull, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 11.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__1': 'No', 'profile_id__2': 15, 'phone_number__2': "'+496913378060", 'customer_target_segments__2': None, 'company_name__2': 'August Pfüller GmbH & Co. KG', 'industry__2': 'Retail Sector (B2B)', 'url__2': 'http://www.august-pfueller.shop', 'additional_info__2': '"{\\"Company Name\\": \\"August Pf\\\\u00fcller GmbH & Co. KG\\", \\"Original_Number\\": \\"\'+49 69 13378060\\", \\"URL\\": \\"http://www.august-pfu ... (1088 characters truncated) ... ull, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 12.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__2': 'No', 'profile_id__3': 15, 'phone_number__3': "'+49707260010", 'customer_target_segments__3': None, 'company_name__3': 'Freundeskreis Mensch', 'industry__3': 'Non-Profits / Associations (B2B)', 'url__3': 'http://www.freundeskreismensch.de', 'additional_info__3': '"{\\"Company Name\\": \\"Freundeskreis Mensch\\", \\"Original_Number\\": \\"\'+49 7072 60010\\", \\"URL\\": \\"http://www.freundeskreismensch.de\\",  ... (734 characters truncated) ... \"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 13.0, \\"ScrapeStatus\\": \\"HTTPError_404\\"}"', 'is_b2b__3': None, 'profile_id__4': 15, 'phone_number__4': "'+4964068346100", 'customer_target_segments__4': 'Individuals interested in Christian literature; Individuals interested in gifts; Individuals interested in music', 'company_name__4': 'Brunnen Verlag', 'industry__4': 'Publishing', 'url__4': 'http://www.brunnen-verlag.de', 'additional_info__4': '"{\\"Company Name\\": \\"Brunnen Verlag\\", \\"Original_Number\\": \\"\'+49 64 068346100\\", \\"URL\\": \\"http://www.brunnen-verlag.de\\", \\"is_b2b ... (3960 characters truncated) ... he business model and target audience are reasonably clear from the summary.\\", \\"Original Row Number\\": 16.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__4': 'Yes', 'profile_id__5': 15, 'phone_number__5': "'+4971413020", 'customer_target_segments__5': None, 'company_name__5': 'Schlosshotel Monrepos, Ludwigsburg', 'industry__5': 'Retail Technology / Hospitality Technology', 'url__5': 'http://www.schlosshotel-monrepos.de', 'additional_info__5': '"{\\"Company Name\\": \\"Schlosshotel Monrepos, Ludwigsburg\\", \\"Original_Number\\": \\"\'+49 7141 3020\\", \\"URL\\": \\"http://www.schlosshotel-m ... (1228 characters truncated) ...  Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 17.0, \\"ScrapeStatus\\": \\"Used_Fallback_Description\\"}"', 'is_b2b__5': 'No', 'profile_id__6': 15, 'phone_number__6': '499069990900.0' ... 7900 parameters truncated ... 'additional_info__993': '"{\\"Company Name\\": \\"Ruprecht Ingegneria SA\\", \\"Original_Number\\": \\"\'+41 91 936 00 00\\", \\"URL\\": \\"http://www.ruprecht-ingegneria.ch\ ... (3815 characters truncated) ... iness model and services are clear, target group is not explicitly stated.\\", \\"Original Row Number\\": 3618.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__993': 'Yes', 'profile_id__994': 15, 'phone_number__994': "'+41434444343", 'customer_target_segments__994': 'Individuals affected by multiple sclerosis (MS); Patients; Relatives; Volunteers; Professionals', 'company_name__994': 'Schweizerische Multiple Sklerose Gesellschaft', 'industry__994': 'Non-profit organization (Multiple Sclerosis Support)', 'url__994': 'http://www.multiplesklerose.ch', 'additional_info__994': '"{\\"Company Name\\": \\"Schweizerische Multiple Sklerose Gesellschaft\\", \\"Original_Number\\": \\"\'+41 43 444 43 43\\", \\"URL\\": \\"http://www. ... (5257 characters truncated) ...  target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 3621.0, \\"ScrapeStatus\\": \\"Used_Fallback_Description\\"}"', 'is_b2b__994': 'Yes', 'profile_id__995': 15, 'phone_number__995': "'+41269122551", 'customer_target_segments__995': None, 'company_name__995': 'deillon delley architectes sa', 'industry__995': 'Business Consulting / Management Consulting', 'url__995': 'http://www.deillondelley.ch', 'additional_info__995': '"{\\"Company Name\\": \\"deillon delley architectes sa\\", \\"Original_Number\\": \\"\'+41 26 912 25 51\\", \\"URL\\": \\"http://www.deillondelley.ch ... (1039 characters truncated) ... l, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 3622.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__995': 'Yes', 'profile_id__996': 15, 'phone_number__996': "'+41315607777", 'customer_target_segments__996': 'Medical service providers; Doctors; Practice staff; Medical professionals', 'company_name__996': 'Medpension vsao asmac', 'industry__996': 'Pension Fund for Medical Professionals', 'url__996': 'http://www.medpension.ch', 'additional_info__996': '"{\\"Company Name\\": \\"Medpension vsao asmac\\", \\"Original_Number\\": \\"\'+41 31 560 77 77\\", \\"URL\\": \\"http://www.medpension.ch\\", \\"is_ ... (4745 characters truncated) ... e business model and target group are clearly communicated in the summary.\\", \\"Original Row Number\\": 3623.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__996': 'Yes', 'profile_id__997': 15, 'phone_number__997': "'+41449102020", 'customer_target_segments__997': 'Residents of Volketswil', 'company_name__997': 'Gemeindeverwaltung Volketswil', 'industry__997': 'Government/Municipality', 'url__997': 'http://www.volketswil.ch', 'additional_info__997': '"{\\"Company Name\\": \\"Gemeindeverwaltung Volketswil\\", \\"Original_Number\\": \\"\'+41 44 910 20 20\\", \\"URL\\": \\"http://www.volketswil.ch\\" ... (4349 characters truncated) ... Notes\\": \\"The business model and target group are clearly communicated.\\", \\"Original Row Number\\": 3627.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__997': 'Yes', 'profile_id__998': 15, 'phone_number__998': "'+41449241818", 'customer_target_segments__998': 'Municipalities of Meilen and Uetikon am See', 'company_name__998': 'Infrastruktur Zürichsee AG', 'industry__998': 'Utilities', 'url__998': 'http://www.infra-z.ch', 'additional_info__998': '"{\\"Company Name\\": \\"Infrastruktur Z\\\\u00fcrichsee AG\\", \\"Original_Number\\": \\"\'+41 44 924 18 18\\", \\"URL\\": \\"http://www.infra-z.ch\ ... (1698 characters truncated) ... Notes\\": \\"The business model and target group are clearly communicated.\\", \\"Original Row Number\\": 3632.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__998': 'Yes', 'profile_id__999': 15, 'phone_number__999': '41223081620.0', 'customer_target_segments__999': 'Property managers; Individuals; Municipalities; Institutions; Industrial sites', 'company_name__999': 'Securelec SA', 'industry__999': 'Electrical Installation Inspection', 'url__999': 'http://www.securelec.ch', 'additional_info__999': '"{\\"Company Name\\": \\"Securelec SA\\", \\"Original_Number\\": null, \\"URL\\": \\"http://www.securelec.ch\\", \\"is_b2b\\": \\"Yes\\", \\"is_b2b_r ... (1924 characters truncated) ... Business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 3634.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__999': 'Yes'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-07-07 14:48:55,250 - ERROR - root - Failed to load data for SalesOutreachReport_20250705_081012_8000-12000.csv. Halting processing for this file. Error: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type boolean: "Unknown"
LINE 1: ...''+49303152484', 'Digital Media / Creative Tech', 'Unknown',...
                                                             ^

[SQL: INSERT INTO contacts (company_name, url, phone_number, industry, is_b2b, customer_target_segments, additional_info, profile_id) VALUES (%(company_name__0)s, %(url__0)s, %(phone_number__0)s, %(industry__0)s, %(is_b2b__0)s, %(customer_target_segments__ ... 185903 characters truncated ... b2b__999)s, %(customer_target_segments__999)s, %(additional_info__999)s::JSONB, %(profile_id__999)s)]
[parameters: {'profile_id__0': 15, 'phone_number__0': None, 'customer_target_segments__0': 'Residents; Visitors', 'company_name__0': 'Alte Hansestadt Lemgo', 'industry__0': 'Government/Municipal Services', 'url__0': 'http://www.lemgo.de', 'additional_info__0': '"{\\"Company Name\\": \\"Alte Hansestadt Lemgo\\", \\"Original_Number\\": null, \\"URL\\": \\"http://www.lemgo.de\\", \\"is_b2b\\": \\"Yes\\", \\"is_ ... (4965 characters truncated) ...  summary clearly communicates the services offered to residents and visitors.\\", \\"Original Row Number\\": 2.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__0': 'Yes', 'profile_id__1': 15, 'phone_number__1': "'+4930221841180", 'customer_target_segments__1': None, 'company_name__1': 'Via Physio', 'industry__1': 'Healthcare Services', 'url__1': 'http://www.viaphysio.de', 'additional_info__1': '"{\\"Company Name\\": \\"Via Physio\\", \\"Original_Number\\": \\"\'+49 30 221841180\\", \\"URL\\": \\"http://www.viaphysio.de\\", \\"is_b2b\\": \\"N ... (962 characters truncated) ... ull, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 11.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__1': 'No', 'profile_id__2': 15, 'phone_number__2': "'+496913378060", 'customer_target_segments__2': None, 'company_name__2': 'August Pfüller GmbH & Co. KG', 'industry__2': 'Retail Sector (B2B)', 'url__2': 'http://www.august-pfueller.shop', 'additional_info__2': '"{\\"Company Name\\": \\"August Pf\\\\u00fcller GmbH & Co. KG\\", \\"Original_Number\\": \\"\'+49 69 13378060\\", \\"URL\\": \\"http://www.august-pfu ... (1088 characters truncated) ... ull, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 12.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__2': 'No', 'profile_id__3': 15, 'phone_number__3': "'+49707260010", 'customer_target_segments__3': None, 'company_name__3': 'Freundeskreis Mensch', 'industry__3': 'Non-Profits / Associations (B2B)', 'url__3': 'http://www.freundeskreismensch.de', 'additional_info__3': '"{\\"Company Name\\": \\"Freundeskreis Mensch\\", \\"Original_Number\\": \\"\'+49 7072 60010\\", \\"URL\\": \\"http://www.freundeskreismensch.de\\",  ... (734 characters truncated) ... \"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 13.0, \\"ScrapeStatus\\": \\"HTTPError_404\\"}"', 'is_b2b__3': None, 'profile_id__4': 15, 'phone_number__4': "'+4964068346100", 'customer_target_segments__4': 'Individuals interested in Christian literature; Individuals interested in gifts; Individuals interested in music', 'company_name__4': 'Brunnen Verlag', 'industry__4': 'Publishing', 'url__4': 'http://www.brunnen-verlag.de', 'additional_info__4': '"{\\"Company Name\\": \\"Brunnen Verlag\\", \\"Original_Number\\": \\"\'+49 64 068346100\\", \\"URL\\": \\"http://www.brunnen-verlag.de\\", \\"is_b2b ... (3960 characters truncated) ... he business model and target audience are reasonably clear from the summary.\\", \\"Original Row Number\\": 16.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__4': 'Yes', 'profile_id__5': 15, 'phone_number__5': "'+4971413020", 'customer_target_segments__5': None, 'company_name__5': 'Schlosshotel Monrepos, Ludwigsburg', 'industry__5': 'Retail Technology / Hospitality Technology', 'url__5': 'http://www.schlosshotel-monrepos.de', 'additional_info__5': '"{\\"Company Name\\": \\"Schlosshotel Monrepos, Ludwigsburg\\", \\"Original_Number\\": \\"\'+49 7141 3020\\", \\"URL\\": \\"http://www.schlosshotel-m ... (1228 characters truncated) ...  Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 17.0, \\"ScrapeStatus\\": \\"Used_Fallback_Description\\"}"', 'is_b2b__5': 'No', 'profile_id__6': 15, 'phone_number__6': '499069990900.0' ... 7900 parameters truncated ... 'additional_info__993': '"{\\"Company Name\\": \\"Ruprecht Ingegneria SA\\", \\"Original_Number\\": \\"\'+41 91 936 00 00\\", \\"URL\\": \\"http://www.ruprecht-ingegneria.ch\ ... (3815 characters truncated) ... iness model and services are clear, target group is not explicitly stated.\\", \\"Original Row Number\\": 3618.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__993': 'Yes', 'profile_id__994': 15, 'phone_number__994': "'+41434444343", 'customer_target_segments__994': 'Individuals affected by multiple sclerosis (MS); Patients; Relatives; Volunteers; Professionals', 'company_name__994': 'Schweizerische Multiple Sklerose Gesellschaft', 'industry__994': 'Non-profit organization (Multiple Sclerosis Support)', 'url__994': 'http://www.multiplesklerose.ch', 'additional_info__994': '"{\\"Company Name\\": \\"Schweizerische Multiple Sklerose Gesellschaft\\", \\"Original_Number\\": \\"\'+41 43 444 43 43\\", \\"URL\\": \\"http://www. ... (5257 characters truncated) ...  target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 3621.0, \\"ScrapeStatus\\": \\"Used_Fallback_Description\\"}"', 'is_b2b__994': 'Yes', 'profile_id__995': 15, 'phone_number__995': "'+41269122551", 'customer_target_segments__995': None, 'company_name__995': 'deillon delley architectes sa', 'industry__995': 'Business Consulting / Management Consulting', 'url__995': 'http://www.deillondelley.ch', 'additional_info__995': '"{\\"Company Name\\": \\"deillon delley architectes sa\\", \\"Original_Number\\": \\"\'+41 26 912 25 51\\", \\"URL\\": \\"http://www.deillondelley.ch ... (1039 characters truncated) ... l, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 3622.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__995': 'Yes', 'profile_id__996': 15, 'phone_number__996': "'+41315607777", 'customer_target_segments__996': 'Medical service providers; Doctors; Practice staff; Medical professionals', 'company_name__996': 'Medpension vsao asmac', 'industry__996': 'Pension Fund for Medical Professionals', 'url__996': 'http://www.medpension.ch', 'additional_info__996': '"{\\"Company Name\\": \\"Medpension vsao asmac\\", \\"Original_Number\\": \\"\'+41 31 560 77 77\\", \\"URL\\": \\"http://www.medpension.ch\\", \\"is_ ... (4745 characters truncated) ... e business model and target group are clearly communicated in the summary.\\", \\"Original Row Number\\": 3623.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__996': 'Yes', 'profile_id__997': 15, 'phone_number__997': "'+41449102020", 'customer_target_segments__997': 'Residents of Volketswil', 'company_name__997': 'Gemeindeverwaltung Volketswil', 'industry__997': 'Government/Municipality', 'url__997': 'http://www.volketswil.ch', 'additional_info__997': '"{\\"Company Name\\": \\"Gemeindeverwaltung Volketswil\\", \\"Original_Number\\": \\"\'+41 44 910 20 20\\", \\"URL\\": \\"http://www.volketswil.ch\\" ... (4349 characters truncated) ... Notes\\": \\"The business model and target group are clearly communicated.\\", \\"Original Row Number\\": 3627.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__997': 'Yes', 'profile_id__998': 15, 'phone_number__998': "'+41449241818", 'customer_target_segments__998': 'Municipalities of Meilen and Uetikon am See', 'company_name__998': 'Infrastruktur Zürichsee AG', 'industry__998': 'Utilities', 'url__998': 'http://www.infra-z.ch', 'additional_info__998': '"{\\"Company Name\\": \\"Infrastruktur Z\\\\u00fcrichsee AG\\", \\"Original_Number\\": \\"\'+41 44 924 18 18\\", \\"URL\\": \\"http://www.infra-z.ch\ ... (1698 characters truncated) ... Notes\\": \\"The business model and target group are clearly communicated.\\", \\"Original Row Number\\": 3632.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__998': 'Yes', 'profile_id__999': 15, 'phone_number__999': '41223081620.0', 'customer_target_segments__999': 'Property managers; Individuals; Municipalities; Institutions; Industrial sites', 'company_name__999': 'Securelec SA', 'industry__999': 'Electrical Installation Inspection', 'url__999': 'http://www.securelec.ch', 'additional_info__999': '"{\\"Company Name\\": \\"Securelec SA\\", \\"Original_Number\\": null, \\"URL\\": \\"http://www.securelec.ch\\", \\"is_b2b\\": \\"Yes\\", \\"is_b2b_r ... (1924 characters truncated) ... Business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 3634.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__999': 'Yes'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-07-07 14:48:55,251 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081027_12000-16000.csv ---
2025-07-07 14:48:55,251 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081027_12000-16000.csv...
2025-07-07 14:48:55,387 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_081027_12000-16000.csv.
2025-07-07 14:48:55,389 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 14:48:55,397 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 14:48:55,574 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 14:48:55,577 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 14:48:55,584 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 14:48:55,656 - INFO - etl.scripts.transform - Saved 1304 duplicate rows to etl/dropped_duplicates\duplicates_20250707_144855.csv
2025-07-07 14:48:55,657 - INFO - etl.scripts.transform - Removed 1304 duplicate phone numbers from the source file.
2025-07-07 14:48:55,658 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 14:48:55,658 - INFO - root - Starting deduplication...
2025-07-07 14:48:55,662 - INFO - root - Removed 811 rows with existing phone numbers.
2025-07-07 14:48:57,892 - WARNING - root - Potential duplicate found for 'CeH4 technologies GmbH'. Similarity: 90.47619047619048%. Matched with: 'cm technologies gmbh'. Skipping row and adding to review file.
2025-07-07 14:49:18,477 - INFO - root - Logging configured successfully.
2025-07-07 14:49:21,602 - WARNING - root - --- Starting Database Reset ---
2025-07-07 14:49:21,619 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:49:22,853 - INFO - root - Deleting all records from 'contacts' table...
2025-07-07 14:49:23,060 - INFO - root - ...done.
2025-07-07 14:49:23,061 - INFO - root - Deleting all records from 'contact_profiles' table...
2025-07-07 14:49:23,163 - INFO - root - ...done.
2025-07-07 14:49:23,260 - INFO - root - --- Database Reset Successfully ---
2025-07-07 14:50:11,973 - INFO - root - Logging configured successfully.
2025-07-07 14:50:11,974 - INFO - root - ETL pipeline started.
2025-07-07 14:50:11,989 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:50:13,459 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 14:50:13,460 - INFO - etl.scripts.extract - Found 7 CSV files in etl/input_data.
2025-07-07 14:50:13,461 - INFO - root - --- Processing file: SalesOutreachReport_20250705_080954_4000-8000.csv ---
2025-07-07 14:50:13,462 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_080954_4000-8000.csv...
2025-07-07 14:50:13,592 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_080954_4000-8000.csv.
2025-07-07 14:50:13,592 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 14:50:13,600 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 14:50:13,795 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 14:50:13,801 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 14:50:13,817 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 14:50:13,876 - INFO - etl.scripts.transform - Saved 1077 duplicate rows to etl/dropped_duplicates\duplicates_20250707_145013.csv
2025-07-07 14:50:13,878 - INFO - etl.scripts.transform - Removed 1077 duplicate phone numbers from the source file.
2025-07-07 14:50:13,878 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 14:50:13,878 - INFO - root - Starting deduplication...
2025-07-07 14:50:13,880 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 14:50:14,009 - INFO - root - Deduplication complete. 2924 rows remaining for insertion.
2025-07-07 14:50:14,319 - INFO - etl.scripts.load - Created new profile_id: 16 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 14:50:14,320 - INFO - etl.scripts.load - Loading 2924 rows with profile_id 16 into 'contacts' table...
2025-07-07 14:50:17,049 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 14:50:17,050 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SalesOutreachReport_20250705_080954_4000-8000.csv
2025-07-07 14:50:17,051 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081012_8000-12000.csv ---
2025-07-07 14:50:17,051 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081012_8000-12000.csv...
2025-07-07 14:50:17,118 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_081012_8000-12000.csv.
2025-07-07 14:50:17,120 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 14:50:17,127 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 14:50:17,317 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 14:50:17,319 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 14:50:17,323 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 14:50:17,379 - INFO - etl.scripts.transform - Saved 2135 duplicate rows to etl/dropped_duplicates\duplicates_20250707_145017.csv
2025-07-07 14:50:17,380 - INFO - etl.scripts.transform - Removed 2135 duplicate phone numbers from the source file.
2025-07-07 14:50:17,381 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 14:50:17,381 - INFO - root - Starting deduplication...
2025-07-07 14:50:17,382 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 14:50:17,448 - INFO - root - Deduplication complete. 1866 rows remaining for insertion.
2025-07-07 14:50:17,781 - INFO - etl.scripts.load - Found existing profile_id: 16 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 14:50:17,781 - INFO - etl.scripts.load - Loading 1866 rows with profile_id 16 into 'contacts' table...
2025-07-07 14:50:18,718 - ERROR - etl.scripts.load - Failed to load data into 'contacts': (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "unique_phone_number"
DETAIL:  Key (phone_number)=('+4960239580) already exists.

[SQL: INSERT INTO contacts (company_name, url, phone_number, industry, is_b2b, customer_target_segments, additional_info, profile_id) VALUES (%(company_name__0)s, %(url__0)s, %(phone_number__0)s, %(industry__0)s, %(is_b2b__0)s, %(customer_target_segments__ ... 185903 characters truncated ... b2b__999)s, %(customer_target_segments__999)s, %(additional_info__999)s::JSONB, %(profile_id__999)s)]
[parameters: {'url__0': 'http://www.lemgo.de', 'profile_id__0': 16, 'industry__0': 'Government/Municipal Services', 'company_name__0': 'Alte Hansestadt Lemgo', 'phone_number__0': None, 'additional_info__0': '"{\\"Company Name\\": \\"Alte Hansestadt Lemgo\\", \\"Original_Number\\": null, \\"URL\\": \\"http://www.lemgo.de\\", \\"is_b2b\\": \\"Yes\\", \\"is_ ... (4965 characters truncated) ...  summary clearly communicates the services offered to residents and visitors.\\", \\"Original Row Number\\": 2.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__0': True, 'customer_target_segments__0': 'Residents; Visitors', 'url__1': 'http://www.carbocon.de', 'profile_id__1': 16, 'industry__1': 'Carbon Concrete Services', 'company_name__1': 'CARBOCON GMBH', 'phone_number__1': "'+4935148205500", 'additional_info__1': '"{\\"Company Name\\": \\"CARBOCON GMBH\\", \\"Original_Number\\": \\"\'+49 351 48205500\\", \\"URL\\": \\"http://www.carbocon.de\\", \\"is_b2b\\": \\ ... (4553 characters truncated) ... ell-defined within the construction and materials industry.\\", \\"Original Row Number\\": 3.0, \\"ScrapeStatus\\": \\"Used_Fallback_Description\\"}"', 'is_b2b__1': True, 'customer_target_segments__1': 'Building owners; Manufacturers; Users; Parties involved in carbon concrete projects', 'url__2': 'http://www.worm-consulting.de', 'profile_id__2': 16, 'industry__2': 'Marketing Consulting', 'company_name__2': 'Worm Marketing Consulting GmbH', 'phone_number__2': "'+4989230693000", 'additional_info__2': '"{\\"Company Name\\": \\"Worm Marketing Consulting GmbH\\", \\"Original_Number\\": \\"\'+49 89 230693000\\", \\"URL\\": \\"http://www.worm-consulting ... (5081 characters truncated) ... \\"Business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 4.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__2': True, 'customer_target_segments__2': 'IT companies; Software companies; Industrial companies; Medium-sized businesses; Large corporations', 'url__3': 'http://www.ts-aalen.de', 'profile_id__3': 16, 'industry__3': 'Vocational Education', 'company_name__3': 'Technische Schule Aalen', 'phone_number__3': "'+497361566100", 'additional_info__3': '"{\\"Company Name\\": \\"Technische Schule Aalen\\", \\"Original_Number\\": \\"\'+49 736 1566100\\", \\"URL\\": \\"http://www.ts-aalen.de\\", \\"is_b ... (1745 characters truncated) ... siness model and offerings are clearly articulated. Target audience is broad.\\", \\"Original Row Number\\": 5.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__3': True, 'customer_target_segments__3': 'Students with Mittlere Reife; Students with completed vocational training; Aspiring technicians; Teachers; Graduates', 'url__4': 'http://www.mainwebsolutions.de', 'profile_id__4': 16, 'industry__4': 'Digital Agency', 'company_name__4': 'Mainwebsolutions', 'phone_number__4': "'+4993173041810", 'additional_info__4': '"{\\"Company Name\\": \\"Mainwebsolutions\\", \\"Original_Number\\": \\"\'+49 931 73041810\\", \\"URL\\": \\"http://www.mainwebsolutions.de\\", \\"is ... (4890 characters truncated) ... \\"Business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 6.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__4': True, 'customer_target_segments__4': 'Small and medium-sized enterprises (Mittelstand); Larger companies', 'url__5': 'http://www.bb-gesellschaft.de', 'profile_id__5': 16, 'industry__5': 'Vocational Training and Education', 'company_name__5': 'bb gesellschaft für beruf + bildung mbh', 'phone_number__5': "'+49461144380", 'additional_info__5': '"{\\"Company Name\\": \\"bb gesellschaft f\\\\u00fcr beruf + bildung mbh\\", \\"Original_Number\\": \\"\'+49 461 144380\\", \\"URL\\": \\"http://www. ... (4884 characters truncated) ... he business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 8.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__5': True, 'customer_target_segments__5': 'Job seekers; Trainees; Employees; Women; Young people; Men; People with migration backgrounds; People with disabilities/rehabilitants; Pupils; School dropouts; Those seeking retraining', 'url__6': 'http://www.zesys.de', 'profile_id__6': 16 ... 7900 parameters truncated ... 'is_b2b__993': True, 'customer_target_segments__993': 'Digital dentistry professionals; Dental prosthetics and implant manufacturers', 'url__994': 'http://www.jf-group.net', 'profile_id__994': 16, 'industry__994': 'Electrical Engineering Solutions', 'company_name__994': 'JF Group GmbH', 'phone_number__994': "'+4921817576748", 'additional_info__994': '"{\\"Company Name\\": \\"JF Group GmbH\\", \\"Original_Number\\": \\"\'+49 2181 7576748\\", \\"URL\\": \\"http://www.jf-group.net\\", \\"is_b2b\\": \ ... (4696 characters truncated) ... d target audience are reasonably clear from the summary.\\", \\"Original Row Number\\": 3021.0, \\"ScrapeStatus\\": \\"Used_Fallback_Description\\"}"', 'is_b2b__994': True, 'customer_target_segments__994': 'Individuals; Companies', 'url__995': 'http://www.eps-personal.org', 'profile_id__995': 16, 'industry__995': 'Personnel Services', 'company_name__995': 'EPS Personalservice GmbH', 'phone_number__995': "'+497231105093", 'additional_info__995': '"{\\"Company Name\\": \\"EPS Personalservice GmbH\\", \\"Original_Number\\": \\"\'+49 7231 105093\\", \\"URL\\": \\"http://www.eps-personal.org\\", \ ... (4953 characters truncated) ... business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 3022.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__995': True, 'customer_target_segments__995': 'Companies seeking qualified personnel; Job seekers (industrial, commercial, technical, and management roles)', 'url__996': 'http://www.ifuel.aero', 'profile_id__996': 16, 'industry__996': 'Aviation Fuel and Services', 'company_name__996': 'iFuel', 'phone_number__996': "'+12076928288", 'additional_info__996': '"{\\"Company Name\\": \\"iFuel\\", \\"Original_Number\\": \\"\'+1 207-692-8288\\", \\"URL\\": \\"http://www.ifuel.aero\\", \\"is_b2b\\": \\"Yes\\", \ ... (1758 characters truncated) ... Business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 3023.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__996': True, 'customer_target_segments__996': 'HNWIs; Corporate operators; Fixed base operators; Militaries; Fuel resellers; Cargo and passenger airlines; Royal flight departments; Heads of state', 'url__997': 'http://www.sun-x.energy', 'profile_id__997': 16, 'industry__997': 'Solar Technology', 'company_name__997': 'sun-X', 'phone_number__997': "'+49812255379830", 'additional_info__997': '"{\\"Company Name\\": \\"sun-X\\", \\"Original_Number\\": \\"\'+49 8122 55379830\\", \\"URL\\": \\"http://www.sun-x.energy\\", \\"is_b2b\\": \\"Yes\\ ... (4997 characters truncated) ... rly articulated. The target audience is implied but not explicitly stated.\\", \\"Original Row Number\\": 3024.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__997': True, 'customer_target_segments__997': 'Photovoltaic systems owners', 'url__998': 'http://www.orgapropre.ch', 'profile_id__998': 16, 'industry__998': 'Cleaning and Remediation Services', 'company_name__998': 'Orgapropre SA', 'phone_number__998': "'+41227388485", 'additional_info__998': '"{\\"Company Name\\": \\"Orgapropre SA\\", \\"Original_Number\\": \\"\'+41 22 738 84 85\\", \\"URL\\": \\"http://www.orgapropre.ch\\", \\"is_b2b\\":  ... (4311 characters truncated) ... e businesses and individuals in need of cleaning and remediation services.\\", \\"Original Row Number\\": 3025.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__998': True, 'customer_target_segments__998': None, 'url__999': 'http://www.licatec.de', 'profile_id__999': 16, 'industry__999': 'Electrical and Mechanical Engineering', 'company_name__999': 'Licatec GmbH', 'phone_number__999': "'+492234955660", 'additional_info__999': '"{\\"Company Name\\": \\"Licatec GmbH\\", \\"Original_Number\\": \\"\'+49 2234 955660\\", \\"URL\\": \\"http://www.licatec.de\\", \\"is_b2b\\": \\"Ye ... (1976 characters truncated) ... "The summary clearly describes the products/services and target customers.\\", \\"Original Row Number\\": 3026.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__999': True, 'customer_target_segments__999': 'Electricians; Manufacturers of machinery; Manufacturers of switch cabinets'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-07 14:50:18,720 - ERROR - root - Failed to load data for SalesOutreachReport_20250705_081012_8000-12000.csv. Halting processing for this file. Error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "unique_phone_number"
DETAIL:  Key (phone_number)=('+4960239580) already exists.

[SQL: INSERT INTO contacts (company_name, url, phone_number, industry, is_b2b, customer_target_segments, additional_info, profile_id) VALUES (%(company_name__0)s, %(url__0)s, %(phone_number__0)s, %(industry__0)s, %(is_b2b__0)s, %(customer_target_segments__ ... 185903 characters truncated ... b2b__999)s, %(customer_target_segments__999)s, %(additional_info__999)s::JSONB, %(profile_id__999)s)]
[parameters: {'url__0': 'http://www.lemgo.de', 'profile_id__0': 16, 'industry__0': 'Government/Municipal Services', 'company_name__0': 'Alte Hansestadt Lemgo', 'phone_number__0': None, 'additional_info__0': '"{\\"Company Name\\": \\"Alte Hansestadt Lemgo\\", \\"Original_Number\\": null, \\"URL\\": \\"http://www.lemgo.de\\", \\"is_b2b\\": \\"Yes\\", \\"is_ ... (4965 characters truncated) ...  summary clearly communicates the services offered to residents and visitors.\\", \\"Original Row Number\\": 2.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__0': True, 'customer_target_segments__0': 'Residents; Visitors', 'url__1': 'http://www.carbocon.de', 'profile_id__1': 16, 'industry__1': 'Carbon Concrete Services', 'company_name__1': 'CARBOCON GMBH', 'phone_number__1': "'+4935148205500", 'additional_info__1': '"{\\"Company Name\\": \\"CARBOCON GMBH\\", \\"Original_Number\\": \\"\'+49 351 48205500\\", \\"URL\\": \\"http://www.carbocon.de\\", \\"is_b2b\\": \\ ... (4553 characters truncated) ... ell-defined within the construction and materials industry.\\", \\"Original Row Number\\": 3.0, \\"ScrapeStatus\\": \\"Used_Fallback_Description\\"}"', 'is_b2b__1': True, 'customer_target_segments__1': 'Building owners; Manufacturers; Users; Parties involved in carbon concrete projects', 'url__2': 'http://www.worm-consulting.de', 'profile_id__2': 16, 'industry__2': 'Marketing Consulting', 'company_name__2': 'Worm Marketing Consulting GmbH', 'phone_number__2': "'+4989230693000", 'additional_info__2': '"{\\"Company Name\\": \\"Worm Marketing Consulting GmbH\\", \\"Original_Number\\": \\"\'+49 89 230693000\\", \\"URL\\": \\"http://www.worm-consulting ... (5081 characters truncated) ... \\"Business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 4.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__2': True, 'customer_target_segments__2': 'IT companies; Software companies; Industrial companies; Medium-sized businesses; Large corporations', 'url__3': 'http://www.ts-aalen.de', 'profile_id__3': 16, 'industry__3': 'Vocational Education', 'company_name__3': 'Technische Schule Aalen', 'phone_number__3': "'+497361566100", 'additional_info__3': '"{\\"Company Name\\": \\"Technische Schule Aalen\\", \\"Original_Number\\": \\"\'+49 736 1566100\\", \\"URL\\": \\"http://www.ts-aalen.de\\", \\"is_b ... (1745 characters truncated) ... siness model and offerings are clearly articulated. Target audience is broad.\\", \\"Original Row Number\\": 5.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__3': True, 'customer_target_segments__3': 'Students with Mittlere Reife; Students with completed vocational training; Aspiring technicians; Teachers; Graduates', 'url__4': 'http://www.mainwebsolutions.de', 'profile_id__4': 16, 'industry__4': 'Digital Agency', 'company_name__4': 'Mainwebsolutions', 'phone_number__4': "'+4993173041810", 'additional_info__4': '"{\\"Company Name\\": \\"Mainwebsolutions\\", \\"Original_Number\\": \\"\'+49 931 73041810\\", \\"URL\\": \\"http://www.mainwebsolutions.de\\", \\"is ... (4890 characters truncated) ... \\"Business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 6.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__4': True, 'customer_target_segments__4': 'Small and medium-sized enterprises (Mittelstand); Larger companies', 'url__5': 'http://www.bb-gesellschaft.de', 'profile_id__5': 16, 'industry__5': 'Vocational Training and Education', 'company_name__5': 'bb gesellschaft für beruf + bildung mbh', 'phone_number__5': "'+49461144380", 'additional_info__5': '"{\\"Company Name\\": \\"bb gesellschaft f\\\\u00fcr beruf + bildung mbh\\", \\"Original_Number\\": \\"\'+49 461 144380\\", \\"URL\\": \\"http://www. ... (4884 characters truncated) ... he business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 8.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__5': True, 'customer_target_segments__5': 'Job seekers; Trainees; Employees; Women; Young people; Men; People with migration backgrounds; People with disabilities/rehabilitants; Pupils; School dropouts; Those seeking retraining', 'url__6': 'http://www.zesys.de', 'profile_id__6': 16 ... 7900 parameters truncated ... 'is_b2b__993': True, 'customer_target_segments__993': 'Digital dentistry professionals; Dental prosthetics and implant manufacturers', 'url__994': 'http://www.jf-group.net', 'profile_id__994': 16, 'industry__994': 'Electrical Engineering Solutions', 'company_name__994': 'JF Group GmbH', 'phone_number__994': "'+4921817576748", 'additional_info__994': '"{\\"Company Name\\": \\"JF Group GmbH\\", \\"Original_Number\\": \\"\'+49 2181 7576748\\", \\"URL\\": \\"http://www.jf-group.net\\", \\"is_b2b\\": \ ... (4696 characters truncated) ... d target audience are reasonably clear from the summary.\\", \\"Original Row Number\\": 3021.0, \\"ScrapeStatus\\": \\"Used_Fallback_Description\\"}"', 'is_b2b__994': True, 'customer_target_segments__994': 'Individuals; Companies', 'url__995': 'http://www.eps-personal.org', 'profile_id__995': 16, 'industry__995': 'Personnel Services', 'company_name__995': 'EPS Personalservice GmbH', 'phone_number__995': "'+497231105093", 'additional_info__995': '"{\\"Company Name\\": \\"EPS Personalservice GmbH\\", \\"Original_Number\\": \\"\'+49 7231 105093\\", \\"URL\\": \\"http://www.eps-personal.org\\", \ ... (4953 characters truncated) ... business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 3022.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__995': True, 'customer_target_segments__995': 'Companies seeking qualified personnel; Job seekers (industrial, commercial, technical, and management roles)', 'url__996': 'http://www.ifuel.aero', 'profile_id__996': 16, 'industry__996': 'Aviation Fuel and Services', 'company_name__996': 'iFuel', 'phone_number__996': "'+12076928288", 'additional_info__996': '"{\\"Company Name\\": \\"iFuel\\", \\"Original_Number\\": \\"\'+1 207-692-8288\\", \\"URL\\": \\"http://www.ifuel.aero\\", \\"is_b2b\\": \\"Yes\\", \ ... (1758 characters truncated) ... Business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 3023.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__996': True, 'customer_target_segments__996': 'HNWIs; Corporate operators; Fixed base operators; Militaries; Fuel resellers; Cargo and passenger airlines; Royal flight departments; Heads of state', 'url__997': 'http://www.sun-x.energy', 'profile_id__997': 16, 'industry__997': 'Solar Technology', 'company_name__997': 'sun-X', 'phone_number__997': "'+49812255379830", 'additional_info__997': '"{\\"Company Name\\": \\"sun-X\\", \\"Original_Number\\": \\"\'+49 8122 55379830\\", \\"URL\\": \\"http://www.sun-x.energy\\", \\"is_b2b\\": \\"Yes\\ ... (4997 characters truncated) ... rly articulated. The target audience is implied but not explicitly stated.\\", \\"Original Row Number\\": 3024.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__997': True, 'customer_target_segments__997': 'Photovoltaic systems owners', 'url__998': 'http://www.orgapropre.ch', 'profile_id__998': 16, 'industry__998': 'Cleaning and Remediation Services', 'company_name__998': 'Orgapropre SA', 'phone_number__998': "'+41227388485", 'additional_info__998': '"{\\"Company Name\\": \\"Orgapropre SA\\", \\"Original_Number\\": \\"\'+41 22 738 84 85\\", \\"URL\\": \\"http://www.orgapropre.ch\\", \\"is_b2b\\":  ... (4311 characters truncated) ... e businesses and individuals in need of cleaning and remediation services.\\", \\"Original Row Number\\": 3025.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__998': True, 'customer_target_segments__998': None, 'url__999': 'http://www.licatec.de', 'profile_id__999': 16, 'industry__999': 'Electrical and Mechanical Engineering', 'company_name__999': 'Licatec GmbH', 'phone_number__999': "'+492234955660", 'additional_info__999': '"{\\"Company Name\\": \\"Licatec GmbH\\", \\"Original_Number\\": \\"\'+49 2234 955660\\", \\"URL\\": \\"http://www.licatec.de\\", \\"is_b2b\\": \\"Ye ... (1976 characters truncated) ... "The summary clearly describes the products/services and target customers.\\", \\"Original Row Number\\": 3026.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__999': True, 'customer_target_segments__999': 'Electricians; Manufacturers of machinery; Manufacturers of switch cabinets'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-07 14:50:18,721 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081027_12000-16000.csv ---
2025-07-07 14:50:18,721 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081027_12000-16000.csv...
2025-07-07 14:50:18,824 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_081027_12000-16000.csv.
2025-07-07 14:50:18,826 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 14:50:18,834 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 14:50:19,002 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 14:50:19,006 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 14:50:19,011 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 14:50:19,061 - INFO - etl.scripts.transform - Saved 1304 duplicate rows to etl/dropped_duplicates\duplicates_20250707_145019.csv
2025-07-07 14:50:19,063 - INFO - etl.scripts.transform - Removed 1304 duplicate phone numbers from the source file.
2025-07-07 14:50:19,064 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 14:50:19,064 - INFO - root - Starting deduplication...
2025-07-07 14:50:19,065 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 14:50:19,170 - INFO - root - Deduplication complete. 2697 rows remaining for insertion.
2025-07-07 14:50:19,528 - INFO - etl.scripts.load - Found existing profile_id: 16 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 14:50:19,529 - INFO - etl.scripts.load - Loading 2697 rows with profile_id 16 into 'contacts' table...
2025-07-07 14:50:21,435 - ERROR - etl.scripts.load - Failed to load data into 'contacts': (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "unique_phone_number"
DETAIL:  Key (phone_number)=('+49898931610) already exists.

[SQL: INSERT INTO contacts (company_name, url, phone_number, industry, is_b2b, customer_target_segments, additional_info, profile_id) VALUES (%(company_name__0)s, %(url__0)s, %(phone_number__0)s, %(industry__0)s, %(is_b2b__0)s, %(customer_target_segments__ ... 185903 characters truncated ... b2b__999)s, %(customer_target_segments__999)s, %(additional_info__999)s::JSONB, %(profile_id__999)s)]
[parameters: {'url__0': 'http://www.alu-hofstaetter.at', 'profile_id__0': 16, 'industry__0': 'Metal Construction', 'company_name__0': 'Alu Hofstätter GmbH', 'phone_number__0': "'+43333851131", 'additional_info__0': '"{\\"Company Name\\": \\"Alu Hofst\\\\u00e4tter GmbH\\", \\"Original_Number\\": \\"\'+43 333 851131\\", \\"URL\\": \\"http://www.alu-hofstaetter.at\\ ... (1969 characters truncated) ... The summary provides a good overview of the products and services offered.\\", \\"Original Row Number\\": 1165.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__0': True, 'customer_target_segments__0': None, 'url__1': 'http://www.hcl-logistics.de', 'profile_id__1': 16, 'industry__1': 'Logistics', 'company_name__1': 'HCL-Logistics GmbH', 'phone_number__1': "'+4962159575430", 'additional_info__1': '"{\\"Company Name\\": \\"HCL-Logistics GmbH\\", \\"Original_Number\\": \\"\'+49 621 59575430\\", \\"URL\\": \\"http://www.hcl-logistics.de\\", \\"is_ ... (4817 characters truncated) ... odel is clear, but the target customer segments are not explicitly stated.\\", \\"Original Row Number\\": 1166.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__1': True, 'customer_target_segments__1': None, 'url__2': 'http://www.trevisto.de', 'profile_id__2': 16, 'industry__2': 'Data Analytics & AI Consulting', 'company_name__2': 'Trevisto AG', 'phone_number__2': "'+4991143083900", 'additional_info__2': '"{\\"Company Name\\": \\"Trevisto AG\\", \\"Original_Number\\": \\"\'+49 911 43083900\\", \\"URL\\": \\"http://www.trevisto.de\\", \\"is_b2b\\": \\"Y ... (5302 characters truncated) ...  The target audience is somewhat specific (food retail for some services).\\", \\"Original Row Number\\": 1167.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__2': True, 'customer_target_segments__2': 'Food retail sector', 'url__3': 'http://www.adsoul.com', 'profile_id__3': 16, 'industry__3': 'Search Engine Marketing (SEM)', 'company_name__3': 'adSoul GmbH', 'phone_number__3': "'+4940228671870", 'additional_info__3': '"{\\"Company Name\\": \\"adSoul GmbH\\", \\"Original_Number\\": \\"\'+49 40 228671870\\", \\"URL\\": \\"http://www.adsoul.com\\", \\"is_b2b\\": \\"Ye ... (4517 characters truncated) ... business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 1168.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__3': True, 'customer_target_segments__3': 'E-commerce companies with complex requirements; Understaffed marketing departments', 'url__4': 'http://www.tomspike.com', 'profile_id__4': 16, 'industry__4': 'Innovation Consultancy', 'company_name__4': 'TOM SPIKE - Structured innovation', 'phone_number__4': "'+493089647209", 'additional_info__4': '"{\\"Company Name\\": \\"TOM SPIKE - Structured innovation\\", \\"Original_Number\\": \\"\'+49 30 89647209\\", \\"URL\\": \\"http://www.tomspike.com\ ... (5293 characters truncated) ...  business model and target audience are reasonably clear from the summary.\\", \\"Original Row Number\\": 1169.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__4': True, 'customer_target_segments__4': 'Ambitious businesses; Companies in Automotive & Mobility; Companies in Mechanical and Plant Engineering; Companies in Plastics & Chemistry; Companies in Finance & Banking', 'url__5': 'http://www.embassyofmusic.de', 'profile_id__5': 16, 'industry__5': 'Music', 'company_name__5': 'Embassy Of Music GmbH', 'phone_number__5': "'+4930616220", 'additional_info__5': '"{\\"Company Name\\": \\"Embassy Of Music GmbH\\", \\"Original_Number\\": \\"\'+49 30 616220\\", \\"URL\\": \\"http://www.embassyofmusic.de\\", \\"is ... (1329 characters truncated) ... y Notes\\": \\"The business model is clear, but the target group is broad.\\", \\"Original Row Number\\": 1170.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__5': True, 'customer_target_segments__5': 'Music listeners; Fans of their artists', 'url__6': 'http://www.degerenergie.de', 'profile_id__6': 16 ... 7900 parameters truncated ... 'is_b2b__993': True, 'customer_target_segments__993': 'Universities; Higher education institutions', 'url__994': 'http://www.minnt.com', 'profile_id__994': 16, 'industry__994': 'Software Development', 'company_name__994': 'Minnt GmbH', 'phone_number__994': "'+4989904238110", 'additional_info__994': '"{\\"Company Name\\": \\"Minnt GmbH\\", \\"Original_Number\\": \\"\'+49 89 904238110\\", \\"URL\\": \\"http://www.minnt.com\\", \\"is_b2b\\": \\"Yes\ ... (5006 characters truncated) ... s offered are clearly communicated. The target audience is somewhat broad.\\", \\"Original Row Number\\": 2313.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__994': True, 'customer_target_segments__994': 'Internet of Things (IoT); mCommerce; Social communities and networking; Digital transformation', 'url__995': 'http://www.netcom-kassel.de', 'profile_id__995': 16, 'industry__995': 'Telecommunications', 'company_name__995': 'Netcom Kassel Gesellschaft für Telekommunikation mbH', 'phone_number__995': "'+495619202020", 'additional_info__995': '"{\\"Company Name\\": \\"Netcom Kassel Gesellschaft f\\\\u00fcr Telekommunikation mbH\\", \\"Original_Number\\": \\"\'+49 561 9202020\\", \\"URL\\":  ... (1657 characters truncated) ... arly articulated. The target audience is broad (residential and business).\\", \\"Original Row Number\\": 2314.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__995': True, 'customer_target_segments__995': 'Residential customers; Business customers', 'url__996': 'http://www.vogel-detambel.de', 'profile_id__996': 16, 'industry__996': 'Consultancy', 'company_name__996': 'Vogel & Detambel', 'phone_number__996': "'+49611371321", 'additional_info__996': '"{\\"Company Name\\": \\"Vogel & Detambel\\", \\"Original_Number\\": \\"\'+49 611 371321\\", \\"URL\\": \\"http://www.vogel-detambel.de\\", \\"is_b2b ... (4557 characters truncated) ...  \\"Business model and target group are reasonably clear from the summary.\\", \\"Original Row Number\\": 2315.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__996': True, 'customer_target_segments__996': 'Top-level executives (starting from an annual salary of 160,000 Euros)', 'url__997': 'http://www.sti-training.com', 'profile_id__997': 16, 'industry__997': 'Aviation Security Training and Consulting', 'company_name__997': 'STI Security Training International GmbH', 'phone_number__997': "'+496145599910", 'additional_info__997': '"{\\"Company Name\\": \\"STI Security Training International GmbH\\", \\"Original_Number\\": \\"\'+49 614 5599910\\", \\"URL\\": \\"http://www.sti-tr ... (5476 characters truncated) ... business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 2317.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__997': True, 'customer_target_segments__997': 'Aviation sector; Industry sector; Critical infrastructure sector; Air carriers (ACC3); Known consignors (KC3); Regulated agents (RA3)', 'url__998': 'http://www.toneworx.com', 'profile_id__998': 16, 'industry__998': 'Audio and Video Production', 'company_name__998': 'toneworx Studios', 'phone_number__998': "'+49405148300", 'additional_info__998': '"{\\"Company Name\\": \\"toneworx Studios\\", \\"Original_Number\\": \\"\'+49 40 5148300\\", \\"URL\\": \\"http://www.toneworx.com\\", \\"is_b2b\\":  ... (3869 characters truncated) ...  \\"Business model and target group are reasonably clear from the summary.\\", \\"Original Row Number\\": 2318.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__998': True, 'customer_target_segments__998': 'Video games; Commercials; Films; Other media', 'url__999': 'http://www.thuellen.de', 'profile_id__999': 16, 'industry__999': 'Car Dealership', 'company_name__999': 'Auto Thüllen', 'phone_number__999': "'+4924194400", 'additional_info__999': '"{\\"Company Name\\": \\"Auto Th\\\\u00fcllen\\", \\"Original_Number\\": \\"\'+49 24 194400\\", \\"URL\\": \\"http://www.thuellen.de\\", \\"is_b2b\\" ... (1535 characters truncated) ... business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 2319.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__999': True, 'customer_target_segments__999': 'Private customers; Business customers'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-07 14:50:21,438 - ERROR - root - Failed to load data for SalesOutreachReport_20250705_081027_12000-16000.csv. Halting processing for this file. Error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "unique_phone_number"
DETAIL:  Key (phone_number)=('+49898931610) already exists.

[SQL: INSERT INTO contacts (company_name, url, phone_number, industry, is_b2b, customer_target_segments, additional_info, profile_id) VALUES (%(company_name__0)s, %(url__0)s, %(phone_number__0)s, %(industry__0)s, %(is_b2b__0)s, %(customer_target_segments__ ... 185903 characters truncated ... b2b__999)s, %(customer_target_segments__999)s, %(additional_info__999)s::JSONB, %(profile_id__999)s)]
[parameters: {'url__0': 'http://www.alu-hofstaetter.at', 'profile_id__0': 16, 'industry__0': 'Metal Construction', 'company_name__0': 'Alu Hofstätter GmbH', 'phone_number__0': "'+43333851131", 'additional_info__0': '"{\\"Company Name\\": \\"Alu Hofst\\\\u00e4tter GmbH\\", \\"Original_Number\\": \\"\'+43 333 851131\\", \\"URL\\": \\"http://www.alu-hofstaetter.at\\ ... (1969 characters truncated) ... The summary provides a good overview of the products and services offered.\\", \\"Original Row Number\\": 1165.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__0': True, 'customer_target_segments__0': None, 'url__1': 'http://www.hcl-logistics.de', 'profile_id__1': 16, 'industry__1': 'Logistics', 'company_name__1': 'HCL-Logistics GmbH', 'phone_number__1': "'+4962159575430", 'additional_info__1': '"{\\"Company Name\\": \\"HCL-Logistics GmbH\\", \\"Original_Number\\": \\"\'+49 621 59575430\\", \\"URL\\": \\"http://www.hcl-logistics.de\\", \\"is_ ... (4817 characters truncated) ... odel is clear, but the target customer segments are not explicitly stated.\\", \\"Original Row Number\\": 1166.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__1': True, 'customer_target_segments__1': None, 'url__2': 'http://www.trevisto.de', 'profile_id__2': 16, 'industry__2': 'Data Analytics & AI Consulting', 'company_name__2': 'Trevisto AG', 'phone_number__2': "'+4991143083900", 'additional_info__2': '"{\\"Company Name\\": \\"Trevisto AG\\", \\"Original_Number\\": \\"\'+49 911 43083900\\", \\"URL\\": \\"http://www.trevisto.de\\", \\"is_b2b\\": \\"Y ... (5302 characters truncated) ...  The target audience is somewhat specific (food retail for some services).\\", \\"Original Row Number\\": 1167.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__2': True, 'customer_target_segments__2': 'Food retail sector', 'url__3': 'http://www.adsoul.com', 'profile_id__3': 16, 'industry__3': 'Search Engine Marketing (SEM)', 'company_name__3': 'adSoul GmbH', 'phone_number__3': "'+4940228671870", 'additional_info__3': '"{\\"Company Name\\": \\"adSoul GmbH\\", \\"Original_Number\\": \\"\'+49 40 228671870\\", \\"URL\\": \\"http://www.adsoul.com\\", \\"is_b2b\\": \\"Ye ... (4517 characters truncated) ... business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 1168.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__3': True, 'customer_target_segments__3': 'E-commerce companies with complex requirements; Understaffed marketing departments', 'url__4': 'http://www.tomspike.com', 'profile_id__4': 16, 'industry__4': 'Innovation Consultancy', 'company_name__4': 'TOM SPIKE - Structured innovation', 'phone_number__4': "'+493089647209", 'additional_info__4': '"{\\"Company Name\\": \\"TOM SPIKE - Structured innovation\\", \\"Original_Number\\": \\"\'+49 30 89647209\\", \\"URL\\": \\"http://www.tomspike.com\ ... (5293 characters truncated) ...  business model and target audience are reasonably clear from the summary.\\", \\"Original Row Number\\": 1169.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__4': True, 'customer_target_segments__4': 'Ambitious businesses; Companies in Automotive & Mobility; Companies in Mechanical and Plant Engineering; Companies in Plastics & Chemistry; Companies in Finance & Banking', 'url__5': 'http://www.embassyofmusic.de', 'profile_id__5': 16, 'industry__5': 'Music', 'company_name__5': 'Embassy Of Music GmbH', 'phone_number__5': "'+4930616220", 'additional_info__5': '"{\\"Company Name\\": \\"Embassy Of Music GmbH\\", \\"Original_Number\\": \\"\'+49 30 616220\\", \\"URL\\": \\"http://www.embassyofmusic.de\\", \\"is ... (1329 characters truncated) ... y Notes\\": \\"The business model is clear, but the target group is broad.\\", \\"Original Row Number\\": 1170.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__5': True, 'customer_target_segments__5': 'Music listeners; Fans of their artists', 'url__6': 'http://www.degerenergie.de', 'profile_id__6': 16 ... 7900 parameters truncated ... 'is_b2b__993': True, 'customer_target_segments__993': 'Universities; Higher education institutions', 'url__994': 'http://www.minnt.com', 'profile_id__994': 16, 'industry__994': 'Software Development', 'company_name__994': 'Minnt GmbH', 'phone_number__994': "'+4989904238110", 'additional_info__994': '"{\\"Company Name\\": \\"Minnt GmbH\\", \\"Original_Number\\": \\"\'+49 89 904238110\\", \\"URL\\": \\"http://www.minnt.com\\", \\"is_b2b\\": \\"Yes\ ... (5006 characters truncated) ... s offered are clearly communicated. The target audience is somewhat broad.\\", \\"Original Row Number\\": 2313.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__994': True, 'customer_target_segments__994': 'Internet of Things (IoT); mCommerce; Social communities and networking; Digital transformation', 'url__995': 'http://www.netcom-kassel.de', 'profile_id__995': 16, 'industry__995': 'Telecommunications', 'company_name__995': 'Netcom Kassel Gesellschaft für Telekommunikation mbH', 'phone_number__995': "'+495619202020", 'additional_info__995': '"{\\"Company Name\\": \\"Netcom Kassel Gesellschaft f\\\\u00fcr Telekommunikation mbH\\", \\"Original_Number\\": \\"\'+49 561 9202020\\", \\"URL\\":  ... (1657 characters truncated) ... arly articulated. The target audience is broad (residential and business).\\", \\"Original Row Number\\": 2314.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__995': True, 'customer_target_segments__995': 'Residential customers; Business customers', 'url__996': 'http://www.vogel-detambel.de', 'profile_id__996': 16, 'industry__996': 'Consultancy', 'company_name__996': 'Vogel & Detambel', 'phone_number__996': "'+49611371321", 'additional_info__996': '"{\\"Company Name\\": \\"Vogel & Detambel\\", \\"Original_Number\\": \\"\'+49 611 371321\\", \\"URL\\": \\"http://www.vogel-detambel.de\\", \\"is_b2b ... (4557 characters truncated) ...  \\"Business model and target group are reasonably clear from the summary.\\", \\"Original Row Number\\": 2315.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__996': True, 'customer_target_segments__996': 'Top-level executives (starting from an annual salary of 160,000 Euros)', 'url__997': 'http://www.sti-training.com', 'profile_id__997': 16, 'industry__997': 'Aviation Security Training and Consulting', 'company_name__997': 'STI Security Training International GmbH', 'phone_number__997': "'+496145599910", 'additional_info__997': '"{\\"Company Name\\": \\"STI Security Training International GmbH\\", \\"Original_Number\\": \\"\'+49 614 5599910\\", \\"URL\\": \\"http://www.sti-tr ... (5476 characters truncated) ... business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 2317.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__997': True, 'customer_target_segments__997': 'Aviation sector; Industry sector; Critical infrastructure sector; Air carriers (ACC3); Known consignors (KC3); Regulated agents (RA3)', 'url__998': 'http://www.toneworx.com', 'profile_id__998': 16, 'industry__998': 'Audio and Video Production', 'company_name__998': 'toneworx Studios', 'phone_number__998': "'+49405148300", 'additional_info__998': '"{\\"Company Name\\": \\"toneworx Studios\\", \\"Original_Number\\": \\"\'+49 40 5148300\\", \\"URL\\": \\"http://www.toneworx.com\\", \\"is_b2b\\":  ... (3869 characters truncated) ...  \\"Business model and target group are reasonably clear from the summary.\\", \\"Original Row Number\\": 2318.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__998': True, 'customer_target_segments__998': 'Video games; Commercials; Films; Other media', 'url__999': 'http://www.thuellen.de', 'profile_id__999': 16, 'industry__999': 'Car Dealership', 'company_name__999': 'Auto Thüllen', 'phone_number__999': "'+4924194400", 'additional_info__999': '"{\\"Company Name\\": \\"Auto Th\\\\u00fcllen\\", \\"Original_Number\\": \\"\'+49 24 194400\\", \\"URL\\": \\"http://www.thuellen.de\\", \\"is_b2b\\" ... (1535 characters truncated) ... business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 2319.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__999': True, 'customer_target_segments__999': 'Private customers; Business customers'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-07 14:50:21,439 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081050_16000-20000.csv ---
2025-07-07 14:50:21,439 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081050_16000-20000.csv...
2025-07-07 14:50:21,666 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_081050_16000-20000.csv.
2025-07-07 14:50:21,669 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 14:50:21,676 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 14:50:21,845 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 14:50:21,847 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 14:50:21,853 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 14:50:21,908 - INFO - etl.scripts.transform - Saved 1382 duplicate rows to etl/dropped_duplicates\duplicates_20250707_145021.csv
2025-07-07 14:50:21,910 - INFO - etl.scripts.transform - Removed 1382 duplicate phone numbers from the source file.
2025-07-07 14:50:21,910 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 14:50:21,910 - INFO - root - Starting deduplication...
2025-07-07 14:50:21,912 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 14:50:22,019 - INFO - root - Deduplication complete. 2619 rows remaining for insertion.
2025-07-07 14:50:22,413 - INFO - etl.scripts.load - Found existing profile_id: 16 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 14:50:22,415 - INFO - etl.scripts.load - Loading 2619 rows with profile_id 16 into 'contacts' table...
2025-07-07 14:50:23,500 - ERROR - etl.scripts.load - Failed to load data into 'contacts': (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "unique_phone_number"
DETAIL:  Key (phone_number)=('+43557621566) already exists.

[SQL: INSERT INTO contacts (company_name, url, phone_number, industry, is_b2b, customer_target_segments, additional_info, profile_id) VALUES (%(company_name__0)s, %(url__0)s, %(phone_number__0)s, %(industry__0)s, %(is_b2b__0)s, %(customer_target_segments__ ... 185903 characters truncated ... b2b__999)s, %(customer_target_segments__999)s, %(additional_info__999)s::JSONB, %(profile_id__999)s)]
[parameters: {'url__0': 'http://www.faupel-pr.de', 'profile_id__0': 16, 'industry__0': 'Public Relations', 'company_name__0': 'FAUPEL COMMUNICATION GmbH', 'phone_number__0': "'+49211740050", 'additional_info__0': '"{\\"Company Name\\": \\"FAUPEL COMMUNICATION GmbH\\", \\"Original_Number\\": \\"\'+49 21 1740050\\", \\"URL\\": \\"http://www.faupel-pr.de\\", \\"is ... (3775 characters truncated) ... \\"Business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 2.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__0': True, 'customer_target_segments__0': 'Construction sector; Housing sector; Interior design sector', 'url__1': 'http://www.allesklar-sicherheitstechnik.de', 'profile_id__1': 16, 'industry__1': 'Locksmith Services', 'company_name__1': 'Alles Klar', 'phone_number__1': "'+494038688855", 'additional_info__1': '"{\\"Company Name\\": \\"Alles Klar\\", \\"Original_Number\\": \\"\'+49 40 38688855\\", \\"URL\\": \\"http://www.allesklar-sicherheitstechnik.de\\",  ... (1810 characters truncated) ... \\"Business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 3.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__1': True, 'customer_target_segments__1': 'Private clients; Commercial clients; Police; Fire department; Insurance companies; Financial authorities', 'url__2': 'http://www.familienzeit-gmbh.de', 'profile_id__2': 16, 'industry__2': 'Non-Profits / Associations (B2B)', 'company_name__2': 'Familienzeit', 'phone_number__2': None, 'additional_info__2': '"{\\"Company Name\\": \\"Familienzeit\\", \\"Original_Number\\": null, \\"URL\\": \\"http://www.familienzeit-gmbh.de\\", \\"is_b2b\\": \\"Yes\\", \\" ... (1008 characters truncated) ... null, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 4.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__2': True, 'customer_target_segments__2': None, 'url__3': 'http://www.mgh-ak.de', 'profile_id__3': 16, 'industry__3': 'Community Center / Social Services', 'company_name__3': 'Mittendrin', 'phone_number__3': "'+492681950438", 'additional_info__3': '"{\\"Company Name\\": \\"Mittendrin\\", \\"Original_Number\\": \\"\'+49 268 1950438\\", \\"URL\\": \\"http://www.mgh-ak.de\\", \\"is_b2b\\": \\"Yes\\ ... (4386 characters truncated) ... icates the center\'s purpose and offerings, but the target audience is broad.\\", \\"Original Row Number\\": 7.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__3': True, 'customer_target_segments__3': 'Multiple generations; Community members; Seniors', 'url__4': 'http://www.kj-marinesystems.com', 'profile_id__4': 16, 'industry__4': 'Shipbuilding and Marine Retrofitting', 'company_name__4': 'Knaack & Jahn Schiffbau GmbH', 'phone_number__4': "'+49407812930", 'additional_info__4': '"{\\"Company Name\\": \\"Knaack & Jahn Schiffbau GmbH\\", \\"Original_Number\\": \\"\'+49 40 7812930\\", \\"URL\\": \\"http://www.kj-marinesystems.co ... (1656 characters truncated) ... roup is not explicitly defined but inferred to be within the marine industry.\\", \\"Original Row Number\\": 8.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__4': True, 'customer_target_segments__4': None, 'url__5': 'http://www.farmaciadellago.ch', 'profile_id__5': 16, 'industry__5': 'Retail Sector (B2B)', 'company_name__5': 'Farmacia del Lago', 'phone_number__5': "'+41917432313", 'additional_info__5': '"{\\"Company Name\\": \\"Farmacia del Lago\\", \\"Original_Number\\": \\"\'+41 91 743 23 13\\", \\"URL\\": \\"http://www.farmaciadellago.ch\\", \\"is ... (1152 characters truncated) ... ull, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 13.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__5': False, 'customer_target_segments__5': None, 'url__6': 'http://www.pcs-weiterbildung.de', 'profile_id__6': 16 ... 7900 parameters truncated ... 'is_b2b__993': True, 'customer_target_segments__993': 'Customers of plant pots and accessories', 'url__994': 'http://www.gfs.de', 'profile_id__994': 16, 'industry__994': 'Fundraising', 'company_name__994': 'GFS Fundraising Solutions GmbH', 'phone_number__994': "'+492224918250", 'additional_info__994': '"{\\"Company Name\\": \\"GFS Fundraising Solutions GmbH\\", \\"Original_Number\\": \\"\'+49 222 4918250\\", \\"URL\\": \\"http://www.gfs.de\\", \\"is ... (3222 characters truncated) ...  target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 1561.0, \\"ScrapeStatus\\": \\"Used_Fallback_Description\\"}"', 'is_b2b__994': True, 'customer_target_segments__994': 'NGOs', 'url__995': 'http://www.zbits.de', 'profile_id__995': 16, 'industry__995': 'IT Services', 'company_name__995': 'zbits GmbH', 'phone_number__995': "'+4986699063990", 'additional_info__995': '"{\\"Company Name\\": \\"zbits GmbH\\", \\"Original_Number\\": \\"\'+49 86 699063990\\", \\"URL\\": \\"http://www.zbits.de\\", \\"is_b2b\\": \\"Yes\\ ... (5176 characters truncated) ...  business model and target audience are reasonably clear from the summary.\\", \\"Original Row Number\\": 1562.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__995': True, 'customer_target_segments__995': 'Healthcare; Industrial; Consulting; Finance; NGOs', 'url__996': 'http://www.top-mehrwert-logistik.de', 'profile_id__996': 16, 'industry__996': 'Logistics and Technology', 'company_name__996': 'TOP Mehrwert-Logistik GmbH & Co. KG', 'phone_number__996': "'+49402540002540", 'additional_info__996': '"{\\"Company Name\\": \\"TOP Mehrwert-Logistik GmbH & Co. KG\\", \\"Original_Number\\": \\"\'+49 40 2540002540\\", \\"URL\\": \\"http://www.top-mehrw ... (4945 characters truncated) ... d but is implied to be businesses needing logistics and technical support.\\", \\"Original Row Number\\": 1563.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__996': True, 'customer_target_segments__996': None, 'url__997': 'http://www.icf-muenchen.de', 'profile_id__997': 16, 'industry__997': 'Non-Profits / Associations (B2B)', 'company_name__997': 'ICF Munich eV', 'phone_number__997': "'+498959999620", 'additional_info__997': '"{\\"Company Name\\": \\"ICF Munich eV\\", \\"Original_Number\\": \\"\'+49 89 59999620\\", \\"URL\\": \\"http://www.icf-muenchen.de\\", \\"is_b2b\\": ... (1090 characters truncated) ... l, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 1564.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__997': False, 'customer_target_segments__997': None, 'url__998': 'http://www.block-menue.de', 'profile_id__998': 16, 'industry__998': 'Food Service', 'company_name__998': 'Block Menü GmbH (BLOCK GRUPPE Hamburg)', 'phone_number__998': "'+493885192100", 'additional_info__998': '"{\\"Company Name\\": \\"Block Men\\\\u00fc GmbH (BLOCK GRUPPE Hamburg)\\", \\"Original_Number\\": \\"\'+49 388 5192100\\", \\"URL\\": \\"http://www. ... (4336 characters truncated) ... business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 1565.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__998': True, 'customer_target_segments__998': 'Hotels; System gastronomy; Traditional restaurants; Catering services', 'url__999': 'http://www.felsenstein.org', 'profile_id__999': 16, 'industry__999': 'Non-Profits / Associations (B2B)', 'company_name__999': 'Fritz- Felsenstein- Haus e. V.', 'phone_number__999': "'+49823160040", 'additional_info__999': '"{\\"Company Name\\": \\"Fritz- Felsenstein- Haus e. V.\\", \\"Original_Number\\": \\"\'+49 82 3160040\\", \\"URL\\": \\"http://www.felsenstein.org\\ ... (733 characters truncated) ... l, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 1566.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__999': None, 'customer_target_segments__999': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-07 14:50:23,503 - ERROR - root - Failed to load data for SalesOutreachReport_20250705_081050_16000-20000.csv. Halting processing for this file. Error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "unique_phone_number"
DETAIL:  Key (phone_number)=('+43557621566) already exists.

[SQL: INSERT INTO contacts (company_name, url, phone_number, industry, is_b2b, customer_target_segments, additional_info, profile_id) VALUES (%(company_name__0)s, %(url__0)s, %(phone_number__0)s, %(industry__0)s, %(is_b2b__0)s, %(customer_target_segments__ ... 185903 characters truncated ... b2b__999)s, %(customer_target_segments__999)s, %(additional_info__999)s::JSONB, %(profile_id__999)s)]
[parameters: {'url__0': 'http://www.faupel-pr.de', 'profile_id__0': 16, 'industry__0': 'Public Relations', 'company_name__0': 'FAUPEL COMMUNICATION GmbH', 'phone_number__0': "'+49211740050", 'additional_info__0': '"{\\"Company Name\\": \\"FAUPEL COMMUNICATION GmbH\\", \\"Original_Number\\": \\"\'+49 21 1740050\\", \\"URL\\": \\"http://www.faupel-pr.de\\", \\"is ... (3775 characters truncated) ... \\"Business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 2.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__0': True, 'customer_target_segments__0': 'Construction sector; Housing sector; Interior design sector', 'url__1': 'http://www.allesklar-sicherheitstechnik.de', 'profile_id__1': 16, 'industry__1': 'Locksmith Services', 'company_name__1': 'Alles Klar', 'phone_number__1': "'+494038688855", 'additional_info__1': '"{\\"Company Name\\": \\"Alles Klar\\", \\"Original_Number\\": \\"\'+49 40 38688855\\", \\"URL\\": \\"http://www.allesklar-sicherheitstechnik.de\\",  ... (1810 characters truncated) ... \\"Business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 3.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__1': True, 'customer_target_segments__1': 'Private clients; Commercial clients; Police; Fire department; Insurance companies; Financial authorities', 'url__2': 'http://www.familienzeit-gmbh.de', 'profile_id__2': 16, 'industry__2': 'Non-Profits / Associations (B2B)', 'company_name__2': 'Familienzeit', 'phone_number__2': None, 'additional_info__2': '"{\\"Company Name\\": \\"Familienzeit\\", \\"Original_Number\\": null, \\"URL\\": \\"http://www.familienzeit-gmbh.de\\", \\"is_b2b\\": \\"Yes\\", \\" ... (1008 characters truncated) ... null, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 4.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__2': True, 'customer_target_segments__2': None, 'url__3': 'http://www.mgh-ak.de', 'profile_id__3': 16, 'industry__3': 'Community Center / Social Services', 'company_name__3': 'Mittendrin', 'phone_number__3': "'+492681950438", 'additional_info__3': '"{\\"Company Name\\": \\"Mittendrin\\", \\"Original_Number\\": \\"\'+49 268 1950438\\", \\"URL\\": \\"http://www.mgh-ak.de\\", \\"is_b2b\\": \\"Yes\\ ... (4386 characters truncated) ... icates the center\'s purpose and offerings, but the target audience is broad.\\", \\"Original Row Number\\": 7.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__3': True, 'customer_target_segments__3': 'Multiple generations; Community members; Seniors', 'url__4': 'http://www.kj-marinesystems.com', 'profile_id__4': 16, 'industry__4': 'Shipbuilding and Marine Retrofitting', 'company_name__4': 'Knaack & Jahn Schiffbau GmbH', 'phone_number__4': "'+49407812930", 'additional_info__4': '"{\\"Company Name\\": \\"Knaack & Jahn Schiffbau GmbH\\", \\"Original_Number\\": \\"\'+49 40 7812930\\", \\"URL\\": \\"http://www.kj-marinesystems.co ... (1656 characters truncated) ... roup is not explicitly defined but inferred to be within the marine industry.\\", \\"Original Row Number\\": 8.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__4': True, 'customer_target_segments__4': None, 'url__5': 'http://www.farmaciadellago.ch', 'profile_id__5': 16, 'industry__5': 'Retail Sector (B2B)', 'company_name__5': 'Farmacia del Lago', 'phone_number__5': "'+41917432313", 'additional_info__5': '"{\\"Company Name\\": \\"Farmacia del Lago\\", \\"Original_Number\\": \\"\'+41 91 743 23 13\\", \\"URL\\": \\"http://www.farmaciadellago.ch\\", \\"is ... (1152 characters truncated) ... ull, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 13.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__5': False, 'customer_target_segments__5': None, 'url__6': 'http://www.pcs-weiterbildung.de', 'profile_id__6': 16 ... 7900 parameters truncated ... 'is_b2b__993': True, 'customer_target_segments__993': 'Customers of plant pots and accessories', 'url__994': 'http://www.gfs.de', 'profile_id__994': 16, 'industry__994': 'Fundraising', 'company_name__994': 'GFS Fundraising Solutions GmbH', 'phone_number__994': "'+492224918250", 'additional_info__994': '"{\\"Company Name\\": \\"GFS Fundraising Solutions GmbH\\", \\"Original_Number\\": \\"\'+49 222 4918250\\", \\"URL\\": \\"http://www.gfs.de\\", \\"is ... (3222 characters truncated) ...  target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 1561.0, \\"ScrapeStatus\\": \\"Used_Fallback_Description\\"}"', 'is_b2b__994': True, 'customer_target_segments__994': 'NGOs', 'url__995': 'http://www.zbits.de', 'profile_id__995': 16, 'industry__995': 'IT Services', 'company_name__995': 'zbits GmbH', 'phone_number__995': "'+4986699063990", 'additional_info__995': '"{\\"Company Name\\": \\"zbits GmbH\\", \\"Original_Number\\": \\"\'+49 86 699063990\\", \\"URL\\": \\"http://www.zbits.de\\", \\"is_b2b\\": \\"Yes\\ ... (5176 characters truncated) ...  business model and target audience are reasonably clear from the summary.\\", \\"Original Row Number\\": 1562.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__995': True, 'customer_target_segments__995': 'Healthcare; Industrial; Consulting; Finance; NGOs', 'url__996': 'http://www.top-mehrwert-logistik.de', 'profile_id__996': 16, 'industry__996': 'Logistics and Technology', 'company_name__996': 'TOP Mehrwert-Logistik GmbH & Co. KG', 'phone_number__996': "'+49402540002540", 'additional_info__996': '"{\\"Company Name\\": \\"TOP Mehrwert-Logistik GmbH & Co. KG\\", \\"Original_Number\\": \\"\'+49 40 2540002540\\", \\"URL\\": \\"http://www.top-mehrw ... (4945 characters truncated) ... d but is implied to be businesses needing logistics and technical support.\\", \\"Original Row Number\\": 1563.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__996': True, 'customer_target_segments__996': None, 'url__997': 'http://www.icf-muenchen.de', 'profile_id__997': 16, 'industry__997': 'Non-Profits / Associations (B2B)', 'company_name__997': 'ICF Munich eV', 'phone_number__997': "'+498959999620", 'additional_info__997': '"{\\"Company Name\\": \\"ICF Munich eV\\", \\"Original_Number\\": \\"\'+49 89 59999620\\", \\"URL\\": \\"http://www.icf-muenchen.de\\", \\"is_b2b\\": ... (1090 characters truncated) ... l, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 1564.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__997': False, 'customer_target_segments__997': None, 'url__998': 'http://www.block-menue.de', 'profile_id__998': 16, 'industry__998': 'Food Service', 'company_name__998': 'Block Menü GmbH (BLOCK GRUPPE Hamburg)', 'phone_number__998': "'+493885192100", 'additional_info__998': '"{\\"Company Name\\": \\"Block Men\\\\u00fc GmbH (BLOCK GRUPPE Hamburg)\\", \\"Original_Number\\": \\"\'+49 388 5192100\\", \\"URL\\": \\"http://www. ... (4336 characters truncated) ... business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 1565.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__998': True, 'customer_target_segments__998': 'Hotels; System gastronomy; Traditional restaurants; Catering services', 'url__999': 'http://www.felsenstein.org', 'profile_id__999': 16, 'industry__999': 'Non-Profits / Associations (B2B)', 'company_name__999': 'Fritz- Felsenstein- Haus e. V.', 'phone_number__999': "'+49823160040", 'additional_info__999': '"{\\"Company Name\\": \\"Fritz- Felsenstein- Haus e. V.\\", \\"Original_Number\\": \\"\'+49 82 3160040\\", \\"URL\\": \\"http://www.felsenstein.org\\ ... (733 characters truncated) ... l, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 1566.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__999': None, 'customer_target_segments__999': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-07 14:50:23,504 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081114_20000-24000.csv ---
2025-07-07 14:50:23,505 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081114_20000-24000.csv...
2025-07-07 14:50:23,534 - INFO - etl.scripts.extract - Successfully extracted 1 rows from SalesOutreachReport_20250705_081114_20000-24000.csv.
2025-07-07 14:50:23,535 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 14:50:23,536 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 14:50:23,542 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 14:50:23,543 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 14:50:23,544 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 14:50:23,546 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 14:50:23,547 - INFO - root - Starting deduplication...
2025-07-07 14:50:23,547 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 14:50:23,548 - INFO - root - Deduplication complete. 1 rows remaining for insertion.
2025-07-07 14:50:23,881 - INFO - etl.scripts.load - Found existing profile_id: 16 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 14:50:23,882 - INFO - etl.scripts.load - Loading 1 rows with profile_id 16 into 'contacts' table...
2025-07-07 14:50:24,170 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 14:50:24,171 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SalesOutreachReport_20250705_081114_20000-24000.csv
2025-07-07 14:50:24,172 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081134_24000-28000.csv ---
2025-07-07 14:50:24,172 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081134_24000-28000.csv...
2025-07-07 14:50:24,284 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_081134_24000-28000.csv.
2025-07-07 14:50:24,284 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 14:50:24,292 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 14:50:24,454 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 14:50:24,457 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 14:50:24,462 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 14:50:24,519 - INFO - etl.scripts.transform - Saved 1586 duplicate rows to etl/dropped_duplicates\duplicates_20250707_145024.csv
2025-07-07 14:50:24,521 - INFO - etl.scripts.transform - Removed 1586 duplicate phone numbers from the source file.
2025-07-07 14:50:24,521 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 14:50:24,522 - INFO - root - Starting deduplication...
2025-07-07 14:50:24,523 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 14:50:24,620 - INFO - root - Deduplication complete. 2415 rows remaining for insertion.
2025-07-07 14:50:24,979 - INFO - etl.scripts.load - Found existing profile_id: 16 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 14:50:24,979 - INFO - etl.scripts.load - Loading 2415 rows with profile_id 16 into 'contacts' table...
2025-07-07 14:50:26,197 - ERROR - etl.scripts.load - Failed to load data into 'contacts': (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "unique_phone_number"
DETAIL:  Key (phone_number)=('+49742594990) already exists.

[SQL: INSERT INTO contacts (company_name, url, phone_number, industry, is_b2b, customer_target_segments, additional_info, profile_id) VALUES (%(company_name__0)s, %(url__0)s, %(phone_number__0)s, %(industry__0)s, %(is_b2b__0)s, %(customer_target_segments__ ... 185903 characters truncated ... b2b__999)s, %(customer_target_segments__999)s, %(additional_info__999)s::JSONB, %(profile_id__999)s)]
[parameters: {'url__0': 'http://www.ec-testlab.de', 'profile_id__0': 16, 'industry__0': 'Electromagnetic Compatibility (EMC) Testing', 'company_name__0': 'E&C Testlab GmbH', 'phone_number__0': "'+49742594990", 'additional_info__0': '"{\\"Company Name\\": \\"E&C Testlab GmbH\\", \\"Original_Number\\": \\"\'+49 7425 94990\\", \\"URL\\": \\"http://www.ec-testlab.de\\", \\"is_b2b\\": ... (1431 characters truncated) ... el is clear, but the target group is not explicitly stated.\\", \\"Original Row Number\\": 2.0, \\"ScrapeStatus\\": \\"Used_Fallback_Description\\"}"', 'is_b2b__0': True, 'customer_target_segments__0': None, 'url__1': 'http://www.ps-regensdorf.ch', 'profile_id__1': 16, 'industry__1': 'EdTech / E-Learning', 'company_name__1': 'Primarschule Regensdorf', 'phone_number__1': "'+41433438500", 'additional_info__1': '"{\\"Company Name\\": \\"Primarschule Regensdorf\\", \\"Original_Number\\": \\"\'+41 43 343 85 00\\", \\"URL\\": \\"http://www.ps-regensdorf.ch\\", \ ... (1287 characters truncated) ... null, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 3.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__1': False, 'customer_target_segments__1': None, 'url__2': 'http://www.sn-group.de', 'profile_id__2': 16, 'industry__2': 'IT Services and Consulting', 'company_name__2': 'S&N Group AG', 'phone_number__2': "'+49525115810", 'additional_info__2': '"{\\"Company Name\\": \\"S&N Group AG\\", \\"Original_Number\\": \\"\'+49 525 115810\\", \\"URL\\": \\"http://www.sn-group.de\\", \\"is_b2b\\": \\"Ye ... (5799 characters truncated) ... arget audience is broad, including users, customers, partners, and employees.\\", \\"Original Row Number\\": 4.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__2': True, 'customer_target_segments__2': 'Users; Customers; Partners; Employees', 'url__3': 'http://www.sieberconsult.eu', 'profile_id__3': 16, 'industry__3': 'Construction Planning', 'company_name__3': 'Sieber Consult GmbH', 'phone_number__3': "'+498382274050", 'additional_info__3': '"{\\"Company Name\\": \\"Sieber Consult GmbH\\", \\"Original_Number\\": \\"\'+49 83 82274050\\", \\"URL\\": \\"http://www.sieberconsult.eu\\", \\"is_ ... (4373 characters truncated) ... are clearly articulated. Target audience is implied through project examples.\\", \\"Original Row Number\\": 5.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__3': True, 'customer_target_segments__3': 'Agri-Photovoltaic systems developers; Residential area developers; Commercial development companies', 'url__4': 'http://www.hotelalpes.ch', 'profile_id__4': 16, 'industry__4': 'Digital Marketing Agency / Web Development', 'company_name__4': 'Biggie Switzerland', 'phone_number__4': "'+41227312200", 'additional_info__4': '"{\\"Company Name\\": \\"Biggie Switzerland\\", \\"Original_Number\\": \\"\'+41 22 731 22 00\\", \\"URL\\": \\"http://www.hotelalpes.ch\\", \\"is_b2b ... (1004 characters truncated) ... null, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 6.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__4': False, 'customer_target_segments__4': None, 'url__5': 'http://www.claus-gmbh.de', 'profile_id__5': 16, 'industry__5': 'Wholesale of Organic and Health Food Products', 'company_name__5': 'Claus Reformwaren Service Team GmbH', 'phone_number__5': "'+49722150960", 'additional_info__5': '"{\\"Company Name\\": \\"Claus Reformwaren Service Team GmbH\\", \\"Original_Number\\": \\"\'+49 7221 50960\\", \\"URL\\": \\"http://www.claus-gmbh.d ... (1956 characters truncated) ... he business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 7.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__5': True, 'customer_target_segments__5': 'Reformhaus stores (health food stores); Bioläden (organic food stores)', 'url__6': 'http://www.arigo.de', 'profile_id__6': 16 ... 7900 parameters truncated ... 'is_b2b__993': True, 'customer_target_segments__993': 'Schools; Universities; Students; Teachers', 'url__994': 'http://www.crottet.ch', 'profile_id__994': 16, 'industry__994': 'Electrical Engineering', 'company_name__994': 'Crottet', 'phone_number__994': "'+41264929090", 'additional_info__994': '"{\\"Company Name\\": \\"Crottet\\", \\"Original_Number\\": \\"\'+41 26 492 90 90\\", \\"URL\\": \\"http://www.crottet.ch\\", \\"is_b2b\\": \\"Yes\\" ... (4323 characters truncated) ...  clearly communicated. Target group is broad (residential and commercial).\\", \\"Original Row Number\\": 2208.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__994': True, 'customer_target_segments__994': 'Residential customers; Commercial customers', 'url__995': 'http://www.mkg-praxis-ingolstadt.de', 'profile_id__995': 16, 'industry__995': 'Healthcare Services', 'company_name__995': 'MKG Praxis', 'phone_number__995': "'+4984195679000", 'additional_info__995': '"{\\"Company Name\\": \\"MKG Praxis\\", \\"Original_Number\\": \\"\'+49 841 95679000\\", \\"URL\\": \\"http://www.mkg-praxis-ingolstadt.de\\", \\"is_ ... (1044 characters truncated) ... l, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 2211.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__995': True, 'customer_target_segments__995': None, 'url__996': 'http://www.koelnkitas.de', 'profile_id__996': 16, 'industry__996': 'EdTech / E-Learning', 'company_name__996': 'Köln Kitas', 'phone_number__996': "'+4922154600200", 'additional_info__996': '"{\\"Company Name\\": \\"K\\\\u00f6ln Kitas\\", \\"Original_Number\\": \\"\'+49 221 54600200\\", \\"URL\\": \\"http://www.koelnkitas.de\\", \\"is_b2b ... (1244 characters truncated) ... l, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 2217.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__996': False, 'customer_target_segments__996': None, 'url__997': 'http://www.seepferdchen-kita.de', 'profile_id__997': 16, 'industry__997': 'Childcare', 'company_name__997': 'SEEPFERDCHEN KITA GMBH', 'phone_number__997': "'+4971166721800", 'additional_info__997': '"{\\"Company Name\\": \\"SEEPFERDCHEN KITA GMBH\\", \\"Original_Number\\": \\"\'+49 711 66721800\\", \\"URL\\": \\"http://www.seepferdchen-kita.de\\" ... (1471 characters truncated) ... business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 2219.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__997': True, 'customer_target_segments__997': 'Parents of children under 3 years old; Parents of kindergarten children', 'url__998': 'http://www.drklvnds.de', 'profile_id__998': 16, 'industry__998': 'Humanitarian Aid', 'company_name__998': 'DRK Landesverband Niedersachsen e.V.', 'phone_number__998': "'+0800365000", 'additional_info__998': '"{\\"Company Name\\": \\"DRK Landesverband Niedersachsen e.V.\\", \\"Original_Number\\": \\"\'+0800365000\\", \\"URL\\": \\"http://www.drklvnds.de\\" ... (4992 characters truncated) ... odel and services are clearly communicated, but the target group is broad.\\", \\"Original Row Number\\": 2221.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__998': True, 'customer_target_segments__998': 'People in need; Youth; Vulnerable populations; Schools', 'url__999': 'http://www.schaeffler-digital-solutions.de', 'profile_id__999': 16, 'industry__999': 'Digital Solutions for Industrial Applications', 'company_name__999': 'Schaeffler Digital Solutions GmbH', 'phone_number__999': "'+499132824440", 'additional_info__999': '"{\\"Company Name\\": \\"Schaeffler Digital Solutions GmbH\\", \\"Original_Number\\": \\"\'+49 91 32824440\\", \\"URL\\": \\"http://www.schaeffler-di ... (5141 characters truncated) ... get audience is broadly defined as industries requiring digital solutions.\\", \\"Original Row Number\\": 2223.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__999': True, 'customer_target_segments__999': 'Industries requiring digital solutions'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-07 14:50:26,200 - ERROR - root - Failed to load data for SalesOutreachReport_20250705_081134_24000-28000.csv. Halting processing for this file. Error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "unique_phone_number"
DETAIL:  Key (phone_number)=('+49742594990) already exists.

[SQL: INSERT INTO contacts (company_name, url, phone_number, industry, is_b2b, customer_target_segments, additional_info, profile_id) VALUES (%(company_name__0)s, %(url__0)s, %(phone_number__0)s, %(industry__0)s, %(is_b2b__0)s, %(customer_target_segments__ ... 185903 characters truncated ... b2b__999)s, %(customer_target_segments__999)s, %(additional_info__999)s::JSONB, %(profile_id__999)s)]
[parameters: {'url__0': 'http://www.ec-testlab.de', 'profile_id__0': 16, 'industry__0': 'Electromagnetic Compatibility (EMC) Testing', 'company_name__0': 'E&C Testlab GmbH', 'phone_number__0': "'+49742594990", 'additional_info__0': '"{\\"Company Name\\": \\"E&C Testlab GmbH\\", \\"Original_Number\\": \\"\'+49 7425 94990\\", \\"URL\\": \\"http://www.ec-testlab.de\\", \\"is_b2b\\": ... (1431 characters truncated) ... el is clear, but the target group is not explicitly stated.\\", \\"Original Row Number\\": 2.0, \\"ScrapeStatus\\": \\"Used_Fallback_Description\\"}"', 'is_b2b__0': True, 'customer_target_segments__0': None, 'url__1': 'http://www.ps-regensdorf.ch', 'profile_id__1': 16, 'industry__1': 'EdTech / E-Learning', 'company_name__1': 'Primarschule Regensdorf', 'phone_number__1': "'+41433438500", 'additional_info__1': '"{\\"Company Name\\": \\"Primarschule Regensdorf\\", \\"Original_Number\\": \\"\'+41 43 343 85 00\\", \\"URL\\": \\"http://www.ps-regensdorf.ch\\", \ ... (1287 characters truncated) ... null, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 3.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__1': False, 'customer_target_segments__1': None, 'url__2': 'http://www.sn-group.de', 'profile_id__2': 16, 'industry__2': 'IT Services and Consulting', 'company_name__2': 'S&N Group AG', 'phone_number__2': "'+49525115810", 'additional_info__2': '"{\\"Company Name\\": \\"S&N Group AG\\", \\"Original_Number\\": \\"\'+49 525 115810\\", \\"URL\\": \\"http://www.sn-group.de\\", \\"is_b2b\\": \\"Ye ... (5799 characters truncated) ... arget audience is broad, including users, customers, partners, and employees.\\", \\"Original Row Number\\": 4.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__2': True, 'customer_target_segments__2': 'Users; Customers; Partners; Employees', 'url__3': 'http://www.sieberconsult.eu', 'profile_id__3': 16, 'industry__3': 'Construction Planning', 'company_name__3': 'Sieber Consult GmbH', 'phone_number__3': "'+498382274050", 'additional_info__3': '"{\\"Company Name\\": \\"Sieber Consult GmbH\\", \\"Original_Number\\": \\"\'+49 83 82274050\\", \\"URL\\": \\"http://www.sieberconsult.eu\\", \\"is_ ... (4373 characters truncated) ... are clearly articulated. Target audience is implied through project examples.\\", \\"Original Row Number\\": 5.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__3': True, 'customer_target_segments__3': 'Agri-Photovoltaic systems developers; Residential area developers; Commercial development companies', 'url__4': 'http://www.hotelalpes.ch', 'profile_id__4': 16, 'industry__4': 'Digital Marketing Agency / Web Development', 'company_name__4': 'Biggie Switzerland', 'phone_number__4': "'+41227312200", 'additional_info__4': '"{\\"Company Name\\": \\"Biggie Switzerland\\", \\"Original_Number\\": \\"\'+41 22 731 22 00\\", \\"URL\\": \\"http://www.hotelalpes.ch\\", \\"is_b2b ... (1004 characters truncated) ... null, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 6.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__4': False, 'customer_target_segments__4': None, 'url__5': 'http://www.claus-gmbh.de', 'profile_id__5': 16, 'industry__5': 'Wholesale of Organic and Health Food Products', 'company_name__5': 'Claus Reformwaren Service Team GmbH', 'phone_number__5': "'+49722150960", 'additional_info__5': '"{\\"Company Name\\": \\"Claus Reformwaren Service Team GmbH\\", \\"Original_Number\\": \\"\'+49 7221 50960\\", \\"URL\\": \\"http://www.claus-gmbh.d ... (1956 characters truncated) ... he business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 7.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__5': True, 'customer_target_segments__5': 'Reformhaus stores (health food stores); Bioläden (organic food stores)', 'url__6': 'http://www.arigo.de', 'profile_id__6': 16 ... 7900 parameters truncated ... 'is_b2b__993': True, 'customer_target_segments__993': 'Schools; Universities; Students; Teachers', 'url__994': 'http://www.crottet.ch', 'profile_id__994': 16, 'industry__994': 'Electrical Engineering', 'company_name__994': 'Crottet', 'phone_number__994': "'+41264929090", 'additional_info__994': '"{\\"Company Name\\": \\"Crottet\\", \\"Original_Number\\": \\"\'+41 26 492 90 90\\", \\"URL\\": \\"http://www.crottet.ch\\", \\"is_b2b\\": \\"Yes\\" ... (4323 characters truncated) ...  clearly communicated. Target group is broad (residential and commercial).\\", \\"Original Row Number\\": 2208.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__994': True, 'customer_target_segments__994': 'Residential customers; Commercial customers', 'url__995': 'http://www.mkg-praxis-ingolstadt.de', 'profile_id__995': 16, 'industry__995': 'Healthcare Services', 'company_name__995': 'MKG Praxis', 'phone_number__995': "'+4984195679000", 'additional_info__995': '"{\\"Company Name\\": \\"MKG Praxis\\", \\"Original_Number\\": \\"\'+49 841 95679000\\", \\"URL\\": \\"http://www.mkg-praxis-ingolstadt.de\\", \\"is_ ... (1044 characters truncated) ... l, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 2211.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__995': True, 'customer_target_segments__995': None, 'url__996': 'http://www.koelnkitas.de', 'profile_id__996': 16, 'industry__996': 'EdTech / E-Learning', 'company_name__996': 'Köln Kitas', 'phone_number__996': "'+4922154600200", 'additional_info__996': '"{\\"Company Name\\": \\"K\\\\u00f6ln Kitas\\", \\"Original_Number\\": \\"\'+49 221 54600200\\", \\"URL\\": \\"http://www.koelnkitas.de\\", \\"is_b2b ... (1244 characters truncated) ... l, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 2217.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__996': False, 'customer_target_segments__996': None, 'url__997': 'http://www.seepferdchen-kita.de', 'profile_id__997': 16, 'industry__997': 'Childcare', 'company_name__997': 'SEEPFERDCHEN KITA GMBH', 'phone_number__997': "'+4971166721800", 'additional_info__997': '"{\\"Company Name\\": \\"SEEPFERDCHEN KITA GMBH\\", \\"Original_Number\\": \\"\'+49 711 66721800\\", \\"URL\\": \\"http://www.seepferdchen-kita.de\\" ... (1471 characters truncated) ... business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 2219.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__997': True, 'customer_target_segments__997': 'Parents of children under 3 years old; Parents of kindergarten children', 'url__998': 'http://www.drklvnds.de', 'profile_id__998': 16, 'industry__998': 'Humanitarian Aid', 'company_name__998': 'DRK Landesverband Niedersachsen e.V.', 'phone_number__998': "'+0800365000", 'additional_info__998': '"{\\"Company Name\\": \\"DRK Landesverband Niedersachsen e.V.\\", \\"Original_Number\\": \\"\'+0800365000\\", \\"URL\\": \\"http://www.drklvnds.de\\" ... (4992 characters truncated) ... odel and services are clearly communicated, but the target group is broad.\\", \\"Original Row Number\\": 2221.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__998': True, 'customer_target_segments__998': 'People in need; Youth; Vulnerable populations; Schools', 'url__999': 'http://www.schaeffler-digital-solutions.de', 'profile_id__999': 16, 'industry__999': 'Digital Solutions for Industrial Applications', 'company_name__999': 'Schaeffler Digital Solutions GmbH', 'phone_number__999': "'+499132824440", 'additional_info__999': '"{\\"Company Name\\": \\"Schaeffler Digital Solutions GmbH\\", \\"Original_Number\\": \\"\'+49 91 32824440\\", \\"URL\\": \\"http://www.schaeffler-di ... (5141 characters truncated) ... get audience is broadly defined as industries requiring digital solutions.\\", \\"Original Row Number\\": 2223.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__999': True, 'customer_target_segments__999': 'Industries requiring digital solutions'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-07 14:50:26,201 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081154_20000-24000.csv ---
2025-07-07 14:50:26,201 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081154_20000-24000.csv...
2025-07-07 14:50:26,310 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_081154_20000-24000.csv.
2025-07-07 14:50:26,311 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 14:50:26,319 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 14:50:26,491 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 14:50:26,494 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 14:50:26,499 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 14:50:26,552 - INFO - etl.scripts.transform - Saved 1177 duplicate rows to etl/dropped_duplicates\duplicates_20250707_145026.csv
2025-07-07 14:50:26,554 - INFO - etl.scripts.transform - Removed 1177 duplicate phone numbers from the source file.
2025-07-07 14:50:26,554 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 14:50:26,555 - INFO - root - Starting deduplication...
2025-07-07 14:50:26,557 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 14:50:26,662 - INFO - root - Deduplication complete. 2824 rows remaining for insertion.
2025-07-07 14:50:27,013 - INFO - etl.scripts.load - Found existing profile_id: 16 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 14:50:27,013 - INFO - etl.scripts.load - Loading 2824 rows with profile_id 16 into 'contacts' table...
2025-07-07 14:50:28,144 - ERROR - etl.scripts.load - Failed to load data into 'contacts': (psycopg2.errors.NotNullViolation) null value in column "company_name" of relation "contacts" violates not-null constraint
DETAIL:  Failing row contains (75535, null, MissingURL, null, null, null, null, "{\"Company Name\": null, \"Original_Number\": null, \"URL\": \"..., null, active, null, 2025-07-07 13:50:27.107957, 2025-07-07 13:50:27.107957, 16).

[SQL: INSERT INTO contacts (company_name, url, phone_number, industry, is_b2b, customer_target_segments, additional_info, profile_id) VALUES (%(company_name__0)s, %(url__0)s, %(phone_number__0)s, %(industry__0)s, %(is_b2b__0)s, %(customer_target_segments__ ... 185903 characters truncated ... b2b__999)s, %(customer_target_segments__999)s, %(additional_info__999)s::JSONB, %(profile_id__999)s)]
[parameters: {'url__0': 'MissingURL', 'profile_id__0': 16, 'industry__0': None, 'company_name__0': None, 'phone_number__0': None, 'additional_info__0': '"{\\"Company Name\\": null, \\"Original_Number\\": null, \\"URL\\": \\"MissingURL\\", \\"is_b2b\\": null, \\"is_b2b_reason\\": null, \\"serves_1000\\ ... (603 characters truncated) ... red\\": null, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": null, \\"ScrapeStatus\\": null}"', 'is_b2b__0': None, 'customer_target_segments__0': None, 'url__1': 'http://www.lidel.de', 'profile_id__1': 16, 'industry__1': 'Manufacturing Sector (B2B)', 'company_name__1': 'Lidel Fenster Schreinerei Zimmerei Holzbau Parkett', 'phone_number__1': "'+49821413075", 'additional_info__1': '"{\\"Company Name\\": \\"Lidel Fenster Schreinerei Zimmerei Holzbau Parkett\\", \\"Original_Number\\": \\"\'+49 821 413075\\", \\"URL\\": \\"http://w ... (1088 characters truncated) ... ull, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 10.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__1': True, 'customer_target_segments__1': None, 'url__2': 'http://www.sprachtherapie-friedrich.de', 'profile_id__2': 16, 'industry__2': 'Unknown/Not Specified', 'company_name__2': 'Praxis Für Sprachtherapie', 'phone_number__2': "'+498053796242", 'additional_info__2': '"{\\"Company Name\\": \\"Praxis F\\\\u00fcr Sprachtherapie\\", \\"Original_Number\\": \\"\'+49 8053 796242\\", \\"URL\\": \\"http://www.sprachtherapi ... (1014 characters truncated) ... ull, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 23.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__2': True, 'customer_target_segments__2': None, 'url__3': 'http://www.berufskolleg-bonn-duisdorf.de', 'profile_id__3': 16, 'industry__3': 'Vocational Education', 'company_name__3': 'Berufskolleg Des Rhein-Sieg-Kreises', 'phone_number__3': "'+49228526800", 'additional_info__3': '"{\\"Company Name\\": \\"Berufskolleg Des Rhein-Sieg-Kreises\\", \\"Original_Number\\": \\"\'+49 228 526800\\", \\"URL\\": \\"http://www.berufskolleg ... (5800 characters truncated) ... ry clearly describes the school\'s educational programs and target audience.\\", \\"Original Row Number\\": 24.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__3': True, 'customer_target_segments__3': 'Students of diverse backgrounds; Individuals seeking vocational training; Individuals seeking secondary education', 'url__4': 'http://www.coffeemore.de', 'profile_id__4': 16, 'industry__4': 'Coffee Machine Retail and Service', 'company_name__4': 'Coffee And More', 'phone_number__4': "'+4977719179700", 'additional_info__4': '"{\\"Company Name\\": \\"Coffee And More\\", \\"Original_Number\\": \\"\'+49 777 19179700\\", \\"URL\\": \\"http://www.coffeemore.de\\", \\"is_b2b\\" ... (4173 characters truncated) ... ience is somewhat clear, including both businesses and individual consumers.\\", \\"Original Row Number\\": 31.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__4': True, 'customer_target_segments__4': 'Customers who value competence over low prices; Gastronomy businesses; Offices; Commercial users', 'url__5': 'http://www.san-remo-luebeck.de', 'profile_id__5': 16, 'industry__5': 'Retail Technology / Hospitality Technology', 'company_name__5': 'Ristorante San Remo', 'phone_number__5': "'+4945061000", 'additional_info__5': '"{\\"Company Name\\": \\"Ristorante San Remo\\", \\"Original_Number\\": \\"\'+49 4506 1000\\", \\"URL\\": \\"http://www.san-remo-luebeck.de\\", \\"is ... (1033 characters truncated) ... ull, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 51.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__5': True, 'customer_target_segments__5': None, 'url__6': 'http://www.dut.de', 'profile_id__6': 16 ... 7900 parameters truncated ... 'is_b2b__993': False, 'customer_target_segments__993': None, 'url__994': 'http://www.agglo-fr.ch', 'profile_id__994': 16, 'industry__994': 'Regional Public Administration', 'company_name__994': 'Agglomération de Fribourg', 'phone_number__994': "'+41263472100", 'additional_info__994': '"{\\"Company Name\\": \\"Agglom\\\\u00e9ration de Fribourg\\", \\"Original_Number\\": \\"\'+41 26 347 21 00\\", \\"URL\\": \\"http://www.agglo-fr.ch\ ... (5739 characters truncated) ... , but the specific target groups for each service are not always explicit.\\", \\"Original Row Number\\": 1837.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__994': True, 'customer_target_segments__994': 'Municipalities; Residents; Local businesses; Cultural associations', 'url__995': 'http://www.deondigital.com', 'profile_id__995': 16, 'industry__995': 'Green Finance Technology', 'company_name__995': 'Deon Digital AG', 'phone_number__995': "'+41786444128", 'additional_info__995': '"{\\"Company Name\\": \\"Deon Digital AG\\", \\"Original_Number\\": \\"\'+41 78 644 41 28\\", \\"URL\\": \\"http://www.deondigital.com\\", \\"is_b2b\ ... (5034 characters truncated) ... ut the target audience size is not explicitly mentioned.\\", \\"Original Row Number\\": 1838.0, \\"ScrapeStatus\\": \\"Used_Fallback_Description\\"}"', 'is_b2b__995': True, 'customer_target_segments__995': 'Stakeholders within the asset lifecycle; Green Finance market participants; Carbon Markets participants', 'url__996': 'http://www.entlebucher-medienhaus.ch', 'profile_id__996': 16, 'industry__996': 'Media and Communications', 'company_name__996': 'Entlebucher Medienhaus AG', 'phone_number__996': "'+41414858585", 'additional_info__996': '"{\\"Company Name\\": \\"Entlebucher Medienhaus AG\\", \\"Original_Number\\": \\"\'+41 41 485 85 85\\", \\"URL\\": \\"http://www.entlebucher-medienha ... (3747 characters truncated) ... and services are reasonably clear. Target group is not explicitly defined.\\", \\"Original Row Number\\": 1840.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__996': True, 'customer_target_segments__996': None, 'url__997': 'http://www.canvas.ch', 'profile_id__997': 16, 'industry__997': 'Fashion and Visual Arts Education', 'company_name__997': 'Canvas | School of Art and Fashion', 'phone_number__997': "'+41788255483", 'additional_info__997': '"{\\"Company Name\\": \\"Canvas | School of Art and Fashion\\", \\"Original_Number\\": \\"\'+41 78 825 54 83\\", \\"URL\\": \\"http://www.canvas.ch\\ ... (1718 characters truncated) ... business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 1841.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__997': True, 'customer_target_segments__997': 'Individuals interested in fashion trends; Individuals passionate about visual communication and illustration; Students applying to art schools', 'url__998': 'http://www.wps4digital.com', 'profile_id__998': 16, 'industry__998': 'Digital Agency', 'company_name__998': 'wps4digital AG', 'phone_number__998': "'+41447493838", 'additional_info__998': '"{\\"Company Name\\": \\"wps4digital AG\\", \\"Original_Number\\": \\"\'+41 44 749 38 38\\", \\"URL\\": \\"http://www.wps4digital.com\\", \\"is_b2b\\ ... (4218 characters truncated) ...  model is reasonably clear, but the target group is not explicitly stated.\\", \\"Original Row Number\\": 1842.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__998': True, 'customer_target_segments__998': None, 'url__999': 'http://www.kannewischer.group', 'profile_id__999': 16, 'industry__999': 'Building Technology', 'company_name__999': 'Kannewischer Group', 'phone_number__999': "'+41417253050", 'additional_info__999': '"{\\"Company Name\\": \\"Kannewischer Group\\", \\"Original_Number\\": \\"\'+41 41 725 30 50\\", \\"URL\\": \\"http://www.kannewischer.group\\", \\"i ... (5105 characters truncated) ... tated but inferred to be businesses needing building technology solutions.\\", \\"Original Row Number\\": 1843.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__999': True, 'customer_target_segments__999': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-07 14:50:28,150 - ERROR - root - Failed to load data for SalesOutreachReport_20250705_081154_20000-24000.csv. Halting processing for this file. Error: (psycopg2.errors.NotNullViolation) null value in column "company_name" of relation "contacts" violates not-null constraint
DETAIL:  Failing row contains (75535, null, MissingURL, null, null, null, null, "{\"Company Name\": null, \"Original_Number\": null, \"URL\": \"..., null, active, null, 2025-07-07 13:50:27.107957, 2025-07-07 13:50:27.107957, 16).

[SQL: INSERT INTO contacts (company_name, url, phone_number, industry, is_b2b, customer_target_segments, additional_info, profile_id) VALUES (%(company_name__0)s, %(url__0)s, %(phone_number__0)s, %(industry__0)s, %(is_b2b__0)s, %(customer_target_segments__ ... 185903 characters truncated ... b2b__999)s, %(customer_target_segments__999)s, %(additional_info__999)s::JSONB, %(profile_id__999)s)]
[parameters: {'url__0': 'MissingURL', 'profile_id__0': 16, 'industry__0': None, 'company_name__0': None, 'phone_number__0': None, 'additional_info__0': '"{\\"Company Name\\": null, \\"Original_Number\\": null, \\"URL\\": \\"MissingURL\\", \\"is_b2b\\": null, \\"is_b2b_reason\\": null, \\"serves_1000\\ ... (603 characters truncated) ... red\\": null, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": null, \\"ScrapeStatus\\": null}"', 'is_b2b__0': None, 'customer_target_segments__0': None, 'url__1': 'http://www.lidel.de', 'profile_id__1': 16, 'industry__1': 'Manufacturing Sector (B2B)', 'company_name__1': 'Lidel Fenster Schreinerei Zimmerei Holzbau Parkett', 'phone_number__1': "'+49821413075", 'additional_info__1': '"{\\"Company Name\\": \\"Lidel Fenster Schreinerei Zimmerei Holzbau Parkett\\", \\"Original_Number\\": \\"\'+49 821 413075\\", \\"URL\\": \\"http://w ... (1088 characters truncated) ... ull, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 10.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__1': True, 'customer_target_segments__1': None, 'url__2': 'http://www.sprachtherapie-friedrich.de', 'profile_id__2': 16, 'industry__2': 'Unknown/Not Specified', 'company_name__2': 'Praxis Für Sprachtherapie', 'phone_number__2': "'+498053796242", 'additional_info__2': '"{\\"Company Name\\": \\"Praxis F\\\\u00fcr Sprachtherapie\\", \\"Original_Number\\": \\"\'+49 8053 796242\\", \\"URL\\": \\"http://www.sprachtherapi ... (1014 characters truncated) ... ull, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 23.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__2': True, 'customer_target_segments__2': None, 'url__3': 'http://www.berufskolleg-bonn-duisdorf.de', 'profile_id__3': 16, 'industry__3': 'Vocational Education', 'company_name__3': 'Berufskolleg Des Rhein-Sieg-Kreises', 'phone_number__3': "'+49228526800", 'additional_info__3': '"{\\"Company Name\\": \\"Berufskolleg Des Rhein-Sieg-Kreises\\", \\"Original_Number\\": \\"\'+49 228 526800\\", \\"URL\\": \\"http://www.berufskolleg ... (5800 characters truncated) ... ry clearly describes the school\'s educational programs and target audience.\\", \\"Original Row Number\\": 24.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__3': True, 'customer_target_segments__3': 'Students of diverse backgrounds; Individuals seeking vocational training; Individuals seeking secondary education', 'url__4': 'http://www.coffeemore.de', 'profile_id__4': 16, 'industry__4': 'Coffee Machine Retail and Service', 'company_name__4': 'Coffee And More', 'phone_number__4': "'+4977719179700", 'additional_info__4': '"{\\"Company Name\\": \\"Coffee And More\\", \\"Original_Number\\": \\"\'+49 777 19179700\\", \\"URL\\": \\"http://www.coffeemore.de\\", \\"is_b2b\\" ... (4173 characters truncated) ... ience is somewhat clear, including both businesses and individual consumers.\\", \\"Original Row Number\\": 31.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__4': True, 'customer_target_segments__4': 'Customers who value competence over low prices; Gastronomy businesses; Offices; Commercial users', 'url__5': 'http://www.san-remo-luebeck.de', 'profile_id__5': 16, 'industry__5': 'Retail Technology / Hospitality Technology', 'company_name__5': 'Ristorante San Remo', 'phone_number__5': "'+4945061000", 'additional_info__5': '"{\\"Company Name\\": \\"Ristorante San Remo\\", \\"Original_Number\\": \\"\'+49 4506 1000\\", \\"URL\\": \\"http://www.san-remo-luebeck.de\\", \\"is ... (1033 characters truncated) ... ull, \\"Innovation Level Indicators\\": null, \\"Website Clarity Notes\\": null, \\"Original Row Number\\": 51.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__5': True, 'customer_target_segments__5': None, 'url__6': 'http://www.dut.de', 'profile_id__6': 16 ... 7900 parameters truncated ... 'is_b2b__993': False, 'customer_target_segments__993': None, 'url__994': 'http://www.agglo-fr.ch', 'profile_id__994': 16, 'industry__994': 'Regional Public Administration', 'company_name__994': 'Agglomération de Fribourg', 'phone_number__994': "'+41263472100", 'additional_info__994': '"{\\"Company Name\\": \\"Agglom\\\\u00e9ration de Fribourg\\", \\"Original_Number\\": \\"\'+41 26 347 21 00\\", \\"URL\\": \\"http://www.agglo-fr.ch\ ... (5739 characters truncated) ... , but the specific target groups for each service are not always explicit.\\", \\"Original Row Number\\": 1837.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__994': True, 'customer_target_segments__994': 'Municipalities; Residents; Local businesses; Cultural associations', 'url__995': 'http://www.deondigital.com', 'profile_id__995': 16, 'industry__995': 'Green Finance Technology', 'company_name__995': 'Deon Digital AG', 'phone_number__995': "'+41786444128", 'additional_info__995': '"{\\"Company Name\\": \\"Deon Digital AG\\", \\"Original_Number\\": \\"\'+41 78 644 41 28\\", \\"URL\\": \\"http://www.deondigital.com\\", \\"is_b2b\ ... (5034 characters truncated) ... ut the target audience size is not explicitly mentioned.\\", \\"Original Row Number\\": 1838.0, \\"ScrapeStatus\\": \\"Used_Fallback_Description\\"}"', 'is_b2b__995': True, 'customer_target_segments__995': 'Stakeholders within the asset lifecycle; Green Finance market participants; Carbon Markets participants', 'url__996': 'http://www.entlebucher-medienhaus.ch', 'profile_id__996': 16, 'industry__996': 'Media and Communications', 'company_name__996': 'Entlebucher Medienhaus AG', 'phone_number__996': "'+41414858585", 'additional_info__996': '"{\\"Company Name\\": \\"Entlebucher Medienhaus AG\\", \\"Original_Number\\": \\"\'+41 41 485 85 85\\", \\"URL\\": \\"http://www.entlebucher-medienha ... (3747 characters truncated) ... and services are reasonably clear. Target group is not explicitly defined.\\", \\"Original Row Number\\": 1840.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__996': True, 'customer_target_segments__996': None, 'url__997': 'http://www.canvas.ch', 'profile_id__997': 16, 'industry__997': 'Fashion and Visual Arts Education', 'company_name__997': 'Canvas | School of Art and Fashion', 'phone_number__997': "'+41788255483", 'additional_info__997': '"{\\"Company Name\\": \\"Canvas | School of Art and Fashion\\", \\"Original_Number\\": \\"\'+41 78 825 54 83\\", \\"URL\\": \\"http://www.canvas.ch\\ ... (1718 characters truncated) ... business model and target audience are clearly articulated in the summary.\\", \\"Original Row Number\\": 1841.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__997': True, 'customer_target_segments__997': 'Individuals interested in fashion trends; Individuals passionate about visual communication and illustration; Students applying to art schools', 'url__998': 'http://www.wps4digital.com', 'profile_id__998': 16, 'industry__998': 'Digital Agency', 'company_name__998': 'wps4digital AG', 'phone_number__998': "'+41447493838", 'additional_info__998': '"{\\"Company Name\\": \\"wps4digital AG\\", \\"Original_Number\\": \\"\'+41 44 749 38 38\\", \\"URL\\": \\"http://www.wps4digital.com\\", \\"is_b2b\\ ... (4218 characters truncated) ...  model is reasonably clear, but the target group is not explicitly stated.\\", \\"Original Row Number\\": 1842.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__998': True, 'customer_target_segments__998': None, 'url__999': 'http://www.kannewischer.group', 'profile_id__999': 16, 'industry__999': 'Building Technology', 'company_name__999': 'Kannewischer Group', 'phone_number__999': "'+41417253050", 'additional_info__999': '"{\\"Company Name\\": \\"Kannewischer Group\\", \\"Original_Number\\": \\"\'+41 41 725 30 50\\", \\"URL\\": \\"http://www.kannewischer.group\\", \\"i ... (5105 characters truncated) ... tated but inferred to be businesses needing building technology solutions.\\", \\"Original Row Number\\": 1843.0, \\"ScrapeStatus\\": \\"Success\\"}"', 'is_b2b__999': True, 'customer_target_segments__999': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-07 14:50:28,151 - INFO - root - ETL pipeline finished.
2025-07-07 14:51:14,714 - INFO - root - Logging configured successfully.
2025-07-07 14:52:20,772 - WARNING - root - --- Starting Database Reset ---
2025-07-07 14:52:20,793 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:52:22,437 - INFO - root - Deleting all records from 'contacts' table...
2025-07-07 14:52:22,637 - INFO - root - ...done.
2025-07-07 14:52:22,638 - INFO - root - Deleting all records from 'contact_profiles' table...
2025-07-07 14:52:22,719 - INFO - root - ...done.
2025-07-07 14:52:22,817 - INFO - root - --- Database Reset Successfully ---
2025-07-07 14:55:13,090 - INFO - root - Logging configured successfully.
2025-07-07 14:55:13,090 - INFO - root - ETL pipeline started.
2025-07-07 14:55:13,106 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 14:55:14,618 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 14:55:14,619 - INFO - etl.scripts.extract - Found 8 CSV files in etl/input_data.
2025-07-07 14:55:14,619 - INFO - root - --- Processing file: SalesOutreachReport_20250705_080954_4000-8000.csv ---
2025-07-07 14:55:14,619 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_080954_4000-8000.csv...
2025-07-07 14:55:14,749 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_080954_4000-8000.csv.
2025-07-07 14:55:14,749 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 14:55:14,758 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 14:55:14,983 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 14:55:14,985 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 14:55:14,987 - WARNING - etl.scripts.transform - Dropped 444 rows due to missing company name.
2025-07-07 14:55:14,991 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 14:55:15,033 - INFO - etl.scripts.transform - Saved 633 duplicate rows to etl/dropped_duplicates\duplicates_20250707_145514.csv
2025-07-07 14:55:15,034 - INFO - etl.scripts.transform - Removed 633 duplicate phone numbers from the source file.
2025-07-07 14:55:15,035 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 14:55:15,035 - INFO - root - Starting deduplication...
2025-07-07 14:55:15,036 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 14:55:15,148 - INFO - root - Deduplication complete. 2924 rows remaining for insertion.
2025-07-07 14:55:15,432 - INFO - etl.scripts.load - Created new profile_id: 17 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 14:55:15,433 - INFO - etl.scripts.load - Loading 2924 rows with profile_id 17 into 'contacts' table...
2025-07-07 14:55:18,554 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 14:55:18,556 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SalesOutreachReport_20250705_080954_4000-8000.csv
2025-07-07 14:55:18,558 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081012_8000-12000.csv ---
2025-07-07 14:55:18,558 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081012_8000-12000.csv...
2025-07-07 14:55:18,625 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_081012_8000-12000.csv.
2025-07-07 14:55:18,627 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 14:55:18,636 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 14:55:18,820 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 14:55:18,823 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 14:55:18,825 - WARNING - etl.scripts.transform - Dropped 1276 rows due to missing company name.
2025-07-07 14:55:18,828 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 14:55:18,867 - INFO - etl.scripts.transform - Saved 859 duplicate rows to etl/dropped_duplicates\duplicates_20250707_145518.csv
2025-07-07 14:55:18,868 - INFO - etl.scripts.transform - Removed 859 duplicate phone numbers from the source file.
2025-07-07 14:55:18,868 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 14:55:18,869 - INFO - root - Starting deduplication...
2025-07-07 14:55:18,870 - INFO - root - Removed 3 rows with existing phone numbers.
2025-07-07 14:55:30,356 - WARNING - root - Potential duplicate found for 'INTEG GmbH'. Similarity: 90.0%. Matched with: 'intes gmbh'. Skipping row and adding to review file.
2025-07-07 14:55:38,972 - WARNING - root - Potential duplicate found for 'move technology GmbH'. Similarity: 90.0%. Matched with: 'joke technology gmbh'. Skipping row and adding to review file.
2025-07-07 14:55:46,056 - WARNING - root - Potential duplicate found for 'Seven Group'. Similarity: 91.66666666666666%. Matched with: 'inseven group'. Skipping row and adding to review file.
2025-07-07 14:55:50,670 - WARNING - root - Potential duplicate found for 'EMO Systems GmbH'. Similarity: 90.32258064516128%. Matched with: 'ao systems gmbh'. Skipping row and adding to review file.
2025-07-07 14:56:14,096 - INFO - root - Saved 4 potential duplicates to etl/review\review_SalesOutreachReport_20250705_081012_8000-12000.csv
2025-07-07 14:56:14,097 - INFO - root - Deduplication complete. 1859 rows remaining for insertion.
2025-07-07 14:56:14,443 - INFO - etl.scripts.load - Found existing profile_id: 17 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 14:56:14,447 - INFO - etl.scripts.load - Loading 1859 rows with profile_id 17 into 'contacts' table...
2025-07-07 14:56:16,322 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 14:56:16,324 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SalesOutreachReport_20250705_081012_8000-12000.csv
2025-07-07 14:56:16,327 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081027_12000-16000.csv ---
2025-07-07 14:56:16,327 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081027_12000-16000.csv...
2025-07-07 14:56:16,430 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_081027_12000-16000.csv.
2025-07-07 14:56:16,432 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 14:56:16,444 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 14:56:16,663 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 14:56:16,666 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 14:56:16,668 - WARNING - etl.scripts.transform - Dropped 602 rows due to missing company name.
2025-07-07 14:56:16,672 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 14:56:16,710 - INFO - etl.scripts.transform - Saved 702 duplicate rows to etl/dropped_duplicates\duplicates_20250707_145616.csv
2025-07-07 14:56:16,712 - INFO - etl.scripts.transform - Removed 702 duplicate phone numbers from the source file.
2025-07-07 14:56:16,712 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 14:56:16,713 - INFO - root - Starting deduplication...
2025-07-07 14:56:16,716 - INFO - root - Removed 4 rows with existing phone numbers.
2025-07-07 14:56:17,872 - WARNING - root - Potential duplicate found for 'Renner GmbH'. Similarity: 90.0%. Matched with: 'reer gmbh'. Skipping row and adding to review file.
2025-07-07 14:56:19,338 - WARNING - root - Potential duplicate found for 'CeH4 technologies GmbH'. Similarity: 90.47619047619048%. Matched with: 'cm technologies gmbh'. Skipping row and adding to review file.
2025-07-07 14:56:38,143 - WARNING - root - Potential duplicate found for 'INOSOFT GmbH'. Similarity: 96.0%. Matched with: 'innosoft gmbh'. Skipping row and adding to review file.
2025-07-07 14:57:05,641 - WARNING - root - Potential duplicate found for 'Marti GMBH'. Similarity: 90.0%. Matched with: 'marli gmbh'. Skipping row and adding to review file.
2025-07-07 14:57:06,253 - WARNING - root - Potential duplicate found for 'QMatrix GmbH'. Similarity: 91.66666666666666%. Matched with: 'matrix ggmbh'. Skipping row and adding to review file.
2025-07-07 14:57:11,451 - WARNING - root - Potential duplicate found for 'Meyer logistics GmbH'. Similarity: 92.3076923076923%. Matched with: 'meyer logistik gmbh'. Skipping row and adding to review file.
2025-07-07 14:57:14,570 - WARNING - root - Potential duplicate found for 'LCTech GmbH'. Similarity: 90.9090909090909%. Matched with: 'lactec gmbh'. Skipping row and adding to review file.
2025-07-07 14:57:19,489 - WARNING - root - Potential duplicate found for 'BEC GmbH'. Similarity: 94.11764705882352%. Matched with: 'beck gmbh'. Skipping row and adding to review file.
2025-07-07 14:57:22,207 - WARNING - root - Potential duplicate found for 'AGOLUTION GmbH'. Similarity: 90.32258064516128%. Matched with: 'agrosolution gmbh'. Skipping row and adding to review file.
2025-07-07 14:57:41,059 - WARNING - root - Potential duplicate found for 'Merz Verpackungsmaschinen GmbH'. Similarity: 91.52542372881356%. Matched with: 'pfm verpackungsmaschinen gmbh'. Skipping row and adding to review file.
2025-07-07 14:57:41,659 - WARNING - root - Potential duplicate found for 'hs2 engineering GmbH'. Similarity: 92.3076923076923%. Matched with: 'k2 engineering gmbh'. Skipping row and adding to review file.
2025-07-07 14:58:01,885 - WARNING - root - Potential duplicate found for 'HRM CONSULTING GmbH'. Similarity: 90.0%. Matched with: 'herol consulting gmbh'. Skipping row and adding to review file.
2025-07-07 14:58:03,977 - WARNING - root - Potential duplicate found for 'KRUPS Automation GmbH'. Similarity: 90.0%. Matched with: 'kms automation gmbh'. Skipping row and adding to review file.
2025-07-07 14:58:08,035 - WARNING - root - Potential duplicate found for 'Hanwha Europe GmbH'. Similarity: 91.89189189189189%. Matched with: 'hangcha europe gmbh'. Skipping row and adding to review file.
2025-07-07 15:00:02,747 - INFO - root - Logging configured successfully.
2025-07-07 15:00:04,368 - WARNING - root - --- Starting Database Reset ---
2025-07-07 15:00:04,383 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 15:00:05,639 - INFO - root - Deleting all records from 'contacts' table...
2025-07-07 15:00:05,840 - INFO - root - ...done.
2025-07-07 15:00:05,841 - INFO - root - Deleting all records from 'contact_profiles' table...
2025-07-07 15:00:05,922 - INFO - root - ...done.
2025-07-07 15:00:06,016 - INFO - root - --- Database Reset Successfully ---
2025-07-07 15:00:19,076 - INFO - root - Logging configured successfully.
2025-07-07 15:00:19,076 - INFO - root - ETL pipeline started.
2025-07-07 15:00:19,093 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 15:00:20,661 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 15:00:20,662 - INFO - etl.scripts.extract - Found 6 CSV files in etl/input_data.
2025-07-07 15:00:20,662 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081027_12000-16000.csv ---
2025-07-07 15:00:20,662 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081027_12000-16000.csv...
2025-07-07 15:00:20,804 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_081027_12000-16000.csv.
2025-07-07 15:00:20,804 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:00:20,815 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 15:00:20,999 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:00:21,002 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:00:21,004 - WARNING - etl.scripts.transform - Dropped 602 rows due to missing company name.
2025-07-07 15:00:21,008 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:00:21,052 - INFO - etl.scripts.transform - Saved 702 duplicate rows to etl/dropped_duplicates\duplicates_20250707_150021.csv
2025-07-07 15:00:21,054 - INFO - etl.scripts.transform - Removed 702 duplicate phone numbers from the source file.
2025-07-07 15:00:21,054 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:00:21,055 - INFO - root - Starting deduplication...
2025-07-07 15:00:21,057 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 15:00:21,058 - INFO - root - Fuzzy matching for company names is disabled.
2025-07-07 15:00:21,059 - INFO - root - Deduplication complete. 2697 rows remaining for insertion.
2025-07-07 15:00:21,347 - INFO - etl.scripts.load - Created new profile_id: 18 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 15:00:21,347 - INFO - etl.scripts.load - Loading 2697 rows with profile_id 18 into 'contacts' table...
2025-07-07 15:00:24,107 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 15:00:24,109 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SalesOutreachReport_20250705_081027_12000-16000.csv
2025-07-07 15:00:24,110 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081050_16000-20000.csv ---
2025-07-07 15:00:24,110 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081050_16000-20000.csv...
2025-07-07 15:00:24,207 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_081050_16000-20000.csv.
2025-07-07 15:00:24,209 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:00:24,220 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 15:00:24,383 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:00:24,386 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:00:24,389 - WARNING - etl.scripts.transform - Dropped 698 rows due to missing company name.
2025-07-07 15:00:24,393 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:00:24,430 - INFO - etl.scripts.transform - Saved 684 duplicate rows to etl/dropped_duplicates\duplicates_20250707_150024.csv
2025-07-07 15:00:24,432 - INFO - etl.scripts.transform - Removed 684 duplicate phone numbers from the source file.
2025-07-07 15:00:24,432 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:00:24,432 - INFO - root - Starting deduplication...
2025-07-07 15:00:24,434 - INFO - root - Removed 5 rows with existing phone numbers.
2025-07-07 15:00:24,434 - INFO - root - Fuzzy matching for company names is disabled.
2025-07-07 15:00:24,435 - INFO - root - Deduplication complete. 2614 rows remaining for insertion.
2025-07-07 15:00:24,844 - INFO - etl.scripts.load - Found existing profile_id: 18 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 15:00:24,846 - INFO - etl.scripts.load - Loading 2614 rows with profile_id 18 into 'contacts' table...
2025-07-07 15:00:27,333 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 15:00:27,336 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SalesOutreachReport_20250705_081050_16000-20000.csv
2025-07-07 15:00:27,337 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081114_20000-24000.csv ---
2025-07-07 15:00:27,338 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081114_20000-24000.csv...
2025-07-07 15:00:27,340 - INFO - etl.scripts.extract - Successfully extracted 1 rows from SalesOutreachReport_20250705_081114_20000-24000.csv.
2025-07-07 15:00:27,342 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:00:27,343 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 15:00:27,348 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:00:27,350 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:00:27,353 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:00:27,357 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:00:27,359 - INFO - root - Starting deduplication...
2025-07-07 15:00:27,361 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 15:00:27,361 - INFO - root - Fuzzy matching for company names is disabled.
2025-07-07 15:00:27,361 - INFO - root - Deduplication complete. 1 rows remaining for insertion.
2025-07-07 15:00:27,702 - INFO - etl.scripts.load - Found existing profile_id: 18 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 15:00:27,704 - INFO - etl.scripts.load - Loading 1 rows with profile_id 18 into 'contacts' table...
2025-07-07 15:00:27,969 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 15:00:27,972 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SalesOutreachReport_20250705_081114_20000-24000.csv
2025-07-07 15:00:27,974 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081134_24000-28000.csv ---
2025-07-07 15:00:27,974 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081134_24000-28000.csv...
2025-07-07 15:00:28,096 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_081134_24000-28000.csv.
2025-07-07 15:00:28,097 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:00:28,107 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 15:00:28,316 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:00:28,320 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:00:28,322 - WARNING - etl.scripts.transform - Dropped 840 rows due to missing company name.
2025-07-07 15:00:28,327 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:00:28,372 - INFO - etl.scripts.transform - Saved 746 duplicate rows to etl/dropped_duplicates\duplicates_20250707_150028.csv
2025-07-07 15:00:28,373 - INFO - etl.scripts.transform - Removed 746 duplicate phone numbers from the source file.
2025-07-07 15:00:28,374 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:00:28,374 - INFO - root - Starting deduplication...
2025-07-07 15:00:28,376 - INFO - root - Removed 10 rows with existing phone numbers.
2025-07-07 15:00:28,377 - INFO - root - Fuzzy matching for company names is disabled.
2025-07-07 15:00:28,377 - INFO - root - Deduplication complete. 2405 rows remaining for insertion.
2025-07-07 15:00:28,757 - INFO - etl.scripts.load - Found existing profile_id: 18 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 15:00:28,758 - INFO - etl.scripts.load - Loading 2405 rows with profile_id 18 into 'contacts' table...
2025-07-07 15:00:31,236 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 15:00:31,238 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SalesOutreachReport_20250705_081134_24000-28000.csv
2025-07-07 15:00:31,240 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081154_20000-24000.csv ---
2025-07-07 15:00:31,240 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081154_20000-24000.csv...
2025-07-07 15:00:31,346 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_081154_20000-24000.csv.
2025-07-07 15:00:31,348 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:00:31,359 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 15:00:31,521 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:00:31,524 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:00:31,526 - WARNING - etl.scripts.transform - Dropped 448 rows due to missing company name.
2025-07-07 15:00:31,530 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:00:31,568 - INFO - etl.scripts.transform - Saved 729 duplicate rows to etl/dropped_duplicates\duplicates_20250707_150031.csv
2025-07-07 15:00:31,570 - INFO - etl.scripts.transform - Removed 729 duplicate phone numbers from the source file.
2025-07-07 15:00:31,571 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:00:31,573 - INFO - root - Starting deduplication...
2025-07-07 15:00:31,576 - INFO - root - Removed 14 rows with existing phone numbers.
2025-07-07 15:00:31,576 - INFO - root - Fuzzy matching for company names is disabled.
2025-07-07 15:00:31,576 - INFO - root - Deduplication complete. 2810 rows remaining for insertion.
2025-07-07 15:00:31,908 - INFO - etl.scripts.load - Found existing profile_id: 18 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 15:00:31,910 - INFO - etl.scripts.load - Loading 2810 rows with profile_id 18 into 'contacts' table...
2025-07-07 15:00:34,434 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 15:00:34,437 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SalesOutreachReport_20250705_081154_20000-24000.csv
2025-07-07 15:00:34,438 - INFO - root - --- Processing file: SOR_7K_20250627_163929_regenerated_final.csv ---
2025-07-07 15:00:34,439 - INFO - etl.scripts.extract - Extracting data from SOR_7K_20250627_163929_regenerated_final.csv...
2025-07-07 15:00:34,784 - INFO - etl.scripts.extract - Successfully extracted 7383 rows from SOR_7K_20250627_163929_regenerated_final.csv.
2025-07-07 15:00:34,787 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:00:34,809 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'Apollo'
2025-07-07 15:00:35,226 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:00:35,231 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:00:35,280 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:00:35,399 - INFO - etl.scripts.transform - Saved 1574 duplicate rows to etl/dropped_duplicates\duplicates_20250707_150035.csv
2025-07-07 15:00:35,402 - INFO - etl.scripts.transform - Removed 1574 duplicate phone numbers from the source file.
2025-07-07 15:00:35,403 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:00:35,405 - INFO - root - Starting deduplication...
2025-07-07 15:00:35,410 - INFO - root - Removed 1439 rows with existing phone numbers.
2025-07-07 15:00:35,411 - INFO - root - Fuzzy matching for company names is disabled.
2025-07-07 15:00:35,411 - INFO - root - Deduplication complete. 4370 rows remaining for insertion.
2025-07-07 15:00:35,698 - INFO - etl.scripts.load - Created new profile_id: 19 for hash: ebb2ce72311169a7ea0a409c9c2c5a21
2025-07-07 15:00:35,699 - INFO - etl.scripts.load - Loading 4370 rows with profile_id 19 into 'contacts' table...
2025-07-07 15:00:40,206 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 15:00:40,207 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SOR_7K_20250627_163929_regenerated_final.csv
2025-07-07 15:00:40,209 - INFO - root - ETL pipeline finished.
2025-07-07 15:02:59,779 - INFO - root - Logging configured successfully.
2025-07-07 15:03:00,833 - WARNING - root - --- Starting Database Reset ---
2025-07-07 15:03:00,850 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 15:03:02,118 - INFO - root - Deleting all records from 'contacts' table...
2025-07-07 15:03:02,392 - INFO - root - ...done.
2025-07-07 15:03:02,393 - INFO - root - Deleting all records from 'contact_profiles' table...
2025-07-07 15:03:02,481 - INFO - root - ...done.
2025-07-07 15:03:02,574 - INFO - root - --- Database Reset Successfully ---
2025-07-07 15:03:25,747 - INFO - root - Logging configured successfully.
2025-07-07 15:03:25,747 - INFO - root - ETL pipeline started.
2025-07-07 15:03:25,764 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 15:03:27,330 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 15:03:27,332 - INFO - etl.scripts.extract - Found 9 CSV files in etl/input_data.
2025-07-07 15:03:27,332 - INFO - root - --- Processing file: mid_001_ER4K_spg_apol_20250701.csv ---
2025-07-07 15:03:27,333 - INFO - etl.scripts.extract - Extracting data from mid_001_ER4K_spg_apol_20250701.csv...
2025-07-07 15:03:27,384 - INFO - etl.scripts.extract - Successfully extracted 4280 rows from mid_001_ER4K_spg_apol_20250701.csv.
2025-07-07 15:03:27,385 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:03:27,387 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'default'
2025-07-07 15:03:27,470 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:03:27,471 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:03:27,472 - WARNING - etl.scripts.transform - Dropped 4280 rows due to missing company name.
2025-07-07 15:03:27,485 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:03:27,487 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:03:27,487 - INFO - root - Starting deduplication...
2025-07-07 15:03:27,488 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 15:03:27,488 - INFO - root - Fuzzy matching for company names is enabled.
2025-07-07 15:03:27,488 - INFO - root - Deduplication complete. 0 rows remaining for insertion.
2025-07-07 15:03:27,489 - INFO - etl.scripts.load - DataFrame is empty. Nothing to load to the database.
2025-07-07 15:03:27,490 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\mid_001_ER4K_spg_apol_20250701.csv
2025-07-07 15:03:27,490 - INFO - root - --- Processing file: SalesOutreachReport_20250705_080954_4000-8000.csv ---
2025-07-07 15:03:27,490 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_080954_4000-8000.csv...
2025-07-07 15:03:27,602 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_080954_4000-8000.csv.
2025-07-07 15:03:27,603 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:03:27,610 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 15:03:27,763 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:03:27,766 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:03:27,768 - WARNING - etl.scripts.transform - Dropped 444 rows due to missing company name.
2025-07-07 15:03:27,772 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:03:27,811 - INFO - etl.scripts.transform - Saved 633 duplicate rows to etl/dropped_duplicates\duplicates_20250707_150327.csv
2025-07-07 15:03:27,812 - INFO - etl.scripts.transform - Removed 633 duplicate phone numbers from the source file.
2025-07-07 15:03:27,813 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:03:27,813 - INFO - root - Starting deduplication...
2025-07-07 15:03:27,815 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 15:03:27,815 - INFO - root - Fuzzy matching for company names is enabled.
2025-07-07 15:03:27,910 - INFO - root - Deduplication complete. 2924 rows remaining for insertion.
2025-07-07 15:03:28,208 - INFO - etl.scripts.load - Created new profile_id: 20 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 15:03:28,209 - INFO - etl.scripts.load - Loading 2924 rows with profile_id 20 into 'contacts' table...
2025-07-07 15:03:31,705 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 15:03:31,707 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SalesOutreachReport_20250705_080954_4000-8000.csv
2025-07-07 15:03:31,710 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081012_8000-12000.csv ---
2025-07-07 15:03:31,710 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081012_8000-12000.csv...
2025-07-07 15:03:31,775 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_081012_8000-12000.csv.
2025-07-07 15:03:31,778 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:03:31,786 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 15:03:31,958 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:03:31,963 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:03:31,967 - WARNING - etl.scripts.transform - Dropped 1276 rows due to missing company name.
2025-07-07 15:03:31,971 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:03:32,008 - INFO - etl.scripts.transform - Saved 859 duplicate rows to etl/dropped_duplicates\duplicates_20250707_150331.csv
2025-07-07 15:03:32,010 - INFO - etl.scripts.transform - Removed 859 duplicate phone numbers from the source file.
2025-07-07 15:03:32,010 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:03:32,010 - INFO - root - Starting deduplication...
2025-07-07 15:03:32,012 - INFO - root - Removed 3 rows with existing phone numbers.
2025-07-07 15:03:32,012 - INFO - root - Fuzzy matching for company names is enabled.
2025-07-07 15:03:43,335 - WARNING - root - Potential duplicate found for 'INTEG GmbH'. Similarity: 90.0%. Matched with: 'intes gmbh'. Skipping row and adding to review file.
2025-07-07 15:03:52,272 - WARNING - root - Potential duplicate found for 'move technology GmbH'. Similarity: 90.0%. Matched with: 'joke technology gmbh'. Skipping row and adding to review file.
2025-07-07 15:03:59,417 - WARNING - root - Potential duplicate found for 'Seven Group'. Similarity: 91.66666666666666%. Matched with: 'inseven group'. Skipping row and adding to review file.
2025-07-07 15:04:04,422 - WARNING - root - Potential duplicate found for 'EMO Systems GmbH'. Similarity: 90.32258064516128%. Matched with: 'ao systems gmbh'. Skipping row and adding to review file.
2025-07-07 15:04:27,839 - INFO - root - Saved 4 potential duplicates to etl/review\review_SalesOutreachReport_20250705_081012_8000-12000.csv
2025-07-07 15:04:27,839 - INFO - root - Deduplication complete. 1859 rows remaining for insertion.
2025-07-07 15:04:28,170 - INFO - etl.scripts.load - Found existing profile_id: 20 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 15:04:28,171 - INFO - etl.scripts.load - Loading 1859 rows with profile_id 20 into 'contacts' table...
2025-07-07 15:04:31,169 - ERROR - etl.scripts.load - Failed to load data into 'contacts': Can't reconnect until invalid transaction is rolled back.  Please rollback() fully before proceeding (Background on this error at: https://sqlalche.me/e/20/8s2b)
2025-07-07 15:04:31,170 - ERROR - root - Failed to load data for SalesOutreachReport_20250705_081012_8000-12000.csv. Halting processing for this file. Error: Can't reconnect until invalid transaction is rolled back.  Please rollback() fully before proceeding (Background on this error at: https://sqlalche.me/e/20/8s2b)
2025-07-07 15:04:31,170 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081027_12000-16000.csv ---
2025-07-07 15:04:31,170 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081027_12000-16000.csv...
2025-07-07 15:04:34,874 - INFO - root - Logging configured successfully.
2025-07-07 15:04:36,121 - WARNING - root - --- Starting Database Reset ---
2025-07-07 15:04:36,136 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 15:04:37,355 - INFO - root - Deleting all records from 'contacts' table...
2025-07-07 15:04:37,551 - INFO - root - ...done.
2025-07-07 15:04:37,552 - INFO - root - Deleting all records from 'contact_profiles' table...
2025-07-07 15:04:37,654 - INFO - root - ...done.
2025-07-07 15:04:37,729 - INFO - root - --- Database Reset Successfully ---
2025-07-07 15:05:15,642 - INFO - root - Logging configured successfully.
2025-07-07 15:05:15,643 - INFO - root - ETL pipeline started.
2025-07-07 15:05:15,658 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 15:05:17,208 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 15:05:17,210 - INFO - etl.scripts.extract - Found 9 CSV files in etl/input_data.
2025-07-07 15:05:17,210 - INFO - root - --- Processing file: mid_001_ER4K_spg_apol_20250701.csv ---
2025-07-07 15:05:17,211 - INFO - etl.scripts.extract - Extracting data from mid_001_ER4K_spg_apol_20250701.csv...
2025-07-07 15:05:17,265 - INFO - etl.scripts.extract - Successfully extracted 4280 rows from mid_001_ER4K_spg_apol_20250701.csv.
2025-07-07 15:05:17,265 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:05:17,267 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'default'
2025-07-07 15:05:17,352 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:05:17,353 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:05:17,355 - WARNING - etl.scripts.transform - Dropped 4280 rows due to missing company name.
2025-07-07 15:05:17,356 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:05:17,357 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:05:17,358 - INFO - root - Starting deduplication...
2025-07-07 15:05:17,358 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 15:05:17,359 - INFO - root - Fuzzy matching for company names is disabled.
2025-07-07 15:05:17,359 - INFO - root - Deduplication complete. 0 rows remaining for insertion.
2025-07-07 15:05:17,359 - INFO - etl.scripts.load - DataFrame is empty. Nothing to load to the database.
2025-07-07 15:05:17,360 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\mid_001_ER4K_spg_apol_20250701.csv
2025-07-07 15:05:17,360 - INFO - root - --- Processing file: SalesOutreachReport_20250705_080954_4000-8000.csv ---
2025-07-07 15:05:17,361 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_080954_4000-8000.csv...
2025-07-07 15:05:17,469 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_080954_4000-8000.csv.
2025-07-07 15:05:17,470 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:05:17,478 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 15:05:17,613 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:05:17,616 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:05:17,618 - WARNING - etl.scripts.transform - Dropped 444 rows due to missing company name.
2025-07-07 15:05:17,624 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:05:17,660 - INFO - etl.scripts.transform - Saved 633 duplicate rows to etl/dropped_duplicates\duplicates_20250707_150517.csv
2025-07-07 15:05:17,662 - INFO - etl.scripts.transform - Removed 633 duplicate phone numbers from the source file.
2025-07-07 15:05:17,662 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:05:17,662 - INFO - root - Starting deduplication...
2025-07-07 15:05:17,664 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 15:05:17,664 - INFO - root - Fuzzy matching for company names is disabled.
2025-07-07 15:05:17,664 - INFO - root - Deduplication complete. 2924 rows remaining for insertion.
2025-07-07 15:05:17,940 - INFO - etl.scripts.load - Created new profile_id: 21 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 15:05:17,941 - INFO - etl.scripts.load - Loading 2924 rows with profile_id 21 into 'contacts' table...
2025-07-07 15:05:21,379 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 15:05:21,381 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SalesOutreachReport_20250705_080954_4000-8000.csv
2025-07-07 15:05:21,384 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081012_8000-12000.csv ---
2025-07-07 15:05:21,385 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081012_8000-12000.csv...
2025-07-07 15:05:21,453 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_081012_8000-12000.csv.
2025-07-07 15:05:21,455 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:05:21,463 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 15:05:21,600 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:05:21,603 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:05:21,605 - WARNING - etl.scripts.transform - Dropped 1276 rows due to missing company name.
2025-07-07 15:05:21,609 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:05:21,645 - INFO - etl.scripts.transform - Saved 859 duplicate rows to etl/dropped_duplicates\duplicates_20250707_150521.csv
2025-07-07 15:05:21,646 - INFO - etl.scripts.transform - Removed 859 duplicate phone numbers from the source file.
2025-07-07 15:05:21,646 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:05:21,647 - INFO - root - Starting deduplication...
2025-07-07 15:05:21,648 - INFO - root - Removed 3 rows with existing phone numbers.
2025-07-07 15:05:21,649 - INFO - root - Fuzzy matching for company names is disabled.
2025-07-07 15:05:21,649 - INFO - root - Deduplication complete. 1863 rows remaining for insertion.
2025-07-07 15:05:22,007 - INFO - etl.scripts.load - Found existing profile_id: 21 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 15:05:22,008 - INFO - etl.scripts.load - Loading 1863 rows with profile_id 21 into 'contacts' table...
2025-07-07 15:05:23,890 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 15:05:23,893 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SalesOutreachReport_20250705_081012_8000-12000.csv
2025-07-07 15:05:23,895 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081027_12000-16000.csv ---
2025-07-07 15:05:23,896 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081027_12000-16000.csv...
2025-07-07 15:05:24,005 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_081027_12000-16000.csv.
2025-07-07 15:05:24,007 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:05:24,016 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 15:05:24,180 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:05:24,183 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:05:24,184 - WARNING - etl.scripts.transform - Dropped 602 rows due to missing company name.
2025-07-07 15:05:24,189 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:05:24,227 - INFO - etl.scripts.transform - Saved 702 duplicate rows to etl/dropped_duplicates\duplicates_20250707_150524.csv
2025-07-07 15:05:24,228 - INFO - etl.scripts.transform - Removed 702 duplicate phone numbers from the source file.
2025-07-07 15:05:24,228 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:05:24,230 - INFO - root - Starting deduplication...
2025-07-07 15:05:24,232 - INFO - root - Removed 4 rows with existing phone numbers.
2025-07-07 15:05:24,233 - INFO - root - Fuzzy matching for company names is disabled.
2025-07-07 15:05:24,233 - INFO - root - Deduplication complete. 2693 rows remaining for insertion.
2025-07-07 15:05:24,568 - INFO - etl.scripts.load - Found existing profile_id: 21 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 15:05:24,570 - INFO - etl.scripts.load - Loading 2693 rows with profile_id 21 into 'contacts' table...
2025-07-07 15:05:27,482 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 15:05:27,484 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SalesOutreachReport_20250705_081027_12000-16000.csv
2025-07-07 15:05:27,487 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081050_16000-20000.csv ---
2025-07-07 15:05:27,487 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081050_16000-20000.csv...
2025-07-07 15:05:27,584 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_081050_16000-20000.csv.
2025-07-07 15:05:27,586 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:05:27,595 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 15:05:27,726 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:05:27,728 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:05:27,730 - WARNING - etl.scripts.transform - Dropped 698 rows due to missing company name.
2025-07-07 15:05:27,734 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:05:27,772 - INFO - etl.scripts.transform - Saved 684 duplicate rows to etl/dropped_duplicates\duplicates_20250707_150527.csv
2025-07-07 15:05:27,774 - INFO - etl.scripts.transform - Removed 684 duplicate phone numbers from the source file.
2025-07-07 15:05:27,774 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:05:27,777 - INFO - root - Starting deduplication...
2025-07-07 15:05:27,780 - INFO - root - Removed 9 rows with existing phone numbers.
2025-07-07 15:05:27,781 - INFO - root - Fuzzy matching for company names is disabled.
2025-07-07 15:05:27,781 - INFO - root - Deduplication complete. 2610 rows remaining for insertion.
2025-07-07 15:05:28,168 - INFO - etl.scripts.load - Found existing profile_id: 21 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 15:05:28,170 - INFO - etl.scripts.load - Loading 2610 rows with profile_id 21 into 'contacts' table...
2025-07-07 15:05:31,123 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 15:05:31,125 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SalesOutreachReport_20250705_081050_16000-20000.csv
2025-07-07 15:05:31,127 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081114_20000-24000.csv ---
2025-07-07 15:05:31,128 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081114_20000-24000.csv...
2025-07-07 15:05:31,132 - INFO - etl.scripts.extract - Successfully extracted 1 rows from SalesOutreachReport_20250705_081114_20000-24000.csv.
2025-07-07 15:05:31,134 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:05:31,135 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 15:05:31,141 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:05:31,143 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:05:31,145 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:05:31,147 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:05:31,150 - INFO - root - Starting deduplication...
2025-07-07 15:05:31,153 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 15:05:31,154 - INFO - root - Fuzzy matching for company names is disabled.
2025-07-07 15:05:31,154 - INFO - root - Deduplication complete. 1 rows remaining for insertion.
2025-07-07 15:05:31,517 - INFO - etl.scripts.load - Found existing profile_id: 21 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 15:05:31,519 - INFO - etl.scripts.load - Loading 1 rows with profile_id 21 into 'contacts' table...
2025-07-07 15:05:31,792 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 15:05:31,793 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SalesOutreachReport_20250705_081114_20000-24000.csv
2025-07-07 15:05:31,794 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081134_24000-28000.csv ---
2025-07-07 15:05:31,794 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081134_24000-28000.csv...
2025-07-07 15:05:31,883 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_081134_24000-28000.csv.
2025-07-07 15:05:31,883 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:05:31,891 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 15:05:32,077 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:05:32,080 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:05:32,083 - WARNING - etl.scripts.transform - Dropped 840 rows due to missing company name.
2025-07-07 15:05:32,087 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:05:32,125 - INFO - etl.scripts.transform - Saved 746 duplicate rows to etl/dropped_duplicates\duplicates_20250707_150532.csv
2025-07-07 15:05:32,126 - INFO - etl.scripts.transform - Removed 746 duplicate phone numbers from the source file.
2025-07-07 15:05:32,126 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:05:32,127 - INFO - root - Starting deduplication...
2025-07-07 15:05:32,131 - INFO - root - Removed 17 rows with existing phone numbers.
2025-07-07 15:05:32,131 - INFO - root - Fuzzy matching for company names is disabled.
2025-07-07 15:05:32,131 - INFO - root - Deduplication complete. 2398 rows remaining for insertion.
2025-07-07 15:05:32,481 - INFO - etl.scripts.load - Found existing profile_id: 21 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 15:05:32,482 - INFO - etl.scripts.load - Loading 2398 rows with profile_id 21 into 'contacts' table...
2025-07-07 15:05:35,020 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 15:05:35,021 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SalesOutreachReport_20250705_081134_24000-28000.csv
2025-07-07 15:05:35,022 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081154_20000-24000.csv ---
2025-07-07 15:05:35,022 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081154_20000-24000.csv...
2025-07-07 15:05:35,126 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_081154_20000-24000.csv.
2025-07-07 15:05:35,128 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:05:35,135 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 15:05:35,296 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:05:35,299 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:05:35,301 - WARNING - etl.scripts.transform - Dropped 448 rows due to missing company name.
2025-07-07 15:05:35,306 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:05:35,348 - INFO - etl.scripts.transform - Saved 729 duplicate rows to etl/dropped_duplicates\duplicates_20250707_150535.csv
2025-07-07 15:05:35,349 - INFO - etl.scripts.transform - Removed 729 duplicate phone numbers from the source file.
2025-07-07 15:05:35,349 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:05:35,351 - INFO - root - Starting deduplication...
2025-07-07 15:05:35,356 - INFO - root - Removed 20 rows with existing phone numbers.
2025-07-07 15:05:35,357 - INFO - root - Fuzzy matching for company names is disabled.
2025-07-07 15:05:35,357 - INFO - root - Deduplication complete. 2804 rows remaining for insertion.
2025-07-07 15:05:35,713 - INFO - etl.scripts.load - Found existing profile_id: 21 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 15:05:35,714 - INFO - etl.scripts.load - Loading 2804 rows with profile_id 21 into 'contacts' table...
2025-07-07 15:05:38,858 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 15:05:38,860 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SalesOutreachReport_20250705_081154_20000-24000.csv
2025-07-07 15:05:38,863 - INFO - root - --- Processing file: SOR_7K_20250627_163929_regenerated_final.csv ---
2025-07-07 15:05:38,863 - INFO - etl.scripts.extract - Extracting data from SOR_7K_20250627_163929_regenerated_final.csv...
2025-07-07 15:05:39,137 - INFO - etl.scripts.extract - Successfully extracted 7383 rows from SOR_7K_20250627_163929_regenerated_final.csv.
2025-07-07 15:05:39,140 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:05:39,158 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'Apollo'
2025-07-07 15:05:39,553 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:05:39,557 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:05:39,568 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:05:39,689 - INFO - etl.scripts.transform - Saved 1574 duplicate rows to etl/dropped_duplicates\duplicates_20250707_150539.csv
2025-07-07 15:05:39,690 - INFO - etl.scripts.transform - Removed 1574 duplicate phone numbers from the source file.
2025-07-07 15:05:39,691 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:05:39,692 - INFO - root - Starting deduplication...
2025-07-07 15:05:39,697 - INFO - root - Removed 3757 rows with existing phone numbers.
2025-07-07 15:05:39,697 - INFO - root - Fuzzy matching for company names is disabled.
2025-07-07 15:05:39,698 - INFO - root - Deduplication complete. 2052 rows remaining for insertion.
2025-07-07 15:05:39,963 - INFO - etl.scripts.load - Created new profile_id: 22 for hash: ebb2ce72311169a7ea0a409c9c2c5a21
2025-07-07 15:05:39,964 - INFO - etl.scripts.load - Loading 2052 rows with profile_id 22 into 'contacts' table...
2025-07-07 15:05:43,331 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 15:05:43,333 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SOR_7K_20250627_163929_regenerated_final.csv
2025-07-07 15:05:43,334 - INFO - root - ETL pipeline finished.
2025-07-07 15:09:01,990 - INFO - root - Logging configured successfully.
2025-07-07 15:09:03,267 - WARNING - root - --- Starting Database Reset ---
2025-07-07 15:09:03,284 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 15:09:04,510 - INFO - root - Deleting all records from 'contacts' table...
2025-07-07 15:09:04,771 - INFO - root - ...done.
2025-07-07 15:09:04,771 - INFO - root - Deleting all records from 'contact_profiles' table...
2025-07-07 15:09:04,856 - INFO - root - ...done.
2025-07-07 15:09:04,947 - INFO - root - --- Database Reset Successfully ---
2025-07-07 15:09:17,103 - INFO - root - Logging configured successfully.
2025-07-07 15:09:17,103 - INFO - root - ETL pipeline started.
2025-07-07 15:09:17,120 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 15:09:18,675 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 15:09:18,677 - INFO - etl.scripts.extract - Found 9 CSV files in etl/input_data.
2025-07-07 15:09:18,678 - INFO - root - --- Processing file: mid_001_ER4K_spg_apol_20250701.csv ---
2025-07-07 15:09:18,678 - INFO - etl.scripts.extract - Extracting data from mid_001_ER4K_spg_apol_20250701.csv...
2025-07-07 15:09:18,729 - INFO - etl.scripts.extract - Successfully extracted 4280 rows from mid_001_ER4K_spg_apol_20250701.csv.
2025-07-07 15:09:18,729 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:09:18,732 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'Regeneration'
2025-07-07 15:09:18,823 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:09:18,825 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:11:09,562 - INFO - root - Logging configured successfully.
2025-07-07 15:11:11,284 - WARNING - root - --- Starting Database Reset ---
2025-07-07 15:11:11,301 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 15:11:12,548 - INFO - root - Deleting all records from 'contacts' table...
2025-07-07 15:11:12,784 - INFO - root - ...done.
2025-07-07 15:11:12,784 - INFO - root - Deleting all records from 'contact_profiles' table...
2025-07-07 15:11:12,884 - INFO - root - ...done.
2025-07-07 15:11:12,963 - INFO - root - --- Database Reset Successfully ---
2025-07-07 15:11:33,676 - INFO - root - Logging configured successfully.
2025-07-07 15:11:33,676 - INFO - root - ETL pipeline started.
2025-07-07 15:11:33,692 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 15:11:35,240 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 15:11:35,241 - INFO - etl.scripts.extract - Found 9 CSV files in etl/input_data.
2025-07-07 15:11:35,242 - INFO - root - --- Processing file: mid_001_ER4K_spg_apol_20250701.csv ---
2025-07-07 15:11:35,243 - INFO - etl.scripts.extract - Extracting data from mid_001_ER4K_spg_apol_20250701.csv...
2025-07-07 15:11:35,309 - INFO - etl.scripts.extract - Successfully extracted 4280 rows from mid_001_ER4K_spg_apol_20250701.csv.
2025-07-07 15:11:35,309 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:11:35,313 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'Regeneration'
2025-07-07 15:11:35,414 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:11:35,416 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:18:13,054 - INFO - root - Logging configured successfully.
2025-07-07 15:18:18,520 - WARNING - root - --- Starting Database Reset ---
2025-07-07 15:18:18,536 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 15:18:19,782 - INFO - root - Deleting all records from 'contacts' table...
2025-07-07 15:18:19,968 - INFO - root - ...done.
2025-07-07 15:18:19,968 - INFO - root - Deleting all records from 'contact_profiles' table...
2025-07-07 15:18:20,062 - INFO - root - ...done.
2025-07-07 15:18:20,153 - INFO - root - --- Database Reset Successfully ---
2025-07-07 15:18:35,174 - INFO - root - Logging configured successfully.
2025-07-07 15:18:35,175 - INFO - root - ETL pipeline started.
2025-07-07 15:18:35,194 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 15:18:36,761 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 15:18:36,764 - INFO - etl.scripts.extract - Found 9 CSV files in etl/input_data.
2025-07-07 15:18:36,765 - INFO - root - --- Processing file: mid_001_ER4K_spg_apol_20250701.csv ---
2025-07-07 15:18:36,765 - INFO - etl.scripts.extract - Extracting data from mid_001_ER4K_spg_apol_20250701.csv...
2025-07-07 15:18:36,826 - INFO - etl.scripts.extract - Successfully extracted 4280 rows from mid_001_ER4K_spg_apol_20250701.csv.
2025-07-07 15:18:36,827 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:18:36,829 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'Regeneration'
2025-07-07 15:18:36,961 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:18:36,969 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:29:41,039 - INFO - root - Logging configured successfully.
2025-07-07 15:29:42,477 - WARNING - root - --- Starting Database Reset ---
2025-07-07 15:29:42,508 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 15:29:43,761 - INFO - root - Deleting all records from 'contacts' table...
2025-07-07 15:29:43,950 - INFO - root - ...done.
2025-07-07 15:29:43,950 - INFO - root - Deleting all records from 'contact_profiles' table...
2025-07-07 15:29:44,044 - INFO - root - ...done.
2025-07-07 15:29:44,135 - INFO - root - --- Database Reset Successfully ---
2025-07-07 15:29:53,283 - INFO - root - Logging configured successfully.
2025-07-07 15:29:53,284 - INFO - root - ETL pipeline started.
2025-07-07 15:29:53,298 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 15:29:54,881 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 15:29:54,883 - INFO - etl.scripts.extract - Found 9 CSV files in etl/input_data.
2025-07-07 15:29:54,883 - INFO - root - --- Processing file: mid_001_ER4K_spg_apol_20250701.csv ---
2025-07-07 15:29:54,883 - INFO - etl.scripts.extract - Extracting data from mid_001_ER4K_spg_apol_20250701.csv...
2025-07-07 15:29:54,937 - INFO - etl.scripts.extract - Successfully extracted 4280 rows from mid_001_ER4K_spg_apol_20250701.csv.
2025-07-07 15:29:54,937 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:29:54,940 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'Regeneration'
2025-07-07 15:29:55,047 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:29:55,048 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:30:46,512 - INFO - root - Logging configured successfully.
2025-07-07 15:30:48,158 - WARNING - root - --- Starting Database Reset ---
2025-07-07 15:30:48,175 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 15:30:49,390 - INFO - root - Deleting all records from 'contacts' table...
2025-07-07 15:30:49,580 - INFO - root - ...done.
2025-07-07 15:30:49,581 - INFO - root - Deleting all records from 'contact_profiles' table...
2025-07-07 15:30:49,720 - INFO - root - ...done.
2025-07-07 15:30:49,800 - INFO - root - --- Database Reset Successfully ---
2025-07-07 15:31:01,099 - INFO - root - Logging configured successfully.
2025-07-07 15:31:01,100 - INFO - root - ETL pipeline started.
2025-07-07 15:31:01,116 - INFO - etl.scripts.load - Database engine created successfully.
2025-07-07 15:31:02,657 - INFO - root - Loaded 0 existing contacts for deduplication.
2025-07-07 15:31:02,658 - INFO - etl.scripts.extract - Found 9 CSV files in etl/input_data.
2025-07-07 15:31:02,659 - INFO - root - --- Processing file: mid_001_ER4K_spg_apol_20250701.csv ---
2025-07-07 15:31:02,660 - INFO - etl.scripts.extract - Extracting data from mid_001_ER4K_spg_apol_20250701.csv...
2025-07-07 15:31:02,710 - INFO - etl.scripts.extract - Successfully extracted 4280 rows from mid_001_ER4K_spg_apol_20250701.csv.
2025-07-07 15:31:02,710 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:31:02,712 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'Regeneration'
2025-07-07 15:31:02,803 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:31:02,805 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:31:02,809 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:31:02,908 - INFO - etl.scripts.transform - Saved 4279 duplicate rows to etl/dropped_duplicates\duplicates_20250707_153102.csv
2025-07-07 15:31:02,909 - INFO - etl.scripts.transform - Removed 4279 duplicate phone numbers from the source file.
2025-07-07 15:31:02,909 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:31:02,910 - INFO - root - Starting deduplication...
2025-07-07 15:31:02,911 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 15:31:02,912 - INFO - root - Fuzzy matching for company names is disabled.
2025-07-07 15:31:02,912 - INFO - root - Deduplication complete. 1 rows remaining for insertion.
2025-07-07 15:31:03,201 - INFO - etl.scripts.load - Created new profile_id: 23 for hash: 7d47483624f00e7b0dcd0483730aabaf
2025-07-07 15:31:03,203 - INFO - etl.scripts.load - Loading 1 rows with profile_id 23 into 'contacts' table...
2025-07-07 15:31:03,479 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 15:31:03,480 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\mid_001_ER4K_spg_apol_20250701.csv
2025-07-07 15:31:03,482 - INFO - root - --- Processing file: SalesOutreachReport_20250705_080954_4000-8000.csv ---
2025-07-07 15:31:03,482 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_080954_4000-8000.csv...
2025-07-07 15:31:03,613 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_080954_4000-8000.csv.
2025-07-07 15:31:03,614 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:31:03,623 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 15:31:03,781 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:31:03,784 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:31:03,787 - WARNING - etl.scripts.transform - Dropped 444 rows due to missing company name.
2025-07-07 15:31:04,234 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:31:04,273 - INFO - etl.scripts.transform - Saved 633 duplicate rows to etl/dropped_duplicates\duplicates_20250707_153104.csv
2025-07-07 15:31:04,274 - INFO - etl.scripts.transform - Removed 633 duplicate phone numbers from the source file.
2025-07-07 15:31:04,275 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:31:04,275 - INFO - root - Starting deduplication...
2025-07-07 15:31:04,276 - INFO - root - Removed 1 rows with existing phone numbers.
2025-07-07 15:31:04,277 - INFO - root - Fuzzy matching for company names is disabled.
2025-07-07 15:31:04,277 - INFO - root - Deduplication complete. 2923 rows remaining for insertion.
2025-07-07 15:31:04,579 - INFO - etl.scripts.load - Created new profile_id: 24 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 15:31:04,580 - INFO - etl.scripts.load - Loading 2923 rows with profile_id 24 into 'contacts' table...
2025-07-07 15:31:07,416 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 15:31:07,417 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SalesOutreachReport_20250705_080954_4000-8000.csv
2025-07-07 15:31:07,420 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081012_8000-12000.csv ---
2025-07-07 15:31:07,421 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081012_8000-12000.csv...
2025-07-07 15:31:07,529 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_081012_8000-12000.csv.
2025-07-07 15:31:07,532 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:31:07,551 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 15:31:07,834 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:31:07,839 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:31:07,842 - WARNING - etl.scripts.transform - Dropped 1276 rows due to missing company name.
2025-07-07 15:31:08,130 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:31:08,168 - INFO - etl.scripts.transform - Saved 859 duplicate rows to etl/dropped_duplicates\duplicates_20250707_153108.csv
2025-07-07 15:31:08,170 - INFO - etl.scripts.transform - Removed 859 duplicate phone numbers from the source file.
2025-07-07 15:31:08,170 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:31:08,173 - INFO - root - Starting deduplication...
2025-07-07 15:31:08,175 - INFO - root - Removed 3 rows with existing phone numbers.
2025-07-07 15:31:08,176 - INFO - root - Fuzzy matching for company names is disabled.
2025-07-07 15:31:08,176 - INFO - root - Deduplication complete. 1863 rows remaining for insertion.
2025-07-07 15:31:08,545 - INFO - etl.scripts.load - Found existing profile_id: 24 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 15:31:08,546 - INFO - etl.scripts.load - Loading 1863 rows with profile_id 24 into 'contacts' table...
2025-07-07 15:31:10,198 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 15:31:10,200 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SalesOutreachReport_20250705_081012_8000-12000.csv
2025-07-07 15:31:10,202 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081027_12000-16000.csv ---
2025-07-07 15:31:10,202 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081027_12000-16000.csv...
2025-07-07 15:31:10,321 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_081027_12000-16000.csv.
2025-07-07 15:31:10,324 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:31:10,333 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 15:31:10,512 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:31:10,515 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:31:10,517 - WARNING - etl.scripts.transform - Dropped 602 rows due to missing company name.
2025-07-07 15:31:10,950 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:31:10,988 - INFO - etl.scripts.transform - Saved 702 duplicate rows to etl/dropped_duplicates\duplicates_20250707_153110.csv
2025-07-07 15:31:10,990 - INFO - etl.scripts.transform - Removed 702 duplicate phone numbers from the source file.
2025-07-07 15:31:10,990 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:31:10,991 - INFO - root - Starting deduplication...
2025-07-07 15:31:10,993 - INFO - root - Removed 4 rows with existing phone numbers.
2025-07-07 15:31:10,994 - INFO - root - Fuzzy matching for company names is disabled.
2025-07-07 15:31:10,994 - INFO - root - Deduplication complete. 2693 rows remaining for insertion.
2025-07-07 15:31:11,341 - INFO - etl.scripts.load - Found existing profile_id: 24 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 15:31:11,342 - INFO - etl.scripts.load - Loading 2693 rows with profile_id 24 into 'contacts' table...
2025-07-07 15:31:14,182 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 15:31:14,184 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SalesOutreachReport_20250705_081027_12000-16000.csv
2025-07-07 15:31:14,186 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081050_16000-20000.csv ---
2025-07-07 15:31:14,186 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081050_16000-20000.csv...
2025-07-07 15:31:14,289 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_081050_16000-20000.csv.
2025-07-07 15:31:14,291 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:31:14,300 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 15:31:14,461 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:31:14,464 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:31:14,466 - WARNING - etl.scripts.transform - Dropped 698 rows due to missing company name.
2025-07-07 15:31:14,801 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:31:14,841 - INFO - etl.scripts.transform - Saved 684 duplicate rows to etl/dropped_duplicates\duplicates_20250707_153114.csv
2025-07-07 15:31:14,842 - INFO - etl.scripts.transform - Removed 684 duplicate phone numbers from the source file.
2025-07-07 15:31:14,843 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:31:14,844 - INFO - root - Starting deduplication...
2025-07-07 15:31:14,847 - INFO - root - Removed 9 rows with existing phone numbers.
2025-07-07 15:31:14,847 - INFO - root - Fuzzy matching for company names is disabled.
2025-07-07 15:31:14,848 - INFO - root - Deduplication complete. 2610 rows remaining for insertion.
2025-07-07 15:31:15,244 - INFO - etl.scripts.load - Found existing profile_id: 24 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 15:31:15,245 - INFO - etl.scripts.load - Loading 2610 rows with profile_id 24 into 'contacts' table...
2025-07-07 15:31:17,712 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 15:31:17,714 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SalesOutreachReport_20250705_081050_16000-20000.csv
2025-07-07 15:31:17,716 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081114_20000-24000.csv ---
2025-07-07 15:31:17,716 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081114_20000-24000.csv...
2025-07-07 15:31:17,720 - INFO - etl.scripts.extract - Successfully extracted 1 rows from SalesOutreachReport_20250705_081114_20000-24000.csv.
2025-07-07 15:31:17,724 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:31:17,724 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 15:31:17,732 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:31:17,733 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:31:17,735 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:31:17,738 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:31:17,743 - INFO - root - Starting deduplication...
2025-07-07 15:31:17,747 - INFO - root - Removed 0 rows with existing phone numbers.
2025-07-07 15:31:17,748 - INFO - root - Fuzzy matching for company names is disabled.
2025-07-07 15:31:17,748 - INFO - root - Deduplication complete. 1 rows remaining for insertion.
2025-07-07 15:31:18,123 - INFO - etl.scripts.load - Found existing profile_id: 24 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 15:31:18,123 - INFO - etl.scripts.load - Loading 1 rows with profile_id 24 into 'contacts' table...
2025-07-07 15:31:18,394 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 15:31:18,396 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SalesOutreachReport_20250705_081114_20000-24000.csv
2025-07-07 15:31:18,397 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081134_24000-28000.csv ---
2025-07-07 15:31:18,397 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081134_24000-28000.csv...
2025-07-07 15:31:18,484 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_081134_24000-28000.csv.
2025-07-07 15:31:18,484 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:31:18,495 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 15:31:18,652 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:31:18,655 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:31:18,657 - WARNING - etl.scripts.transform - Dropped 840 rows due to missing company name.
2025-07-07 15:31:18,985 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:31:19,025 - INFO - etl.scripts.transform - Saved 746 duplicate rows to etl/dropped_duplicates\duplicates_20250707_153118.csv
2025-07-07 15:31:19,026 - INFO - etl.scripts.transform - Removed 746 duplicate phone numbers from the source file.
2025-07-07 15:31:19,026 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:31:19,027 - INFO - root - Starting deduplication...
2025-07-07 15:31:19,030 - INFO - root - Removed 17 rows with existing phone numbers.
2025-07-07 15:31:19,030 - INFO - root - Fuzzy matching for company names is disabled.
2025-07-07 15:31:19,030 - INFO - root - Deduplication complete. 2398 rows remaining for insertion.
2025-07-07 15:31:19,387 - INFO - etl.scripts.load - Found existing profile_id: 24 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 15:31:19,388 - INFO - etl.scripts.load - Loading 2398 rows with profile_id 24 into 'contacts' table...
2025-07-07 15:31:21,713 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 15:31:21,714 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SalesOutreachReport_20250705_081134_24000-28000.csv
2025-07-07 15:31:21,717 - INFO - root - --- Processing file: SalesOutreachReport_20250705_081154_20000-24000.csv ---
2025-07-07 15:31:21,717 - INFO - etl.scripts.extract - Extracting data from SalesOutreachReport_20250705_081154_20000-24000.csv...
2025-07-07 15:31:21,828 - INFO - etl.scripts.extract - Successfully extracted 4001 rows from SalesOutreachReport_20250705_081154_20000-24000.csv.
2025-07-07 15:31:21,830 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:31:21,840 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'SalesOutreachReport'
2025-07-07 15:31:22,009 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:31:22,012 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:31:22,014 - WARNING - etl.scripts.transform - Dropped 448 rows due to missing company name.
2025-07-07 15:31:22,382 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:31:22,418 - INFO - etl.scripts.transform - Saved 729 duplicate rows to etl/dropped_duplicates\duplicates_20250707_153122.csv
2025-07-07 15:31:22,420 - INFO - etl.scripts.transform - Removed 729 duplicate phone numbers from the source file.
2025-07-07 15:31:22,420 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:31:22,422 - INFO - root - Starting deduplication...
2025-07-07 15:31:22,428 - INFO - root - Removed 20 rows with existing phone numbers.
2025-07-07 15:31:22,428 - INFO - root - Fuzzy matching for company names is disabled.
2025-07-07 15:31:22,428 - INFO - root - Deduplication complete. 2804 rows remaining for insertion.
2025-07-07 15:31:22,780 - INFO - etl.scripts.load - Found existing profile_id: 24 for hash: 82a18b470607eb3bb74278a9844540ec
2025-07-07 15:31:22,781 - INFO - etl.scripts.load - Loading 2804 rows with profile_id 24 into 'contacts' table...
2025-07-07 15:31:27,142 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 15:31:27,144 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SalesOutreachReport_20250705_081154_20000-24000.csv
2025-07-07 15:31:27,145 - INFO - root - --- Processing file: SOR_7K_20250627_163929_regenerated_final.csv ---
2025-07-07 15:31:27,145 - INFO - etl.scripts.extract - Extracting data from SOR_7K_20250627_163929_regenerated_final.csv...
2025-07-07 15:31:27,471 - INFO - etl.scripts.extract - Successfully extracted 7383 rows from SOR_7K_20250627_163929_regenerated_final.csv.
2025-07-07 15:31:27,473 - INFO - etl.scripts.transform - Starting two-tiered transformation...
2025-07-07 15:31:27,494 - INFO - etl.scripts.transform - Applying promotion rules for profile: 'Apollo'
2025-07-07 15:31:27,872 - INFO - etl.scripts.transform - Transformation complete. Final columns: ['company_name', 'url', 'phone_number', 'industry', 'is_b2b', 'customer_target_segments', 'additional_info']
2025-07-07 15:31:27,876 - INFO - etl.scripts.transform - Starting data cleaning...
2025-07-07 15:31:28,653 - INFO - etl.scripts.transform - Cleaned 'phone_number' column, converting blanks to NULL.
2025-07-07 15:31:28,757 - INFO - etl.scripts.transform - Saved 1574 duplicate rows to etl/dropped_duplicates\duplicates_20250707_153128.csv
2025-07-07 15:31:28,759 - INFO - etl.scripts.transform - Removed 1574 duplicate phone numbers from the source file.
2025-07-07 15:31:28,759 - INFO - etl.scripts.transform - Data cleaning complete.
2025-07-07 15:31:28,761 - INFO - root - Starting deduplication...
2025-07-07 15:31:28,768 - INFO - root - Removed 3757 rows with existing phone numbers.
2025-07-07 15:31:28,768 - INFO - root - Fuzzy matching for company names is disabled.
2025-07-07 15:31:28,768 - INFO - root - Deduplication complete. 2052 rows remaining for insertion.
2025-07-07 15:31:29,056 - INFO - etl.scripts.load - Created new profile_id: 25 for hash: ebb2ce72311169a7ea0a409c9c2c5a21
2025-07-07 15:31:29,057 - INFO - etl.scripts.load - Loading 2052 rows with profile_id 25 into 'contacts' table...
2025-07-07 15:31:32,992 - INFO - etl.scripts.load - Successfully loaded data into 'contacts'.
2025-07-07 15:31:32,993 - INFO - etl.scripts.load - Moved processed file to: etl\processed_data\SOR_7K_20250627_163929_regenerated_final.csv
2025-07-07 15:31:32,995 - INFO - root - ETL pipeline finished.
